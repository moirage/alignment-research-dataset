<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><script src="Understanding%20Convolutions%20on%20Graphs_files/template.js"></script><style>body {transition: opacity ease-in 0.2s; } 
body[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } 
</style><meta charset="utf-8"><meta name="viewport" content="width=1200"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><script async="" src="Understanding%20Convolutions%20on%20Graphs_files/analytics.js"></script><script>
window.addEventListener('WebComponentsReady', function() {
  console.warn('WebComponentsReady');
  const loaderTag = document.createElement('script');
  loaderTag.src = 'https://distill.pub/template.v2.js';
  document.head.insertBefore(loaderTag, document.head.firstChild);
});
</script><script src="Understanding%20Convolutions%20on%20Graphs_files/webcomponents-loader.js"></script><script src="Understanding%20Convolutions%20on%20Graphs_files/webcomponents-hi.js"></script>
  <title>Understanding Convolutions on Graphs</title>
  
  
  <style id="distill-prerendered-styles" type="text/css">/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

html {
  font-size: 14px;
	line-height: 1.6em;
  /* font-family: "Libre Franklin", "Helvetica Neue", sans-serif; */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  /*, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";*/
  text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}

@media(min-width: 768px) {
  html {
    font-size: 16px;
  }
}

body {
  margin: 0;
}

a {
  color: #004276;
}

figure {
  margin: 0;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}

table th {
	text-align: left;
}

table thead {
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

table thead th {
  padding-bottom: 0.5em;
}

table tbody :first-child td {
  padding-top: 0.5em;
}

pre {
  overflow: auto;
  max-width: 100%;
}

p {
  margin-top: 0;
  margin-bottom: 1em;
}

sup, sub {
  vertical-align: baseline;
  position: relative;
  top: -0.4em;
  line-height: 1em;
}

sub {
  top: 0.4em;
}

.kicker,
.marker {
  font-size: 15px;
  font-weight: 600;
  color: rgba(0, 0, 0, 0.5);
}


/* Headline */

@media(min-width: 1024px) {
  d-title h1 span {
    display: block;
  }
}

/* Figure */

figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

figcaption+figure {

}

figure img {
  width: 100%;
}

figure svg text,
figure svg tspan {
}

figcaption,
.figcaption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

@media(min-width: 1024px) {
figcaption,
.figcaption {
    font-size: 13px;
  }
}

figure.external img {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

figcaption a {
  color: rgba(0, 0, 0, 0.6);
}

figcaption b,
figcaption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@supports not (display: grid) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    display: block;
    padding: 8px;
  }
}

.base-grid,
distill-header,
d-title,
d-abstract,
d-article,
d-appendix,
distill-appendix,
d-byline,
d-footnote-list,
d-citation-list,
distill-footer {
  display: grid;
  justify-items: stretch;
  grid-template-columns: [screen-start] 8px [page-start kicker-start text-start gutter-start middle-start] 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr [text-end page-end gutter-end kicker-end middle-end] 8px [screen-end];
  grid-column-gap: 8px;
}

.grid {
  display: grid;
  grid-column-gap: 8px;
}

@media(min-width: 768px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start middle-start text-start] 45px 45px 45px 45px 45px 45px 45px 45px [ kicker-end text-end gutter-start] 45px [middle-end] 45px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }
}

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 50px [middle-start] 50px [text-start kicker-end] 50px 50px 50px 50px 50px 50px 50px 50px [text-end gutter-start] 50px [middle-end] 50px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}




.base-grid {
  grid-column: screen;
}

/* .l-body,
d-article > *  {
  grid-column: text;
}

.l-page,
d-title > *,
d-figure {
  grid-column: page;
} */

.l-gutter {
  grid-column: gutter;
}

.l-text,
.l-body {
  grid-column: text;
}

.l-page {
  grid-column: page;
}

.l-body-outset {
  grid-column: middle;
}

.l-page-outset {
  grid-column: page;
}

.l-screen {
  grid-column: screen;
}

.l-screen-inset {
  grid-column: screen;
  padding-left: 16px;
  padding-left: 16px;
}


/* Aside */

d-article aside {
  grid-column: gutter;
  font-size: 12px;
  line-height: 1.6em;
  color: rgba(0, 0, 0, 0.6)
}

@media(min-width: 768px) {
  aside {
    grid-column: gutter;
  }

  .side {
    grid-column: gutter;
  }
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-title {
  padding: 2rem 0 1.5rem;
  contain: layout style;
  overflow-x: hidden;
}

@media(min-width: 768px) {
  d-title {
    padding: 4rem 0 1.5rem;
  }
}

d-title h1 {
  grid-column: text;
  font-size: 40px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

@media(min-width: 768px) {
  d-title h1 {
    font-size: 50px;
  }
}

d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  grid-column: text;
}

d-title .status {
  margin-top: 0px;
  font-size: 12px;
  color: #009688;
  opacity: 0.8;
  grid-column: kicker;
}

d-title .status span {
  line-height: 1;
  display: inline-block;
  padding: 6px 0;
  border-bottom: 1px solid #80cbc4;
  font-size: 11px;
  text-transform: uppercase;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-byline {
  contain: style;
  overflow: hidden;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  font-size: 0.8rem;
  line-height: 1.8em;
  padding: 1.5rem 0;
  min-height: 1.8em;
}


d-byline .byline {
  grid-template-columns: 1fr 1fr;
  grid-column: text;
}

@media(min-width: 768px) {
  d-byline .byline {
    grid-template-columns: 1fr 1fr 1fr 1fr;
  }
}

d-byline .authors-affiliations {
  grid-column-end: span 2;
  grid-template-columns: 1fr 1fr;
  margin-bottom: 1em;
}

@media(min-width: 768px) {
  d-byline .authors-affiliations {
    margin-bottom: 0;
  }
}

d-byline h3 {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  margin: 0;
  text-transform: uppercase;
}

d-byline p {
  margin: 0;
}

d-byline a,
d-article d-byline a {
  color: rgba(0, 0, 0, 0.8);
  text-decoration: none;
  border-bottom: none;
}

d-article d-byline a:hover {
  text-decoration: underline;
  border-bottom: none;
}

d-byline p.author {
  font-weight: 500;
}

d-byline .affiliations {

}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-article {
  contain: layout style;
  overflow-x: hidden;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  padding-top: 2rem;
  color: rgba(0, 0, 0, 0.8);
}

d-article > * {
  grid-column: text;
}

@media(min-width: 768px) {
  d-article {
    font-size: 16px;
  }
}

@media(min-width: 1024px) {
  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
}


/* H2 */


d-article .marker {
  text-decoration: none;
  border: none;
  counter-reset: section;
  grid-column: kicker;
  line-height: 1.7em;
}

d-article .marker:hover {
  border: none;
}

d-article .marker span {
  padding: 0 3px 4px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  position: relative;
  top: 4px;
}

d-article .marker:hover span {
  color: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid rgba(0, 0, 0, 0.7);
}

d-article h2 {
  font-weight: 600;
  font-size: 24px;
  line-height: 1.25em;
  margin: 2rem 0 1.5rem 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 1rem;
}

@media(min-width: 1024px) {
  d-article h2 {
    font-size: 36px;
  }
}

/* H3 */

d-article h3 {
  font-weight: 700;
  font-size: 18px;
  line-height: 1.4em;
  margin-bottom: 1em;
  margin-top: 2em;
}

@media(min-width: 1024px) {
  d-article h3 {
    font-size: 20px;
  }
}

/* H4 */

d-article h4 {
  font-weight: 600;
  text-transform: uppercase;
  font-size: 14px;
  line-height: 1.4em;
}

d-article a {
  color: inherit;
}

d-article p,
d-article ul,
d-article ol,
d-article blockquote {
  margin-top: 0;
  margin-bottom: 1em;
  margin-left: 0;
  margin-right: 0;
}

d-article blockquote {
  border-left: 2px solid rgba(0, 0, 0, 0.2);
  padding-left: 2em;
  font-style: italic;
  color: rgba(0, 0, 0, 0.6);
}

d-article a {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  text-decoration: none;
}

d-article a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.8);
}

d-article .link {
  text-decoration: underline;
  cursor: pointer;
}

d-article ul,
d-article ol {
  padding-left: 24px;
}

d-article li {
  margin-bottom: 1em;
  margin-left: 0;
  padding-left: 0;
}

d-article li:last-child {
  margin-bottom: 0;
}

d-article pre {
  font-size: 14px;
  margin-bottom: 20px;
}

d-article hr {
  grid-column: screen;
  width: 100%;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  margin-top: 60px;
  margin-bottom: 60px;
}

d-article section {
  margin-top: 60px;
  margin-bottom: 60px;
}

d-article span.equation-mimic {
  font-family: georgia;
  font-size: 115%;
  font-style: italic;
}

d-article > d-code,
d-article section > d-code  {
  display: block;
}

d-article > d-math[block],
d-article section > d-math[block]  {
  display: block;
}

@media (max-width: 768px) {
  d-article > d-code,
  d-article section > d-code,
  d-article > d-math[block],
  d-article section > d-math[block] {
      overflow-x: scroll;
      -ms-overflow-style: none;  // IE 10+
      overflow: -moz-scrollbars-none;  // Firefox
  }

  d-article > d-code::-webkit-scrollbar,
  d-article section > d-code::-webkit-scrollbar,
  d-article > d-math[block]::-webkit-scrollbar,
  d-article section > d-math[block]::-webkit-scrollbar {
    display: none;  // Safari and Chrome
  }
}

d-article .citation {
  color: #668;
  cursor: pointer;
}

d-include {
  width: auto;
  display: block;
}

d-figure {
  contain: layout style;
}

/* KaTeX */

.katex, .katex-prerendered {
  contain: style;
  display: inline-block;
}

/* Tables */

d-article table {
  border-collapse: collapse;
  margin-bottom: 1.5rem;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

d-article table th {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

d-article table td {
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

d-article table tr:last-of-type td {
  border-bottom: none;
}

d-article table th,
d-article table td {
  font-size: 15px;
  padding: 2px 8px;
}

d-article table tbody :first-child td {
  padding-top: 2px;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

span.katex-display {
  text-align: left;
  padding: 8px 0 8px 0;
  margin: 0.5em 0 0.5em 1em;
}

span.katex {
  -webkit-font-smoothing: antialiased;
  color: rgba(0, 0, 0, 0.8);
  font-size: 1.18em;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@media print {

  @page {
    size: 8in 11in;
    @bottom-right {
      content: counter(page) " of " counter(pages);
    }
  }

  html {
    /* no general margins -- CSS Grid takes care of those */
  }

  p, code {
    page-break-inside: avoid;
  }

  h2, h3 {
    page-break-after: avoid;
  }

  d-header {
    visibility: hidden;
  }

  d-footer {
    display: none!important;
  }

}
</style>
  <style id="distill-article-specific-styles">
    .subgrid {
  grid-column: screen; 
  display: grid; 
  grid-template-columns: inherit;
  grid-template-rows: inherit;
  grid-column-gap: inherit;
  grid-row-gap: inherit;
}

d-figure.base-grid {
  grid-column: screen;
  background: hsl(0, 0%, 97%);
  padding: 20px 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

d-figure {
  margin-bottom: 1em;
  position: relative;
}

d-figure > figure {
  margin-top: 0;
  margin-bottom: 0;
}

.shaded-figure {
  background-color: hsl(0, 0%, 97%);
  border-top: 1px solid hsla(0, 0%, 0%, 0.1);
  border-bottom: 1px solid hsla(0, 0%, 0%, 0.1);
  padding: 30px 0;
}

.pointer {
  position: absolute;
  width: 26px;
  height: 26px;
  top: 26px;
  left: -48px;
}

div#observablehq {
  font-family: inherit;
  font-size: inherit;
}

button {
  font-family : inherit;
  font-size: 1em;
}

/* Alignment of KaTeX. */
#gnn-models span.katex-display {
  margin: 0.5em 0 0.5em 0em;
}

@media (max-width: 1000px) {
  d-contents {
    justify-self: start;
    align-self: start;
    grid-column-start: 2;
    grid-column-end: 6;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom-width: 1px;
    border-bottom-style: solid;
    border-bottom-color: rgba(0, 0, 0, 0.1);
  }
}

@media (min-width: 1000px) {
  d-contents {
    align-self: start;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: end;
    padding-right: 3em;
    padding-left: 2em;
    border-right: 1px solid rgba(0, 0, 0, 0.1);
    border-right-width: 1px;
    border-right-style: solid;
    border-right-color: rgba(0, 0, 0, 0.1);
  }
}

@media (min-width: 1180px) {
  d-contents {
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: end;
    padding-right: 3em;
    padding-left: 2em;
    border-right: 1px solid rgba(0, 0, 0, 0.1);
    border-right-width: 1px;
    border-right-style: solid;
    border-right-color: rgba(0, 0, 0, 0.1);
  }
}

d-contents nav h3 {
  margin-top: 0;
  margin-bottom: 1em;
}

d-contents nav a {
  color: rgba(0, 0, 0, 0.8);
  border-bottom: none;
  text-decoration: none;
}

d-contents li {
  list-style-type: none;
}

d-contents ul {
  padding-left: 1em;
}

d-contents nav ul li {
  margin-bottom: 0.25em;
}

d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6);
}

d-contents nav ul {
  margin-top: 0;
  margin-bottom: 6px;
}

d-contents nav > div {
  display: block;
  outline: none;
  margin-bottom: 0.5em;
}

d-contents nav > div > a {
  font-size: 13px;
  font-weight: 600;
}

d-contents nav > div > a:hover, d-contents nav > ul > li > a:hover {
  text-decoration: none;
}

input[type="radio"] {
  vertical-align: unset !important;
}

.math-details {
  padding-left: 1em;
  padding-right: 1em;
  padding-bottom: 0em;
  padding-top: 1em;
  margin-bottom: 1em;
}
  </style>
<link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex.css" crossorigin="anonymous">
    
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA99JREFUeNrsG4t1ozDMzQSM4A2ODUonKBucN2hugtIJ6E1AboLcBiQTkJsANiAb9OCd/OpzMWBJBl5TvaeXPiiyJetry0J8wW3D3QpjRh3GjneXDq+fSQA9s2mH9x3KDhN4foJfCb8N/Jrv+2fnDn8vLRQOplWHVYdvHZYdZsBcZP1vBmh/n8DzEmhUQDPaOuP9pFuY+JwJHwHnCLQE2tnWBGEyXozY9xCUgHMhhjE2I4heVWtgIkZ83wL6Qgxj1obfWBxymPwe+b00BCCRNPbwfb60yleAkkBHGT5AEehIYz7eJrFDMF9CvH4wwhcGHiHMneFvLDQwlwvMLQq58trRcYBWfYn0A0OgHWQUSu25mE+BnoYKnnEJoeIWAifzOv7vLWd2ZKRfWAIme3tOiUaQ3UnLkb0xj1FxRIeEGKaGIHOs9nEgLaaA9i0JRYo1Ic67wJW86KSKE/ZAM8KuVMk8ITVhmxUxJ3Cl2xlm9Vtkeju1+mpCQNxaEGNCY8bs9X2YqwNoQeGjBWut/ma0QAWy/TqAsHx9wSya3I5IRxOfTC+leG+kA/4vSeEcGBtNUN6byhu3+keEZCQJUNh8MAO7HL6H8pQLnsW/Hd4T4lv93TPjfM7A46iEEqbB5EDOvwYNW6tGNZzT/o+CZ6sqZ6wUtR/wf7mi/VL8iNciT6rHih48Y55b4nKCHJCCzb4y0nwFmin3ZEMIoLfZF8F7nncFmvnWBaBj7CGAYA/WGJsUwHdYqVDwAmNsUgAx4CGgAA7GOOxADYOFWOaIKifuVYzmOpREqA21Mo7aPsgiY1PhOMAmxtR+AUbYH3Id2wc0SAFIQTsn9IUGWR8k9jx3vtXSiAacFxTAGakBk9UudkNECd6jLe+6HrshshvIuC6IlLMRy7er+JpcKma24SlE4cFZSZJDGVVrsNvitQhQrDhW0jfiOLfFd47C42eHT56D/BK0To+58Ahj+cAT8HT1UWlfLZCCd/uKawzU0Rh2EyIX/Icqth3niG8ybNroezwe6khdCNxRN+l4XGdOLVLlOOt2hTRJlr1ETIuMAltVTMz70mJrkdGAaZLSmnBEqmAE32JCMmuTlCnRgsBENtOUpHhvvsYIL0ibnBkaC6QvKcR7738GKp0AKnim7xgUSNv1bpS8QwhBt8r+EP47v/oyRK/S34yJ9nT+AN0Tkm4OdB9E4BsmXM3SnMlRFUrtp6IDpV2eKzdYvF3etm3KhQksbOLChGkSmcBdmcEwvqkrMy5BzL00NZeu3qPYJOOuCc+5NjcWKXQxFvTa3NoXJ4d8in7fiAUuTt781dkvuHX4K8AA2Usy7yNKLy0AAAAASUVORK5CYII=">
    <link href="https://distill.pub/rss.xml" rel="alternate" type="application/rss+xml" title="Articles from Distill">
  
    <title>Understanding Convolutions on Graphs</title>
    
    <link rel="canonical" href="https://distill.pub/2021/understanding-gnns">
    
    <!--  https://schema.org/Article -->
    <meta property="description" itemprop="description" content="Understanding the building blocks and design choices of graph neural networks.">
    <meta property="article:published" itemprop="datePublished" content="2021-09-02">
    <meta property="article:created" itemprop="dateCreated" content="2021-09-02">
    
    <meta property="article:modified" itemprop="dateModified" content="2021-12-06T05:57:02.000Z">
    
    <meta property="article:author" content="Ameya Daigavane">
    <meta property="article:author" content="Balaraman Ravindran">
    <meta property="article:author" content="Gaurav Aggarwal">
    <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Understanding Convolutions on Graphs">
    <meta property="og:description" content="Understanding the building blocks and design choices of graph neural networks.">
    <meta property="og:url" content="https://distill.pub/2021/understanding-gnns">
    <meta property="og:image" content="https://distill.pub/2021/understanding-gnns/thumbnail.jpg">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Distill">
  
    <!--  https://dev.twitter.com/cards/types/summary -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Understanding Convolutions on Graphs">
    <meta name="twitter:description" content="Understanding the building blocks and design choices of graph neural networks.">
    <meta name="twitter:url" content="https://distill.pub/2021/understanding-gnns">
    <meta name="twitter:image" content="https://distill.pub/2021/understanding-gnns/thumbnail.jpg">
    <meta name="twitter:image:width" content="560">
    <meta name="twitter:image:height" content="295">
  
      <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
    <meta name="citation_title" content="Understanding Convolutions on Graphs">
    <meta name="citation_fulltext_html_url" content="https://distill.pub/2021/understanding-gnns">
    <meta name="citation_volume" content="6">
    <meta name="citation_issue" content="9">
    <meta name="citation_firstpage" content="e32">
    <meta name="citation_doi" content="10.23915/distill.00032">
    <meta name="citation_journal_title" content="Distill">
    <meta name="citation_journal_abbrev" content="Distill">
    <meta name="citation_issn" content="2476-0757">
    <meta name="citation_fulltext_world_readable" content="">
    <meta name="citation_online_date" content="2021/09/02">
    <meta name="citation_publication_date" content="2021/09/02">
    <meta name="citation_author" content="Daigavane, Ameya">
    <meta name="citation_author_institution" content="Google Research">
    <meta name="citation_author" content="Ravindran, Balaraman">
    <meta name="citation_author_institution" content="Google Research">
    <meta name="citation_author" content="Aggarwal, Gaurav">
    <meta name="citation_author_institution" content="Google Research">
    <meta name="citation_reference" content="citation_title=A Gentle Introduction to Graph Neural Networks;citation_author=Benjamin Sanchez-Lengeling;citation_author=Emily Reif;citation_author=Adam Pearce;citation_author=Alex Wiltschko;citation_publication_date=2021;citation_journal_title=Distill;">
    <meta name="citation_reference" content="citation_title=Graph Kernels;citation_author=S.V.N. Vishwanathan;citation_author=Nicol N. Schraudolph;citation_author=Risi Kondor;citation_author=Karsten M. Borgwardt;citation_publication_date=2010;citation_journal_title=Journal of Machine Learning Research;citation_volume=11;citation_number=40;">
    <meta name="citation_reference" content="citation_title=Node2vec: Scalable Feature Learning for Networks;citation_author=Aditya Grover;citation_author=Jure Leskovec;citation_publication_date=2016;">
    <meta name="citation_reference" content="citation_title=DeepWalk: Online Learning of Social Representations;citation_author=Bryan Perozzi;citation_author=Rami Al-Rfou;citation_author=Steven Skiena;citation_publication_date=2014;">
    <meta name="citation_reference" content="citation_title=Convolutional Networks on Graphs for Learning Molecular Fingerprints;citation_author=David K Duvenaud;citation_author=Dougal Maclaurin;citation_author=Jorge Iparraguirre;citation_author=Rafael Bombarell;citation_author=Timothy Hirzel;citation_author=Alan Aspuru-Guzik;citation_author=Ryan P Adams;citation_publication_date=2015;citation_volume=28;">
    <meta name="citation_reference" content="citation_title=Neural Message Passing for Quantum Chemistry;citation_author=Justin Gilmer;citation_author=Samuel S. Schoenholz;citation_author=Patrick F. Riley;citation_author=Oriol Vinyals;citation_author=George E. Dahl;citation_publication_date=2017;citation_volume=70;">
    <meta name="citation_reference" content="citation_title=Learning Convolutional Neural Networks for Graphs;citation_author=Mathias Niepert;citation_author=Mohamed Ahmed;citation_author=Konstantin Kutzkov;citation_publication_date=2016;">
    <meta name="citation_reference" content="citation_title=A Tutorial on Spectral Clustering;citation_author=Ulrike von Luxburg;citation_publication_date=2007;citation_arxiv_id=0711.0189;">
    <meta name="citation_reference" content="citation_title=Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering;citation_author=Micha\&quot;{e}l Defferrard;citation_author=Xavier Bresson;citation_author=Pierre Vandergheynst;citation_publication_date=2016;citation_volume=29;">
    <meta name="citation_reference" content="citation_title=Wavelets on Graphs via Spectral Graph Theory;citation_author=David K. Hammond;citation_author=Pierre Vandergheynst;citation_author=Rémi Gribonval;citation_publication_date=2011;citation_journal_title=Applied and Computational Harmonic Analysis;citation_volume=30;citation_number=2;">
    <meta name="citation_reference" content="citation_title=Chebyshev Polynomials;citation_author=J.C. Mason;citation_author=D.C. Handscomb;citation_publication_date=2002;">
    <meta name="citation_reference" content="citation_title=Semi-Supervised Classification with Graph Convolutional Networks;citation_author=Thomas N. Kipf;citation_author=Max Welling;citation_publication_date=2017;">
    <meta name="citation_reference" content="citation_title=Graph Attention Networks;citation_author=Petar Veličković;citation_author=Guillem Cucurull;citation_author=Arantxa Casanova;citation_author=Adriana Romero;citation_author=Pietro Liò;citation_author=Yoshua Bengio;citation_publication_date=2018;">
    <meta name="citation_reference" content="citation_title=Inductive Representation Learning on Large Graphs;citation_author=Will Hamilton;citation_author=Zhitao Ying;citation_author=Jure Leskovec;citation_publication_date=2017;citation_volume=30;">
    <meta name="citation_reference" content="citation_title=How Powerful are Graph Neural Networks?;citation_author=Keyulu Xu;citation_author=Weihua Hu;citation_author=Jure Leskovec;citation_author=Stefanie Jegelka;citation_publication_date=2019;">
    <meta name="citation_reference" content="citation_title=Relational inductive biases, deep learning, and graph networks;citation_author=Peter W. Battaglia;citation_author=Jessica B. Hamrick;citation_author=Victor Bapst;citation_author=Alvaro Sanchez-Gonzalez;citation_author=Vin{\'i}cius Flores Zambaldi;citation_author=Mateusz Malinowski;citation_author=Andrea Tacchetti;citation_author=David Raposo;citation_author=Adam Santoro;citation_author=Ryan Faulkner;citation_author=Caglar Gulcehre;citation_author=H. Francis Song;citation_author=Andrew J. Ballard;citation_author=Justin Gilmer;citation_author=George E. Dahl;citation_author=Ashish Vaswani;citation_author=Kelsey R. Allen;citation_author=Charles Nash;citation_author=Victoria Langston;citation_author=Chris Dyer;citation_author=Nicolas Heess;citation_author=Daan Wierstra;citation_author=Pushmeet Kohli;citation_author=Matthew Botvinick;citation_author=Oriol Vinyals;citation_author=Yujia Li;citation_author=Razvan Pascanu;citation_publication_date=2018;citation_arxiv_id=1806.01261;">
    <meta name="citation_reference" content="citation_title=Spectral Networks and Locally Connected Networks on Graphs;citation_author=Joan Bruna;citation_author=Wojciech Zaremba;citation_author=Arthur Szlam;citation_author=Yann LeCun;citation_publication_date=2014;citation_arxiv_id=1312.6203;">
    <meta name="citation_reference" content="citation_title=ImageNet: A Large-Scale Hierarchical Image Database;citation_author=J. Deng;citation_author=W. Dong;citation_author=R. Socher;citation_author=L.-J. Li;citation_author=K. Li;citation_author=L. Fei-Fei;citation_publication_date=2009;">
    <meta name="citation_reference" content="citation_title=On the Transferability of Spectral Graph Filters;citation_author=Ron Levie;citation_author=Elvin Isufi;citation_author=Gitta Kutyniok;citation_publication_date=2019;citation_volume=;citation_number=;">
    <meta name="citation_reference" content="citation_title=Directional Graph Networks;citation_author=Dominique Beaini;citation_author=Saro Passaro;citation_author=Vincent Létourneau;citation_author=William L. Hamilton;citation_author=Gabriele Corso;citation_author=Pietro Liò;citation_publication_date=2021;">
    <meta name="citation_reference" content="citation_title=Deep contextualized word representations;citation_author=Matthew E. Peters;citation_author=Mark Neumann;citation_author=Mohit Iyyer;citation_author=Matt Gardner;citation_author=Christopher Clark;citation_author=Kenton Lee;citation_author=Luke Zettlemoyer;citation_publication_date=2018;">
    <meta name="citation_reference" content="citation_title=BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding;citation_author=Jacob Devlin;citation_author=Ming-Wei Chang;citation_author=Kenton Lee;citation_author=Kristina Toutanova;citation_publication_date=2019;">
    <meta name="citation_reference" content="citation_title=Strategies for Pre-training Graph Neural Networks;citation_author=Weihua Hu*;citation_author=Bowen Liu*;citation_author=Joseph Gomes;citation_author=Marinka Zitnik;citation_author=Percy Liang;citation_author=Vijay Pande;citation_author=Jure Leskovec;citation_publication_date=2020;">
    <meta name="citation_reference" content="citation_title=Multi-Stage Self-Supervised Learning for Graph Convolutional Networks on Graphs with Few Labeled Nodes;citation_author=Ke Sun;citation_author=Zhouchen Lin;citation_author=Zhanxing Zhu;citation_publication_date=2020;">
    <meta name="citation_reference" content="citation_title=When Does Self-Supervision Help Graph Convolutional Networks?;citation_author=Yuning You;citation_author=Tianlong Chen;citation_author=Zhangyang Wang;citation_author=Yang Shen;citation_publication_date=2020;citation_arxiv_id=2006.09136;">
    <meta name="citation_reference" content="citation_title=Self-supervised Learning on Graphs: Deep Insights and New Direction;citation_author=Wei Jin;citation_author=Tyler Derr;citation_author=Haochen Liu;citation_author=Yiqi Wang;citation_author=Suhang Wang;citation_author=Zitao Liu;citation_author=Jiliang Tang;citation_publication_date=2020;citation_arxiv_id=2006.10141;">
    <meta name="citation_reference" content="citation_title=Noise-Contrastive Estimation of Unnormalized Statistical Models, with Applications to Natural Image Statistics;citation_author=Michael U. Gutmann;citation_author=Aapo Hyvärinen;citation_publication_date=2012;citation_journal_title=Journal of Machine Learning Research;citation_volume=13;citation_number=11;">
    <meta name="citation_reference" content="citation_title=Learning word embeddings efficiently with noise-contrastive estimation;citation_author=Andriy Mnih;citation_author=Koray Kavukcuoglu;citation_publication_date=2013;citation_volume=26;">
    <meta name="citation_reference" content="citation_title=A Comprehensive Survey on Graph Neural Networks;citation_author=Z. Wu;citation_author=S. Pan;citation_author=F. Chen;citation_author=G. Long;citation_author=C. Zhang;citation_author=P. S. Yu;citation_publication_date=2020;citation_journal_title=IEEE Transactions on Neural Networks and Learning Systems;">
    <meta name="citation_reference" content="citation_title=Graph Neural Networks: A Review of Methods and Applications;citation_author=Jie Zhou;citation_author=Ganqu Cui;citation_author=Zhengyan Zhang;citation_author=Cheng Yang;citation_author=Zhiyuan Liu;citation_author=Maosong Sun;citation_publication_date=2018;citation_arxiv_id=1812.08434;">
    <meta name="citation_reference" content="citation_title=Dropout: A Simple Way to Prevent Neural Networks from Overfitting;citation_author=Nitish Srivastava;citation_author=Geoffrey Hinton;citation_author=Alex Krizhevsky;citation_author=Ilya Sutskever;citation_author=Ruslan Salakhutdinov;citation_publication_date=2014;citation_journal_title=Journal of Machine Learning Research;citation_volume=15;citation_number=56;">
    <meta name="citation_reference" content="citation_title=DropEdge: Towards Deep Graph Convolutional Networks on Node Classification;citation_author=Yu Rong;citation_author=Wenbing Huang;citation_author=Tingyang Xu;citation_author=Junzhou Huang;citation_publication_date=2020;">
    <meta name="citation_reference" content="citation_title=An End-to-End Deep Learning Architecture for Graph Classification;citation_author=Muhan Zhang;citation_author=Zhicheng Cui;citation_author=Marion Neumann;citation_author=Yixin Chen;citation_publication_date=2018;">
    <meta name="citation_reference" content="citation_title=Hierarchical Graph Representation Learning with Differentiable Pooling;citation_author=Zhitao Ying;citation_author=Jiaxuan You;citation_author=Christopher Morris;citation_author=Xiang Ren;citation_author=Will Hamilton;citation_author=Jure Leskovec;citation_publication_date=2018;citation_volume=31;">
    <meta name="citation_reference" content="citation_title=Self-Attention Graph Pooling;citation_author=Junhyun Lee;citation_author=Inyeop Lee;citation_author=Jaewoo Kang;citation_publication_date=2019;citation_volume=97;">
<link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"><link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"><link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"><link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"><link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"><link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"><link rel="stylesheet" href="Understanding%20Convolutions%20on%20Graphs_files/katex_002.css"></head>

<body distill-prerendered="" class="vsc-initialized" data-new-gr-c-s-check-loaded="8.899.0" data-gr-ext-installed=""><distill-header distill-prerendered="">
<style>
distill-header {
  position: relative;
  height: 60px;
  background-color: hsl(200, 60%, 15%);
  width: 100%;
  box-sizing: border-box;
  z-index: 2;
  color: rgba(0, 0, 0, 0.8);
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.05);
}
distill-header .content {
  height: 70px;
  grid-column: page;
}
distill-header a {
  font-size: 16px;
  height: 60px;
  line-height: 60px;
  text-decoration: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 22px 0;
}
distill-header a:hover {
  color: rgba(255, 255, 255, 1);
}
distill-header svg {
  width: 24px;
  position: relative;
  top: 4px;
  margin-right: 2px;
}
@media(min-width: 1080px) {
  distill-header {
    height: 70px;
  }
  distill-header a {
    height: 70px;
    line-height: 70px;
    padding: 28px 0;
  }
  distill-header .logo {
  }
}
distill-header svg path {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 3px;
}
distill-header .logo {
  font-size: 17px;
  font-weight: 200;
}
distill-header .nav {
  float: right;
  font-weight: 300;
}
distill-header .nav a {
  font-size: 12px;
  margin-left: 24px;
  text-transform: uppercase;
}
</style>
<div class="content">
  <a href="https://distill.pub/" class="logo">
    <svg viewBox="-607 419 64 64">
  <path d="M-573.4,478.9c-8,0-14.6-6.4-14.6-14.5s14.6-25.9,14.6-40.8c0,14.9,14.6,32.8,14.6,40.8S-565.4,478.9-573.4,478.9z"></path>
</svg>

    Distill
  </a>
  <nav class="nav">
    <a href="https://distill.pub/about/">About</a>
    <a href="https://distill.pub/prize/">Prize</a>
    <a href="https://distill.pub/journal/">Submit</a>
  </nav>
</div>
</distill-header>
  
  <d-front-matter>
    <script type="text/json">
      {
    "title": "Understanding Convolutions on Graphs",
    "description": "Understanding the building blocks and design choices of graph neural networks.",
    "authors": [
        {
            "author": "Ameya Daigavane",
            "authorURL": "https://ameya98.github.io/",
            "affiliation": "Google Research",
            "affiliationURL": "https://research.google/"
        },
        {
            "author": "Balaraman Ravindran",
            "authorURL": "https://www.cse.iitm.ac.in/~ravi/",
            "affiliation": "Google Research",
            "affiliationURL": "https://research.google/"
        },
        {
            "author": "Gaurav Aggarwal",
            "authorURL": "https://research.google/people/GauravAggarwal/",
            "affiliation": "Google Research",
            "affiliationURL": "https://research.google/"
        }
    ],
    "katex": {
        "delimiters": [
            {
                "left": "$",
                "right": "$",
                "display": false
            },
            {
                "left": "$$",
                "right": "$$",
                "display": true
            }
        ]
    }
}
    </script>
  </d-front-matter>

  <d-title>
    <h1>Understanding Convolutions on Graphs</h1>
    <p>Understanding the building blocks and design choices of graph neural networks.</p>
  </d-title>

  <d-byline>
  <div class="byline grid">
    <div class="authors-affiliations grid">
      <h3>Authors</h3>
      <h3>Affiliations</h3>
      
        <p class="author">
          
            <a class="name" href="https://ameya98.github.io/">Ameya Daigavane</a>
        </p>
        <p class="affiliation">
        <a class="affiliation" href="https://research.google/">Google Research</a>
        </p>
      
        <p class="author">
          
            <a class="name" href="https://www.cse.iitm.ac.in/~ravi/">Balaraman Ravindran</a>
        </p>
        <p class="affiliation">
        <a class="affiliation" href="https://research.google/">Google Research</a>
        </p>
      
        <p class="author">
          
            <a class="name" href="https://research.google/people/GauravAggarwal/">Gaurav Aggarwal</a>
        </p>
        <p class="affiliation">
        <a class="affiliation" href="https://research.google/">Google Research</a>
        </p>
      
    </div>
    <div>
      <h3>Published</h3>
      
        <p>Sept. 2, 2021</p> 
    </div>
    <div>
      <h3>DOI</h3>
      
        <p><a href="https://doi.org/10.23915/distill.00032">10.23915/distill.00032</a></p>
    </div>
  </div>
</d-byline><d-article>
    <d-contents>
      <nav class="l-text figcaption">
        <h3>Contents</h3>
        <div><a href="#introduction">Introduction</a></div>
        <div><a href="#challenges">The Challenges of Computation on Graphs</a></div>
        <ul>
          <li><a href="#lack-of-consistent-structure">Lack of Consistent Structure</a></li>
          <li><a href="#node-order">Node-Order Equivariance</a></li>
          <li><a href="#scalability">Scalability</a></li>
        </ul>
        <div><a href="#problem-and-notation">Problem Setting and Notation</a></div>
        <div><a href="#extending">Extending Convolutions to Graphs</a></div>
        <div><a href="#polynomial-filters">Polynomial Filters on Graphs</a></div>
        <div><a href="#modern-gnns">Modern Graph Neural Networks</a></div>
        <div><a href="#interactive">Interactive Graph Neural Networks</a></div>
        <div><a href="#from-local-to-global">From Local to Global Convolutions</a></div>
        <ul>
          <li><a href="#spectral">Spectral Convolutions</a></li>
          <li><a href="#graph-embeddings">Global Propagation via Graph Embeddings</a></li>
        </ul>
        <div><a href="#learning">Learning GNN Parameters</a></div>
        <!-- <div><a href="#gnns-vs-cnns">Are GNNs 'better' than CNNs?</a></div> -->
        <div><a href="#further-reading">Conclusions and Further Reading</a></div>
        <ul>
          <li><a href="#practical-techniques">GNNs in Practice</a></li>
          <li><a href="#different-kinds-of-graphs">Different Kinds of Graphs</a></li>
          <li><a href="#pooling">Pooling</a></li>
        </ul>
        <div><a href="#supplementary">Supplementary Material</a></div>
        <ul>
          <li><a href="#experiments-notebooks">Reproducing Experiments</a></li>
          <li><a href="#visualizations-notebooks">Recreating Visualizations</a></li>
        </ul>
      </nav>
    </d-contents>
    <div>
      <p><em>
        This article is one of two Distill publications about graph neural networks.
        Take a look at
        <a href="https://distill.pub/2021/gnn-intro/">A Gentle Introduction to Graph Neural Networks</a>
        <d-cite key="gnn-intro"></d-cite>
        for a companion view on many things graph and neural network related.
      </em></p>
      <p id="introduction">
        Many systems and interactions - social networks, molecules, 
organizations, citations, physical models, transactions - can be 
represented quite naturally as graphs.
        How can we reason about and make predictions within these 
systems?
      </p>
      <p>
        One idea is to look at tools that have worked well in other 
domains: neural networks have shown immense predictive power in a 
variety of learning tasks.
        However, neural networks have been traditionally used to operate
 on fixed-size and/or regular-structured inputs (such as sentences, 
images and video).
        This makes them unable to elegantly process graph-structured 
data.
      </p>
      <figure id="standard-neural-networks" class="l-page">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/standard-neural-networks.svg" style="width: 100%;" alt="Neural networks generally operate on fixed-size input vectors. How do we input a graph to a neural network?" title="How do we input a graph to a neural network?">
      </figure>
    </div>
    
    <p>
      Graph neural networks (GNNs) are a family of neural networks that can operate naturally on graph-structured data. 
      By extracting and utilizing features from the underlying graph,
      GNNs can make more informed predictions about entities in these interactions,
      as compared to models that consider individual entities in isolation.
    </p>
    <p>
      GNNs are not the only tools available to model graph-structured data:
      graph kernels <d-cite key="graph-kernels"></d-cite>
      and random-walk methods <d-cite key="node2vec,deepwalk"></d-cite>
      were some of the most popular ones.
      Today, however, GNNs have largely replaced these techniques
      because of their inherent flexibility to model the underlying systems
      better.
    </p>
    <p>
      In this article, we will illustrate
      the challenges of computing over graphs, 
      describe the origin and design of graph neural networks,
      and explore the most popular GNN variants in recent times.
      Particularly, we will see that many of these variants
      are composed of similar building blocks.
    </p>
    <p>
      First, let’s discuss some of the complications that graphs come with.
    </p>

    <h2 id="challenges">
      The Challenges of Computation on Graphs
    </h2>

    <h3 id="lack-of-consistent-structure">
      Lack of Consistent Structure
    </h3>
      <p>
        Graphs are extremely flexible mathematical models; but this means they lack consistent structure across instances.
        Consider the task of predicting whether a given chemical molecule is toxic <d-cite key="molecules-gnn,neural-message-passing"></d-cite>&nbsp;:
      </p>
      <figure class="l-page-outset" id="menthyl-nicotinate-molecule" style="display: inline-flex;">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/126-trigalloyl-glucose-molecule.svg" style="width: 50%;" alt="The molecular structure of non-toxic 1,2,6-trigalloyl-glucose.">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/caramboxin-molecule.svg" style="width: 25%; height: 60%; margin-top: 8%; margin-left: 10%;" alt="The molecular structure of toxic caramboxin.">
      </figure>
      <figure class="l-page-outset" style="display: flex; margin-top: 0%; margin-bottom: 3%;">
        <figure style="width: 50%; margin-left: 1%; margin-bottom: 0%;">
          <figcaption><b>Left:</b> A <span style="color: green;">non-toxic</span> 1,2,6-trigalloyl-glucose molecule.</figcaption>
        </figure>
        <figure style="width: 50%; margin-right: 15%; margin-bottom: 0%; text-align: right;">
          <figcaption><b>Right:</b> A <span style="color: rgba(228, 35, 35, 0.911);">toxic</span> caramboxin molecule.</figcaption>
        </figure>
      </figure>
      <p>
        Looking at a few examples, the following issues quickly become apparent:
      </p>
      <ul>
        <li>Molecules may have different numbers of atoms.</li>
        <li>The atoms in a molecule may be of different types.</li>
        <li>Each of these atoms may have different number of connections.</li>
        <li>These connections can have different strengths.</li>
      </ul>
      <p>
        Representing graphs in a format that can be computed over is non-trivial,
        and the final representation chosen often depends significantly on the actual problem.
      </p>

    <h3 id="node-order">
      Node-Order Equivariance
    </h3>
    <p>
      Extending the point above: graphs often have no inherent ordering present amongst the nodes.
      Compare this to images, where every pixel is uniquely determined by its absolute position within the image!
    </p>

      <figure id="node-order-alternatives" class="l-page" style="margin-bottom: 1em;">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/node-order-alternatives.svg" style="margin-bottom: 1em; margin-left: 15%; width: 70%;" alt="Representing the graph as one vector requires us to fix an order on the nodes. But what do we do when the nodes have no inherent order?">
        <figcaption style="text-align: center; margin-left: 10%; width: 80%;">
          Representing the graph as one vector requires us to fix an order on the nodes.
          But what do we do when the nodes have no inherent order?
          <b>Above:</b> 
          The same graph labelled in two different ways. The alphabets indicate the ordering of the nodes.
        </figcaption>
      </figure>
  
    <p>
      As a result, we would like our algorithms to be node-order equivariant:
      they should not depend on the ordering of the nodes of the graph.
      If we permute the nodes in some way, the resulting representations of 
      the nodes as computed by our algorithms should also be permuted in the same way.
    </p>

    <h3 id="scalability">
      Scalability
    </h3>
      <p>
        Graphs can be really large! Think about social networks like Facebook and Twitter, which have over a billion users. 
        Operating on data this large is not easy.
      </p>
      <p>
        Luckily, most naturally occuring graphs are ‘sparse’:
        they tend to have their number of edges linear in their number of vertices.
        We will see that this allows the use of clever methods
        to efficiently compute representations of nodes within the graph.
        Further, the methods that we look at here will have significantly fewer parameters
        in comparison to the size of the graphs they operate on.
      </p>

    <h2 id="problem-and-notation">
      Problem Setting and Notation
    </h2>
      <p>
        There are many useful problems that can be formulated over graphs:
      </p>
        <ul>
          <li><b>Node Classification:</b> Classifying individual nodes.</li>
          <li><b>Graph Classification:</b> Classifying entire graphs. </li>
          <li><b>Node Clustering:</b> Grouping together similar nodes based on connectivity.</li>
          <li><b>Link Prediction:</b> Predicting missing links.</li>
          <li><b>Influence Maximization:</b> Identifying influential nodes.</li>
        </ul>
      <figure id="graph-tasks" class="l-page">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/graph-tasks.svg" style="width: 100%;" alt="Examples of problems that can be defined over graphs.">
        <figcaption style="text-align: center;">
          Examples of problems that can be defined over graphs.
          This list is not exhaustive!
        </figcaption>
      </figure>
      <p>
        A common precursor in solving many of these problems is <b>node representation learning</b>:
        learning to map individual nodes to fixed-size real-valued vectors (called ‘representations’ or ‘embeddings’).
      </p>
      <p>
        In <a href="#learning">Learning GNN Parameters</a>, we will see how the learnt embeddings can be used for these tasks.
      </p>
      <p>
        Different GNN variants are distinguished by the way these representations are computed.
        Generally, however, GNNs compute node representations in an iterative process.
        We will use the notation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>h</mi><mi>v</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">h_v^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0448em;"></span><span class="strut bottom" style="height:1.161392em;vertical-align:-0.11659199999999997em;"></span><span class="base"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834080000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.11659199999999997em;"></span></span></span></span></span></span></span></span></span> to indicate the representation of node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> after the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>k</mi><mtext>th</mtext></msup></mrow><annotation encoding="application/x-tex">k^{\text{th}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">th</span></span></span></span></span></span></span></span></span></span></span></span></span></span> iteration.
        Each iteration can be thought of as the equivalent of a ‘layer’ in standard neural networks.
      </p>
      <p>
        We will define a graph <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> as a set of nodes, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span>, with a set of edges <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span></span> connecting them.
        Nodes can have individual features as part of the input: we will denote by <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> the individual feature for node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">v \in V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mrel">∈</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span>.
        For example, the ‘node features’ for a pixel in a color image
        would be the red, green and blue channel (RGB) values at that pixel.
      </p>
      <p>
        For ease of exposition, we will assume <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> is undirected, and all nodes are of the same type.
        <d-footnote>These kinds of graphs are called ‘homogeneous’.</d-footnote>
        Many of the same ideas we will see here 
        apply to other kinds of graphs:
        we will discuss this later in <a href="#different-kinds-of-graphs">Different Kinds of Graphs</a>.
      </p>
      <p>
        Sometimes we will need to denote a graph property by a matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span></span>,
        where each row <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">M_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> represents a property corresponding to a particular vertex <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span>.
      </p>

    <h2 id="extending">
      Extending Convolutions to Graphs
    </h2>
    <p>
      Convolutional Neural Networks have been seen to be quite powerful in extracting features from images.
      However, images themselves can be seen as graphs with a very regular grid-like structure,
      where the individual pixels are nodes, and the RGB channel values at each pixel as the node features.
    </p>
    <p>
      A natural idea, then, is to consider generalizing convolutions to arbitrary graphs. Recall, however, the challenges
      listed out in the <a href="#challenges">previous section</a>: in particular, ordinary convolutions are not node-order invariant, because
      they depend on the absolute positions of pixels.
      It is initially unclear as how to generalize convolutions over grids to convolutions over general graphs,
      where the neighbourhood structure differs from node to node.
      <d-footnote>
        The curious reader may wonder if performing some sort of padding and ordering
        could be done to ensure the consistency of neighbourhood structure across nodes.
        This has been attempted with some success <d-cite key="patchysan"></d-cite>,
        but the techniques we will look at here are more general and powerful.
      </d-footnote>
    </p>
    
    <figure id="cnns-vs-gnns-neigh" class="l-page" style="display: flex; align-items: center; flex-direction: column;">
      <div id="observablehq-cnn_svg-35509536" role="img" aria-label="GNNs can perform localized convolutions, similar to those in CNNs." style="text-align: center;" class="observablehq"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" sodipodi:docname="cnn.svg" inkscape:version="1.0.1 (c497b03c, 2020-09-10)" id="svg406" version="1.1" viewBox="0 0 130.28541 30" width="1015.6999999999999" height="218.76615384615383">
  <defs id="defs400">
    <marker style="overflow:visible" id="marker5798" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5796"></path>
    </marker>
    <marker style="overflow:visible" id="marker5702" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5700"></path>
    </marker>
    <marker style="overflow:visible" id="marker6129" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path6127"></path>
    </marker>
    <marker style="overflow:visible" id="marker5981" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5979"></path>
    </marker>
    <marker style="overflow:visible" id="Tail" refX="0" refY="0" orient="auto" inkscape:stockid="Tail" inkscape:isstock="true">
      <g transform="scale(-1.2)" id="g3579" style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1">
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -3.8048674,-3.9585227 0.54352094,0" id="path3567"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -1.2866832,-3.9585227 3.0617053,0" id="path3569"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M 1.3053582,-3.9585227 5.6537466,0" id="path3571"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -3.8048674,4.1775838 0.54352094,0.21974226" id="path3573"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -1.2866832,4.1775838 3.0617053,0.21974226" id="path3575"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M 1.3053582,4.1775838 5.6537466,0.21974226" id="path3577"></path>
      </g>
    </marker>
    <marker style="overflow:visible" id="marker4147" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4145"></path>
    </marker>
    <marker style="overflow:visible" id="marker4223" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4221"></path>
    </marker>
    <marker style="overflow:visible" id="marker4261" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4259"></path>
    </marker>
    <marker style="overflow:visible" id="marker4299" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4297"></path>
    </marker>
    <marker style="overflow:visible" id="marker4337" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4335"></path>
    </marker>
    <marker style="overflow:visible" id="marker3863" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path3861"></path>
    </marker>
    <marker style="overflow:visible" id="marker3198" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path3196"></path>
    </marker>
    <marker style="overflow:visible" id="Arrow2Send" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow2Send" inkscape:isstock="true">
      <path transform="matrix(-0.3,0,0,-0.3,0.69,0)" d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.625;stroke-linejoin:round;stroke-opacity:1" id="path2116"></path>
    </marker>
    <marker style="overflow:visible" id="Arrow1Send" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Send" inkscape:isstock="true">
      <path transform="matrix(-0.2,0,0,-0.2,-1.2,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2098"></path>
    </marker>
    <marker style="overflow:visible" id="Arrow1Lend" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Lend" inkscape:isstock="true">
      <path transform="matrix(-0.8,0,0,-0.8,-10,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2086"></path>
    </marker>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect335"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect338"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-2"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect341"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-24"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect344"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-26"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect347"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-9"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect350"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-53"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect353"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-4"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect600"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-5-0"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect603"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-2-0"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect606"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-24-9"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect609"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-26-3"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect612"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-9-7"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect615"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-53-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect618"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-4-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect952"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-5-0-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect955"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-2-0-8"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect958"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-24-9-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect961"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-26-3-6"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect964"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-9-7-7"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect967"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-53-5-9"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect970"></rect>
    <marker style="overflow:visible" id="Arrow1Mend-4" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2092-9"></path>
    </marker>
    <marker style="overflow:visible" id="marker2818-4" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2816-0"></path>
    </marker>
  </defs>
  <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="11.422788" inkscape:cx="218.67679" inkscape:cy="4.4071333" inkscape:document-units="mm" inkscape:current-layer="layer1" inkscape:document-rotation="0" showgrid="false" inkscape:window-width="1792" inkscape:window-height="993" inkscape:window-x="0" inkscape:window-y="25" inkscape:window-maximized="0"></sodipodi:namedview>
  <metadata id="metadata403">
    <rdf:rdf>
      <cc:work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
        <dc:title></dc:title>
      </cc:work>
    </rdf:rdf>
  </metadata>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-29.474211,-84.274269)">
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.264583" x="81.037849" y="111.85567" id="text2068"><tspan sodipodi:role="line" id="tspan2066" x="81.037849" y="111.85567" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.264583">Convolution in CNNs</tspan></text>
    <text xml:space="preserve" style="font-size:5.64444px;line-height:1.25;font-family:sans-serif;stroke-width:0.264583" x="45.22963" y="94.334717" id="text4486"><tspan sodipodi:role="line" id="tspan4484" x="45.22963" y="94.334717" style="stroke-width:0.264583"></tspan></text>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 43.434138,84.399266 V 104.39927" inkscape:label="MajorXDiv1" id="path3531"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 47.434138,84.399266 V 104.39927" inkscape:label="MajorXDiv2" id="path3533"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 51.434138,84.399266 V 104.39927" inkscape:label="MajorXDiv3" id="path3535"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 55.434138,84.399266 V 104.39927" inkscape:label="MajorXDiv4" id="path3537"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 39.434138,88.399266 h 20" inkscape:label="MajorYDiv1" id="path3541"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 39.434138,92.399266 h 20" inkscape:label="MajorYDiv2" id="path3543"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 39.434138,96.399266 h 20" inkscape:label="MajorYDiv3" id="path3545"></path>
    <path style="fill:none;stroke:#6c6060;stroke-width:0.05;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 39.434138,100.39927 h 20" inkscape:label="MajorYDiv4" id="path3547"></path>
    <rect x="39.434139" y="84.399269" width="20" height="20" style="fill:none;stroke:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" inkscape:label="Border" id="rect3551"></rect>
    <rect x="43.448975" y="88.410683" width="11.940943" height="11.908811" style="fill:none;stroke:#6c6060;stroke-width:0.149061;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" inkscape:label="Border" id="rect3551-3"></rect>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 43.554053,90.428891 v -1.928375 h 1.903332 1.903332 v 1.928375 1.928376 h -1.903332 -1.903332 z" id="path4719"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 43.554053,94.410862 v -1.95342 h 1.903332 1.903332 v 1.95342 1.953419 h -1.903332 -1.903332 z" id="path4721"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 47.460892,90.428891 v -1.928375 h 1.95342 1.953419 v 1.928375 1.928376 h -1.953419 -1.95342 z" id="path4723"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 43.554053,98.342745 v -1.878288 h 1.903332 1.903332 v 1.878288 1.878285 h -1.903332 -1.903332 z" id="path4727"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 47.460892,98.342745 v -1.878288 h 1.95342 1.953419 v 1.878288 1.878285 h -1.953419 -1.95342 z" id="path4729"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 51.467907,98.342745 v -1.878288 h 1.903331 1.903332 v 1.878288 1.878285 h -1.903332 -1.903331 z" id="path4731"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 51.467907,94.410862 v -1.95342 h 1.903331 1.903332 v 1.95342 1.953419 h -1.903332 -1.903331 z" id="path4733"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0473268;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke fill markers" d="m 51.467907,90.428891 v -1.928375 h 1.903331 1.903332 v 1.928375 1.928376 h -1.903332 -1.903331 z" id="path4735"></path>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="44.032829" y="93.288116" id="text1629-5-5-2-6-6" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-8" x="44.032829" y="93.288116" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">1</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="43.914642" y="97.158073" id="text1629-5-5-2-6-67" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-1" x="43.914642" y="97.158073" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">7</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="43.9039" y="101.21744" id="text1629-5-5-2-6-8" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-4" x="43.9039" y="101.21744" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">6</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="51.661804" y="101.21744" id="text1629-5-5-2-6-9" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-7" x="51.661804" y="101.21744" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">7</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="47.663635" y="101.21744" id="text1629-5-5-2-6-3" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-10" x="47.663635" y="101.21744" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">1</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="51.675785" y="97.158073" id="text1629-5-5-2-6-2" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-3" x="51.675785" y="97.158073" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">6</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="47.693604" y="93.288116" id="text1629-5-5-2-6-7" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-18" x="47.693604" y="93.288116" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">4</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="51.695076" y="93.288116" id="text1629-5-5-2-6-93" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-74" x="51.695076" y="93.288116" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">5</tspan></text>
    <g id="g5126" transform="translate(0.27122524,0.81929016)">
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 133.52847,83.579975 V 103.57998" inkscape:label="MajorXDiv1" id="path3531-9"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 137.52847,83.579975 V 103.57998" inkscape:label="MajorXDiv2" id="path3533-2"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 141.52847,83.579975 V 103.57998" inkscape:label="MajorXDiv3" id="path3535-9"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="M 145.52847,83.579975 V 103.57998" inkscape:label="MajorXDiv4" id="path3537-1"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 129.52847,87.579975 h 20" inkscape:label="MajorYDiv1" id="path3541-0"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 129.52847,91.579975 h 20" inkscape:label="MajorYDiv2" id="path3543-9"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 129.52847,95.579975 h 20" inkscape:label="MajorYDiv3" id="path3545-3"></path>
      <path style="fill:none;stroke:#6c6060;stroke-width:0.0499999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 129.52847,99.579979 h 20" inkscape:label="MajorYDiv4" id="path3547-0"></path>
      <rect x="129.52847" y="83.579979" width="20" height="20" style="fill:none;stroke:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" inkscape:label="Border" id="rect3551-0"></rect>
      <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="135.97316" y="96.321754" id="text1629-7-2-6-1-3-0" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-79-4-3-4-75-1" x="135.97316" y="96.321754" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">6</tspan></text>
    </g>
    <path style="fill:none;stroke:#000000;stroke-width:0.233;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:0.233, 2.796;stroke-dashoffset:0;stroke-opacity:1;marker-mid:url(#marker6129)" d="m 55.391097,88.425409 45.984583,2.190968 36.7185,1.749479" id="path5011" sodipodi:nodetypes="ccc"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.232521;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:0.232521, 2.79025;stroke-dashoffset:0;stroke-opacity:1;marker-mid:url(#marker5798)" d="m 55.387733,100.34623 45.323387,-2.196367 37.72532,-1.828166" id="path5013" sodipodi:nodetypes="ccc"></path>
    <path style="fill:#e2e2e2;fill-opacity:1;stroke:#000000;stroke-width:0.0526421;stroke-dasharray:0.0526421, 0.631706;paint-order:stroke fill markers" d="M 199.09199,10.130164 V 8.187385 h 1.94278 1.94278 v 1.942779 1.942779 h -1.94278 -1.94278 z" id="path1312" transform="translate(-151.59175,84.274269)"></path>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="47.622528" y="97.183395" id="text1629-5-5-2-6-7-2" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0-18-2" x="47.622528" y="97.183395" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">3</tspan></text>
  </g>
</svg></div>
      <figure style="position: relative; text-align: center; margin-top: 0; width: 30%;">
        <figcaption>
          Convolutions in CNNs are inherently localized.
          Neighbours participating in the convolution at the center pixel are highlighted in gray.
        </figcaption>
      </figure>
      <div id="observablehq-svg-35509536" style="text-align: center;" class="observablehq"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" sodipodi:docname="cnn-vs-gnn.svg" inkscape:version="1.0.1 (c497b03c, 2020-09-10)" id="svg406" version="1.1" viewBox="0 45 130.28541 45" width="1015.6999999999999" height="351.58846153846156">
  <defs id="defs400">
    <marker style="overflow:visible" id="marker5798" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5796"></path>
    </marker>
    <marker style="overflow:visible" id="marker5702" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5700"></path>
    </marker>
    <marker style="overflow:visible" id="marker6129" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path6127"></path>
    </marker>
    <marker style="overflow:visible" id="marker5981" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5979"></path>
    </marker>
    <marker style="overflow:visible" id="Tail" refX="0" refY="0" orient="auto" inkscape:stockid="Tail" inkscape:isstock="true">
      <g transform="scale(-1.2)" id="g3579" style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1">
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -3.8048674,-3.9585227 0.54352094,0" id="path3567"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -1.2866832,-3.9585227 3.0617053,0" id="path3569"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M 1.3053582,-3.9585227 5.6537466,0" id="path3571"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -3.8048674,4.1775838 0.54352094,0.21974226" id="path3573"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M -1.2866832,4.1775838 3.0617053,0.21974226" id="path3575"></path>
        <path style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.8;stroke-linecap:round;stroke-opacity:1" d="M 1.3053582,4.1775838 5.6537466,0.21974226" id="path3577"></path>
      </g>
    </marker>
    <marker style="overflow:visible" id="marker4147" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4145"></path>
    </marker>
    <marker style="overflow:visible" id="marker4223" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4221"></path>
    </marker>
    <marker style="overflow:visible" id="marker4261" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4259"></path>
    </marker>
    <marker style="overflow:visible" id="marker4299" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4297"></path>
    </marker>
    <marker style="overflow:visible" id="marker4337" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path4335"></path>
    </marker>
    <marker style="overflow:visible" id="marker3863" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path3861"></path>
    </marker>
    <marker style="overflow:visible" id="marker3198" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path3196"></path>
    </marker>
    <marker style="overflow:visible" id="marker3144" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true" inkscape:collect="always">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path3142"></path>
    </marker>
    <marker style="overflow:visible" id="marker2870" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true" inkscape:collect="always">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2868"></path>
    </marker>
    <marker style="overflow:visible" id="marker2818" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true" inkscape:collect="always">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2816"></path>
    </marker>
    <marker style="overflow:visible" id="Arrow2Send" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow2Send" inkscape:isstock="true">
      <path transform="matrix(-0.3,0,0,-0.3,0.69,0)" d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.625;stroke-linejoin:round;stroke-opacity:1" id="path2116"></path>
    </marker>
    <marker style="overflow:visible" id="Arrow1Send" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Send" inkscape:isstock="true">
      <path transform="matrix(-0.2,0,0,-0.2,-1.2,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2098"></path>
    </marker>
    <marker style="overflow:visible" id="Arrow1Lend" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Lend" inkscape:isstock="true">
      <path transform="matrix(-0.8,0,0,-0.8,-10,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2086"></path>
    </marker>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect335"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect338"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-2"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect341"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-24"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect344"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-26"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect347"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-9"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect350"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-53"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect353"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-4"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect600"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-5-0"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect603"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-2-0"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect606"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-24-9"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect609"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-26-3"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect612"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-9-7"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect615"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-53-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect618"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-4-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect952"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-5-0-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect955"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-2-0-8"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect958"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-24-9-5"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect961"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-26-3-6"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect964"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-9-7-7"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect967"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect2140-53-5-9"></rect>
    <rect x="20.293285" y="73.980583" width="4.6237864" height="7.1925564" id="rect970"></rect>
    <marker style="overflow:visible" id="Arrow1Mend-4" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2092-9"></path>
    </marker>
    <marker style="overflow:visible" id="marker2818-4" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Mend" inkscape:isstock="true">
      <path transform="matrix(-0.4,0,0,-0.4,-4,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path2816-0"></path>
    </marker>
  </defs>
  <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="9.8885723" inkscape:cx="85.860932" inkscape:cy="51.80526" inkscape:document-units="mm" inkscape:current-layer="layer1" inkscape:document-rotation="0" showgrid="false" inkscape:window-width="1792" inkscape:window-height="993" inkscape:window-x="0" inkscape:window-y="25" inkscape:window-maximized="0"></sodipodi:namedview>
  <metadata id="metadata403">
    <rdf:rdf>
      <cc:work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
        <dc:title></dc:title>
      </cc:work>
    </rdf:rdf>
  </metadata>
  <g inkscape:groupmode="layer" id="layer2" inkscape:label="Layer 2" transform="translate(-29.474211,-84.274269)">
    
    
  <path d="m 34.352787,156.81042 l 45.5671215,-0.000005000000001587068 l 45.5671215,-0.000005000000001587068" class="gnn-arrows" stroke="#000000" fill="none" stroke-width="0.264583" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="0.264583, 3.175" stroke-dashoffset="0" stroke-opacity="1" marker-mid="url(#marker3144)"></path><path d="m 47.755238,143.35873 l 38.865896000000006,6.725839999999991 l 38.865896000000006,6.725839999999991" class="gnn-arrows" stroke="#000000" fill="none" stroke-width="0.264583" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="4" stroke-dasharray="0.264583, 3.175" stroke-dashoffset="0" stroke-opacity="1" marker-mid="url(#marker3144)"></path></g>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-29.474211,-84.274269)">
    <path style="fill:none;stroke:#130e05;stroke-width:0.280985;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:0.96371;paint-order:stroke fill markers" d="m 130.81757,131.80783 -8.83343,9.50391 16.90536,2.19322 3.35061,24.41774" id="path5587-2-6"></path>
    <path style="fill:none;stroke:#050505;stroke-width:0.280546px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:0.987903;paint-order:stroke fill markers" d="m 125.18245,156.81042 13.70705,-13.30546 19.18987,16.08353" id="path5597-9-8"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.280546px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;paint-order:stroke fill markers" d="m 138.8895,143.50496 14.92545,-5.26371" id="path5599-7-3"></path>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-A-after" class="node-after" cx="130.89372" cy="131.88092" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-A-after-dummy" class="dummy-node" cx="130.89372" cy="131.88092" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-F-after" class="node-after" cx="142.69701" cy="167.81644" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-F-after-dummy" class="dummy-node" cx="142.69701" cy="167.81644" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-C-after" class="node-after" cx="138.8895" cy="143.35873" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-C-after-dummy" class="dummy-node" cx="138.8895" cy="143.35873" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-D-after" class="node-after" cx="153.96725" cy="138.38744" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-D-after-dummy" class="dummy-node" cx="153.96725" cy="138.38744" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-E-after" class="node-after" cx="125.48703" cy="156.81041" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-E-after-dummy" class="dummy-node" cx="125.48703" cy="156.81041" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-G-after" class="node-after" cx="157.92706" cy="159.88091" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-G-after-dummy" class="dummy-node" cx="157.92706" cy="159.88091" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-B-after" class="node-after" cx="122.44104" cy="140.87308" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-B-after-dummy" class="dummy-node" cx="122.44104" cy="140.87308" rx="5" ry="5"></ellipse>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="119.21555" y="144.61508" id="text1629-2-4-5" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-7-2-5" x="119.21555" y="144.61508" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">4</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="135.41678" y="147.17316" id="text1629-3-1-2" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-9-9-4" x="135.41678" y="147.17316" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">6</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="122.19999" y="160.8163" id="text1629-7-2-9" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-79-4-4" x="122.19999" y="160.8163" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">1</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="139.04074" y="172.11452" id="text1629-5-5-4" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-3-8-7" x="139.04074" y="172.11452" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">2</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="154.07358" y="164.01392" id="text1629-33-6-9" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-8-2-5" x="154.07358" y="164.01392" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">5</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="150.12581" y="141.95039" id="text1629-58-5-5" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-96-1-6" x="150.12581" y="141.95039" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">4</tspan></text>
    <path style="fill:none;stroke:#130e05;stroke-width:0.280985;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:0.96371;paint-order:stroke fill markers" d="m 39.683307,131.80783 -8.833433,9.50391 16.905363,2.19322 3.350602,24.41775" id="path5587-2-1-1"></path>
    <path style="fill:none;stroke:#050505;stroke-width:0.280546px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:0.987903;paint-order:stroke fill markers" d="m 34.048183,156.81043 13.707054,-13.30547 19.189862,16.08353" id="path5597-9-6-5"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.280546px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;paint-order:stroke fill markers" d="m 47.755237,143.50496 14.925451,-5.26371" id="path5599-7-1-9"></path>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-A-before" class="node-before" cx="39.759457" cy="131.88094" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-A-before-dummy" class="dummy-node" cx="39.759457" cy="131.88094" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-F-before" class="node-before" cx="51.562744" cy="167.81644" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-F-before-dummy" class="dummy-node" cx="51.562744" cy="167.81644" rx="5" ry="5"></ellipse>
    <ellipse style="fill: rgb(226, 226, 226); fill-opacity: 1; stroke: rgb(0, 0, 0); stroke-width: 0.16223px; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; paint-order: stroke;" id="node-C-before" class="node-before" cx="47.755238" cy="143.35873" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-C-before-dummy" class="dummy-node" cx="47.755238" cy="143.35873" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-D-before" class="node-before" cx="62.832981" cy="138.38745" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-D-before-dummy" class="dummy-node" cx="62.832981" cy="138.38745" rx="5" ry="5"></ellipse>
    <ellipse style="fill: rgb(226, 226, 226); fill-opacity: 1; stroke: rgb(0, 0, 0); stroke-width: 0.16223px; stroke-miterlimit: 4; stroke-dasharray: none; stroke-opacity: 1; paint-order: stroke;" id="node-E-before" class="node-before" cx="34.352787" cy="156.81042" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-E-before-dummy" class="dummy-node" cx="34.352787" cy="156.81042" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-G-before" class="node-before" cx="66.792793" cy="159.88091" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-G-before-dummy" class="dummy-node" cx="66.792793" cy="159.88091" rx="5" ry="5"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.16223;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="node-B-before" class="node-before" cx="31.306782" cy="140.87309" rx="1.7514559" ry="1.6814617"></ellipse>
    <ellipse style="fill:#ffffff;fill-opacity:0;stroke:#000000;stroke-width:0;" id="node-B-before-dummy" class="dummy-node" cx="31.306782" cy="140.87309" rx="5" ry="5"></ellipse>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="38.216156" y="135.39996" id="text1629-55-5-9" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-5-3-5" x="38.216156" y="135.39996" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">1</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="29.936821" y="144.6151" id="text1629-2-4-9-1" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-7-2-0-7" x="29.936821" y="144.6151" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">7</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="46.138046" y="147.17317" id="text1629-3-1-5-4" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-9-9-5-5" x="46.138046" y="147.17317" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">3</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="32.921261" y="160.81631" id="text1629-7-2-6-1" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-79-4-3-4" x="32.921261" y="160.81631" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">6</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="49.762009" y="172.11453" id="text1629-5-5-2-6" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-3-8-6-0" x="49.762009" y="172.11453" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">1</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="64.784181" y="164.01393" id="text1629-33-6-8-3" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-8-2-9-2" x="64.784181" y="164.01393" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">7</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="60.847054" y="141.95041" id="text1629-58-5-1-2" transform="scale(1.0207835,0.97963965)"><tspan sodipodi:role="line" id="tspan1627-96-1-4-1" x="60.847054" y="141.95041" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">6</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82223px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.264583" x="73.734978" y="173.28056" id="text2068-4"><tspan sodipodi:role="line" id="tspan2066-7" x="73.734978" y="173.28056" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82223px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.264583">Localized Convolution in GNNs</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;line-height:1.25;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.0895329" x="127.51811" y="135.38573" id="text1629-58-5-5-8" transform="scale(1.0207835,0.97963966)"><tspan sodipodi:role="line" id="tspan1627-96-1-6-0" x="127.51811" y="135.38573" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.38755px;font-family:'Avenir Next';-inkscape-font-specification:'Avenir Next';stroke-width:0.0895329">2</tspan></text>
    <text xml:space="preserve" style="font-size:5.64444px;line-height:1.25;font-family:sans-serif;stroke-width:0.264583" x="45.22963" y="94.334717" id="text4486"><tspan sodipodi:role="line" id="tspan4484" x="45.22963" y="94.334717" style="stroke-width:0.264583"></tspan></text>
  </g>
</svg></div>
      <figure style="position: relative; text-align: center; margin-top: 1%; width: 40%;">
        <figcaption>
          GNNs can perform localized convolutions mimicking CNNs.
          Hover over a node to see its immediate neighbourhood highlighted on the left.
          The structure of this neighbourhood changes from node to node.
        </figcaption>
      </figure>

      <script type="module">
      import {Runtime, Inspector} from "./observablehq-base/runtime.js";
      import define from "./notebooks/neighbourhoods-for-cnns-and-gnns.js";
      setTimeout(() => {
        new Runtime().module(define, name => {
          if (name === "cnn_svg") return new Inspector(document.querySelector("#observablehq-cnn_svg-35509536"));
          if (name === "svg") return new Inspector(document.querySelector("#observablehq-svg-35509536"));
          return ["adjust_dimensions","reset_nodes","highlight_nodes","get_node_position","remove_old_arrows","draw_arrows_to_updated_node","add_interactivity","on_selected_node_change","updated_node_position"].includes(name);
        });
      }, 200);
      </script>
    </figure>
    <p>
      We begin by introducing the idea of constructing polynomial filters over node neighbourhoods,
      much like how CNNs compute localized filters over neighbouring pixels.
      Then, we will see how more recent approaches extend on this idea with more powerful mechanisms.
      Finally, we will discuss alternative methods
      that can use ‘global’ graph-level information for computing node representations.
    </p>

    <h2 id="polynomial-filters">
      Polynomial Filters on Graphs
    </h2>
      <h3 style="margin-top: 0;">
        The Graph Laplacian
      </h3>
      <p>
        Given a graph <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span>, let us fix an arbitrary ordering of the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">n</span></span></span></span></span> nodes of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span>.
        We denote the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathrm">0</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span></span> adjacency matrix of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> by <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span></span>, we can construct the diagonal degree matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02778em;">D</span></span></span></span></span> of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> as:      
      </p>
      <div style="position: relative; display: flex;">
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>v</mi></msub><mo>=</mo><msub><mo>∑</mo><mi>u</mi></msub><msub><mi>A</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          D_v = \sum_u A_{vu}.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.3000100000000003em;vertical-align:-1.250005em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"></span></span></span></span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        <figure id="diagonal-degree-matrix">
          <figcaption style="margin-left: 15%; margin-top: -2%;">
            The degree of node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> is the number of edges incident at <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span>.
          </figcaption>
        </figure>
      </div>
      <p>
        where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_{vu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> denotes the entry in the row corresponding to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> and the column corresponding to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">u</span></span></span></span></span>
        in the matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span></span>. We will use this notation throughout this section.
      </p>
      <p>
        Then, the graph Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> is the square <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">n</span><span class="mbin">×</span><span class="mord mathit">n</span></span></span></span></span> matrix defined as:
        <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mi>D</mi><mo>−</mo><mi>A</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          L = D - A.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mbin">−</span><span class="mord mathit">A</span><span class="mord mathrm">.</span></span></span></span></span>
      </p>
      <figure id="laplacian" class="l-page">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/laplacian.svg" style="margin-right: 0%; margin-left: 10%; width: 70%; margin-bottom: 1em;">
        <figcaption style="text-align: center; width: 70%; margin-left: 15%;">
          The Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> for an undirected graph <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span>, with the row corresponding to node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>C</mtext></mrow><annotation encoding="application/x-tex">\textsf{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord text"><span class="mord mathsf">C</span></span></span></span></span></span> highlighted.
          Zeros in <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> are not displayed above.
          The Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> depends only on the structure of the graph <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span>, not on any node features.
        </figcaption>
      </figure>
      <p>
        The graph Laplacian gets its name from being the discrete analog of the
        <a href="https://mathworld.wolfram.com/Laplacian.html">Laplacian operator</a>
        from calculus.
      </p>
      <p>
        Although it encodes precisely the same information as the adjacency matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span></span>
        <d-footnote>
          In the sense that given either of the matrices <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span></span> or <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>, you can construct the other.
        </d-footnote>,
        the graph Laplacian has many interesting properties of its own.
        <d-footnote>
          The graph Laplacian shows up in many mathematical problems involving graphs:
          <a href="https://people.math.sc.edu/lu/talks/nankai_2014/spec_nankai_2.pdf">random walks</a>,
          <a href="https://arxiv.org/abs/0711.0189">spectral clustering</a><d-cite key="spectral-clustering"></d-cite>,
          and
          <a href="https://www.math.fsu.edu/~bertram/lectures/Diffusion.pdf">diffusion</a>, to name a few.
        </d-footnote>
        We will see some of these properties
        in <a href="#spectral">a later section</a>,
        but will instead point readers to
        <a href="https://csustan.csustan.edu/~tom/Clustering/GraphLaplacian-tutorial.pdf">this tutorial</a>
        for greater insight into the graph Laplacian.
      </p>

      <h3>
        Polynomials of the Laplacian
      </h3>
      <p>
        Now that we have understood what the graph Laplacian is,
        we can build polynomials <d-cite key="chebnet"></d-cite> of the form:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><msub><mi>I</mi><mi>n</mi></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><mi>L</mi><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msup><mi>L</mi><mn>2</mn></msup><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>w</mi><mi>d</mi></msub><msup><mi>L</mi><mi>d</mi></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msup><mi>L</mi><mi>i</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          p_w(L) = w_0 I_n + w_1 L + w_2 L^2 + \ldots + w_d L^d = \sum_{i = 0}^d w_i L^i.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8361130000000003em;"></span><span class="strut bottom" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathit">L</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="minner">…</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        Each polynomial of this form can alternately be represented by
        its vector of coefficients <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>=</mo><mo>[</mo><msub><mi>w</mi><mn>0</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>w</mi><mi>d</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">w = [w_0, \ldots, w_d]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>.
        Note that for every <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_w(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span></span></span></span></span> is an <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">n</span><span class="mbin">×</span><span class="mord mathit">n</span></span></span></span></span> matrix, just like <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>.
      </p>
      <p>
        These polynomials can be thought of as the equivalent of ‘filters’ in CNNs,
        and the coefficients <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span></span> as the weights of the ‘filters’.
      </p>
      <p>
        For ease of exposition, we will focus on the case where nodes have one-dimensional features:
        each of the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> for <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">v \in V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mrel">∈</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span> is just a real number. 
        The same ideas hold when each of the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> are higher-dimensional vectors, as well.
      </p>
      <p>
        Using the previously chosen ordering of the nodes,
        we can stack all of the node features <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>
        to get a vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.72799em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>.
      </p>
      <figure id="node-order-vector" class="l-body">
        <img src="Understanding%20Convolutions%20on%20Graphs_files/node-order-vector.svg" style="margin-right: 10%; margin-left: 10%; margin-bottom: 1%; width: 80%;" alt="Fixing a node order and collecting all node features into a single vector.">
        <figcaption style="text-align: center;">
          Fixing a node order (indicated by the alphabets) and collecting all node features into a single vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>.
        </figcaption>
      </figure>
      <p>
        Once we have constructed the feature vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>,
        we can define its convolution with a polynomial filter <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">p_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> as:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mtext>&nbsp;</mtext><mi>x</mi></mrow><annotation encoding="application/x-tex">
          x’ = p_w(L) \ x
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mord mathit"><span class="mspace">&nbsp;</span><span class="mord mathit">x</span></span></span></span></span></span></span>
        To understand how the coefficients <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span></span> affect the convolution,
        let us begin by considering the ‘simplest’ polynomial:
        when <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_0 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span> and all of the other coefficients are <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span>.
        In this case, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is just <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mtext>&nbsp;</mtext><mi>x</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msup><mi>L</mi><mi>i</mi></msup><mi>x</mi><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><msub><mi>I</mi><mi>n</mi></msub><mi>x</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          x’ = p_w(L) \ x = \sum_{i = 0}^d w_i L^ix = w_0 I_n x = x.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8361130000000003em;"></span><span class="strut bottom" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mord mathit"><span class="mspace">&nbsp;</span><span class="mord mathit">x</span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathit">x</span><span class="mord mathrm">.</span></span></span></span></span></span>
        Now, if we increase the degree, and consider the case where
        instead <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_1 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span> and and all of the other coefficients are <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span>.
        Then, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is just <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Lx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span><span class="mord mathit">x</span></span></span></span></span>, and so:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>x</mi><mi>v</mi><mo mathvariant="normal">′</mo></msubsup><mo>=</mo><mo>(</mo><mi>L</mi><mi>x</mi><msub><mo>)</mo><mi>v</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>L</mi><mi>v</mi></msub><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow></msub><msub><mi>L</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow></msub><mo>(</mo><msub><mi>D</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>−</mo><msub><mi>A</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>)</mo><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>D</mi><mi>v</mi></msub><mtext>&nbsp;</mtext><msub><mi>x</mi><mi>v</mi></msub><mo>−</mo><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mi>v</mi><mo>)</mo></mrow></msub><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
          \begin{aligned}
           x’_v = (Lx)_v &amp;= L_v x \\ 
                         &amp;= \sum_{u \in G} L_{vu} x_u \\ 
                         &amp;= \sum_{u \in G} (D_{vu} - A_{vu}) x_u \\ 
                         &amp;= D_v \ x_v - \sum_{u \in \mathcal{N}(v)} x_u
          \end{aligned}
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:5.104716000000001em;"></span><span class="strut bottom" style="height:9.709432000000001em;vertical-align:-4.604716000000001em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.104716000000001em;"><span style="top:-7.3147210000000005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-5.604716em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"></span></span><span style="top:-2.9330049999999996em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"></span></span><span style="top:-0.26129399999999947em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.604716000000001em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.104716000000001em;"><span style="top:-7.3147210000000005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathit">x</span></span></span><span style="top:-5.604716em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-2.9330049999999996em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-0.26129399999999947em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.604716000000001em;"></span></span></span></span></span></span></span></span></span></span></span>
        We see that the features at each node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> are combined
        with the features of its immediate neighbours <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>∈</mo><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">u \in \mathcal{N}(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">u</span><span class="mrel">∈</span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span>.
        <d-footnote>
          For readers familiar with
          <a href="https://docs.opencv.org/3.4/d5/db5/tutorial_laplace_operator.html">Laplacian filtering of images</a>,
          this is the exact same idea. When <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> is an image, 
          <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>L</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">x’ = Lx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord mathit">L</span><span class="mord mathit">x</span></span></span></span></span> is exactly the result of applying a ‘Laplacian filter’ to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>.
        </d-footnote>
      </p>
      <p>
        At this point, a natural question to ask is:
        How does the degree <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span></span> of the polynomial influence the behaviour of the convolution?
        Indeed, it is not too hard to show that:
        <d-footnote>This is Lemma 5.2 from <d-cite key="wavelets-graphs"></d-cite>.</d-footnote>
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mtext>dist</mtext><mi>G</mi></msub><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo>)</mo><mo>&gt;</mo><mi>i</mi><mspace width="1em"></mspace><mo>⟹</mo><mspace width="1em"></mspace><msubsup><mi>L</mi><mrow><mi>v</mi><mi>u</mi></mrow><mi>i</mi></msubsup><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          \text{dist}_G(v, u) &gt; i \quad \Longrightarrow \quad L_{vu}^i = 0.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8746639999999999em;"></span><span class="strut bottom" style="height:1.1246639999999999em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord text"><span class="mord mathrm">dist</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit">u</span><span class="mclose">)</span><span class="mrel">&gt;</span><span class="mord mathit">i</span><span class="mrel"><span class="mspace quad"></span><span class="mrel">⟹</span></span><span class="mord"><span class="mspace quad"></span><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span></span></span></span></span></span>
      
        This implies, when we convolve <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> with <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_w(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span></span></span></span></span> of degree <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span></span> to get <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>x</mi><mi>v</mi><mo mathvariant="normal">′</mo></msubsup><mo>=</mo><mo>(</mo><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mi>x</mi><msub><mo>)</mo><mi>v</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>(</mo><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><msub><mo>)</mo><mi>v</mi></msub><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msubsup><mi>L</mi><mi>v</mi><mi>i</mi></msubsup><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow></msub><msubsup><mi>L</mi><mrow><mi>v</mi><mi>u</mi></mrow><mi>i</mi></msubsup><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mo>∑</mo><mfrac linethickness="0px"><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow><mrow><msub><mtext>dist</mtext><mi>G</mi></msub><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo>)</mo><mo>≤</mo><mi>i</mi></mrow></mfrac></msub><msubsup><mi>L</mi><mrow><mi>v</mi><mi>u</mi></mrow><mi>i</mi></msubsup><msub><mi>x</mi><mi>u</mi></msub><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
          \begin{aligned}
          x’_v = (p_w(L)x)_v  &amp;= (p_w(L))_v x \\
              &amp;= \sum_{i = 0}^d w_i L_v^i x \\
              &amp;= \sum_{i = 0}^d w_i \sum_{u \in G} L_{vu}^i x_u \\
              &amp;= \sum_{i = 0}^d w_i \sum_{u \in G \atop \text{dist}_G(v, u) \leq i} L_{vu}^i x_u.
          \end{aligned}
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:6.452574500000001em;"></span><span class="strut bottom" style="height:12.405149000000002em;vertical-align:-5.9525745em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.452574500000001em;"><span style="top:-9.448687500000002em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-6.952574500000001em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span><span style="top:-3.538792500000001em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span><span style="top:-0.08097350000000025em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.9525745em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.452574500000001em;"><span style="top:-9.448687500000002em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathit">x</span></span></span><span style="top:-6.952574500000001em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord mathit">x</span></span></span><span style="top:-3.538792500000001em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-0.08097350000000025em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.6626299999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9590928571428571em;"><span style="top:-2.1917142857142853em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">dist</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-right:0.1em;"><span class="pstrut" style="height:2.6833299999999998em;"></span><span class="mord mathit mtight">G</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.33853em;"></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">u</span><span class="mclose mtight">)</span><span class="mrel mtight">≤</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-3.0067142857142852em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5858071428571429em;"></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.897435em;"></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.9525745em;"></span></span></span></span></span></span></span></span></span></span></span>
      </p><p>
        Effectively, the convolution at node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> occurs only with nodes <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">u</span></span></span></span></span> which are not more than <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span></span> hops away.
        Thus, these polynomial filters are localized. The degree of the localization is governed completely by <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">d</span></span></span></span></span>.
      </p>
      <p>
        To help you understand these ‘polynomial-based’ convolutions better, we have created the visualization below.
        Vary the polynomial coefficients and the input grid <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> to see how the result <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> of the convolution changes.
        The grid under the arrow shows the equivalent convolutional kernel applied at the highlighted pixel in <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> to get
        the resulting pixel in <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>.
        The kernel corresponds to the row of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p_w(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span></span></span></span></span> for the highlighted pixel.
        Note that even after adjusting for position,
        this kernel is different for different pixels, depending on their position within the grid.
      </p>
        <div class="shaded-figure l-screen" id="polynomial-convolutions" style="grid-column: page;" role="img" aria-label="An interactive visualization showing polynomial convolutions on an input grid.">
          <div id="observablehq-grid_buttons_display-05850d43" style="margin-bottom: 1em;" class="observablehq"><span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container">
      <button>Reset Grid</button>
      <button id="randomize">Randomize Grid</button>
    </div></span></div>
          <div id="observablehq-poly_color_scale-05850d43" style="display: flex; justify-content: center; margin-bottom: 30px;" class="observablehq"><svg width="320" height="50" viewBox="0,0,320,50" style="overflow: visible; display: block;"><image x="0" y="18" width="320" height="10" preserveAspectRatio="none" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAA/UlEQVQ4T3WQ23EFIQxDMVtIykv/BYAjyQ/Ym+SDkXUkw87a9/jyx8Z4zHDeOv/l6M7odgeDZilzaDJq++KphkfVm3NMzMZZbI7KDI+dLLhYdjoHM91zOsdHxq5O937zyJ/u0ePSy2PG/mEPZt6biq48Ne+iVz9VuUWPPBQnmXatWKhXn7wOfzpmv5jj/2MBrDJ6k3dwPAzlGaGfHkFn6Ozy0M2dWzV7MB3vfs1/6cJFwaNPXTkvgOI1M6udZrgjePSp5V+MPWZXvsun9n75T+W38Z2Ll9e3gnvmxV0cfyd5KDx4z9rbuc9unO1nbqZsZSd1hW7xOyt/5eq+zw/+tV6miFyQngAAAABJRU5ErkJggg=="></image><g transform="translate(0,28)" fill="none" font-size="10" font-family="sans-serif" text-anchor="middle"><g class="tick" opacity="1" transform="translate(0.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">−2</text></g><g class="tick" opacity="1" transform="translate(47.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">−1</text></g><g class="tick" opacity="1" transform="translate(160.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">0</text></g><g class="tick" opacity="1" transform="translate(273.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">1</text></g><g class="tick" opacity="1" transform="translate(320.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">2</text></g><text x="0" y="-16" fill="currentColor" text-anchor="start" font-weight="bold" class="title">Color Scale</text></g></svg></div>
          <div id="observablehq-poly_figcaptions-05850d43" style="position: relative; top: -50px;" class="observablehq"><div id="figcaptions" style="position: relative; left: 55px; top: 25px;">
    <figcaption id="orig-nat-caption-1">Input Grid</figcaption>
    <figcaption id="orig-nat-caption-2"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mn>25</mn></msup></mrow><annotation encoding="application/x-tex">x \in \{0, 1\}^{25}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></figcaption>
    <figcaption id="poly-caption"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_w(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.02691em;" class="mord mathdefault mtight">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mclose">)</span></span></span></span></figcaption>
    <figcaption id="kernel-caption">Convolutional Kernel at Highlighted Pixel</figcaption>
    <figcaption id="upd-nat-caption-1">Output Grid</figcaption>
    <figcaption id="upd-nat-caption-2"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo lspace="0em" rspace="0em" mathvariant="normal">′</mo></msup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mn>25</mn></msup></mrow><annotation encoding="application/x-tex">x' \in \mathbb{R}^{25}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.790992em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></figcaption>
</div></div>
          <div id="observablehq-poly_conv_main_div-05850d43" class="observablehq"><span><style>
   
   #poly-main-div {
      position: relative;
      height: 220px;
   }

   #poly-svg {
      position: absolute;
      left: 0px;
      top: 0px;
   }

   #figcaptions {
      position: relative;
   }

   #figcaptions figcaption {
      position: absolute;
   }

   #orig-nat-caption-1 {
      left: 170px;
      top: 140px;
   }
   #orig-nat-caption-2 {
      left: 170px;
      top: 160px;
   }
   #poly-caption {
      left: 460px;
      top: 90px;
   }
   #kernel-caption {
      left: 360px;
      top: 230px;
   }
   #upd-nat-caption-1 {
      left: 725px;
      top: 140px;
   }
   #upd-nat-caption-2 {
      left: 740px;
      top: 160px;
   }

   #poly_conv_sliders form {
      margin-left: 5%;
      margin-right: 5%;
   }
    
   #poly_conv_sliders input {
      width: 80%;
   }

   #poly_conv_sliders output {
      width: 3em;
      margin-left: 0 !important;
   }

   #poly_conv_sliders {
      display: flex;
      width: 60%;
      margin: 0 auto;
      text-align: center;
      align-items: center; 
      justify-content: center; 
    }
  
   input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }

   input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }

   input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
   }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
</style>
  <div id="poly-main-div">
    <svg id="poly-svg" viewBox="0,0,1000,220" width="1000" height="220"><g id="all-g" transform="translate(35,-75)"><g class="img" id="orig-img" transform="translate(170,80)"><g class="img-rows"><rect class="pixel rect_0" stroke="lightgray" x="0" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_1" stroke="lightgray" x="20" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_2" stroke="lightgray" x="40" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_3" stroke="lightgray" x="60" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_4" stroke="lightgray" x="80" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_5" stroke="lightgray" x="0" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_6" stroke="lightgray" x="20" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_7" stroke="lightgray" x="40" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_8" stroke="lightgray" x="60" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_9" stroke="lightgray" x="80" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_10" stroke="lightgray" x="0" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_11" stroke="lightgray" x="20" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_12" stroke="#191970" x="40" y="40" width="19.4" height="19.4" stroke-width="2" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_13" stroke="lightgray" x="60" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_14" stroke="lightgray" x="80" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_15" stroke="lightgray" x="0" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_16" stroke="lightgray" x="20" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_17" stroke="lightgray" x="40" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_18" stroke="lightgray" x="60" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_19" stroke="lightgray" x="80" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_20" stroke="lightgray" x="0" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_21" stroke="lightgray" x="20" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_22" stroke="lightgray" x="40" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_23" stroke="lightgray" x="60" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect><rect class="pixel rect_24" stroke="lightgray" x="80" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(50, 123, 181)"></rect></g></g><g class="img" id="conv-kernel" transform="translate(450,170)"><g class="img-rows"><rect class="pixel rect_0" stroke="lightgray" x="0" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_1" stroke="lightgray" x="20" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_2" stroke="lightgray" x="40" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_3" stroke="lightgray" x="60" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_4" stroke="lightgray" x="80" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_5" stroke="lightgray" x="0" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_6" stroke="lightgray" x="20" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_7" stroke="lightgray" x="40" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_8" stroke="lightgray" x="60" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_9" stroke="lightgray" x="80" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_10" stroke="lightgray" x="0" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_11" stroke="lightgray" x="20" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_12" stroke="#191970" x="40" y="40" width="19.4" height="19.4" stroke-width="2" fill="rgb(12, 62, 116)"></rect><rect class="pixel rect_13" stroke="lightgray" x="60" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_14" stroke="lightgray" x="80" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_15" stroke="lightgray" x="0" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_16" stroke="lightgray" x="20" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_17" stroke="lightgray" x="40" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_18" stroke="lightgray" x="60" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(250, 210, 188)"></rect><rect class="pixel rect_19" stroke="lightgray" x="80" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect class="pixel rect_20" stroke="lightgray" x="0" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_21" stroke="lightgray" x="20" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_22" stroke="lightgray" x="40" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_23" stroke="lightgray" x="60" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect><rect class="pixel rect_24" stroke="lightgray" x="80" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 239, 238)"></rect></g></g><g class="img" id="upd-img" transform="translate(730,80)"><g class="img-rows"><rect class="pixel rect_0" stroke="lightgray" x="0" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(247, 187, 159)"></rect><rect class="pixel rect_1" stroke="lightgray" x="20" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(33, 99, 162)"></rect><rect class="pixel rect_2" stroke="lightgray" x="40" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(43, 115, 176)"></rect><rect class="pixel rect_3" stroke="lightgray" x="60" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(33, 99, 162)"></rect><rect class="pixel rect_4" stroke="lightgray" x="80" y="0" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(247, 187, 159)"></rect></g><g class="img-rows"><rect class="pixel rect_5" stroke="lightgray" x="0" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(235, 148, 119)"></rect><rect class="pixel rect_6" stroke="lightgray" x="20" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(33, 99, 162)"></rect><rect class="pixel rect_7" stroke="lightgray" x="40" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(214, 98, 82)"></rect><rect class="pixel rect_8" stroke="lightgray" x="60" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(24, 84, 145)"></rect><rect class="pixel rect_9" stroke="lightgray" x="80" y="20" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(247, 187, 159)"></rect></g><g class="img-rows"><rect class="pixel rect_10" stroke="lightgray" x="0" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(38, 107, 169)"></rect><rect class="pixel rect_11" stroke="lightgray" x="20" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(28, 91, 154)"></rect><rect class="pixel rect_12" stroke="#191970" x="40" y="40" width="19.4" height="19.4" stroke-width="2" fill="rgb(33, 99, 162)"></rect><rect class="pixel rect_13" stroke="lightgray" x="60" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 166, 137)"></rect><rect class="pixel rect_14" stroke="lightgray" x="80" y="40" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(247, 187, 159)"></rect></g><g class="img-rows"><rect class="pixel rect_15" stroke="lightgray" x="0" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(228, 130, 104)"></rect><rect class="pixel rect_16" stroke="lightgray" x="20" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(38, 107, 169)"></rect><rect class="pixel rect_17" stroke="lightgray" x="40" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(214, 98, 82)"></rect><rect class="pixel rect_18" stroke="lightgray" x="60" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(28, 91, 154)"></rect><rect class="pixel rect_19" stroke="lightgray" x="80" y="60" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(242, 166, 137)"></rect></g><g class="img-rows"><rect class="pixel rect_20" stroke="lightgray" x="0" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(43, 115, 176)"></rect><rect class="pixel rect_21" stroke="lightgray" x="20" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(38, 107, 169)"></rect><rect class="pixel rect_22" stroke="lightgray" x="40" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(43, 115, 176)"></rect><rect class="pixel rect_23" stroke="lightgray" x="60" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(38, 107, 169)"></rect><rect class="pixel rect_24" stroke="lightgray" x="80" y="80" width="19.4" height="19.4" stroke-width="0.3" fill="rgb(43, 115, 176)"></rect></g></g><defs><marker id="arrow" viewBox="0,0,20,20" refX="10" refY="10" markerWidth="10" markerHeight="10" orient="auto-start-reverse"><path d="M0,0L0,20L20,10" stroke="black"></path></marker></defs><path d="M410,130L590,130" stroke="black" marker-end="url(#arrow)" fill="none"></path><text text-anchor="middle" dominant-baseline="central" x="500" y="110">Convolve</text><line x1="100" x2="900" y1="560" y2="560" style="stroke: black;"></line></g></svg>
  </div></span></div>
          <div id="observablehq-polynomial_display-05850d43" style="margin-top: 2em;" class="observablehq"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>2</mn></munderover><msub><mi>w</mi><mi>i</mi></msub><msup><mi>L</mi><mi>i</mi></msup><mo>=</mo><mn>1</mn><mi>I</mi><mtext>&nbsp;</mtext><mo>+</mo><mtext>&nbsp;</mtext><mn>0.1</mn><mi>L</mi><mtext>&nbsp;</mtext><mo>+</mo><mtext>&nbsp;</mtext><mn>0</mn><msup><mi>L</mi><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
  p_w(L)
      = \sum_{i = 0}^2 w_i L^i
      = 1I \ + \ 0.1L \ + \ 0L^2.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.02691em;" class="mord mathdefault mtight">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span style="margin-right: 0.07847em;" class="mord mathdefault">I</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mspace">&nbsp;</span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mspace">&nbsp;</span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mspace">&nbsp;</span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mspace">&nbsp;</span></span><span class="base"><span class="strut" style="height: 0.864108em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></div>
          <div id="observablehq-poly_conv_sliders-05850d43" class="observablehq"><div id="poly_conv_sliders"><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">{w_{0}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{w_{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-0.1" max="0.1" step="0.01" value="0.1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.1</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{w_{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-0.01" max="0.01" step="0.001" value="0">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0</output></div></form></div></div>
          <div id="observablehq-viewof-laplacian_type-05850d43" style="text-align: center; margin-top: 2em;" class="observablehq"><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;">Choice of Laplacian</div>
        <label style="display: inline-block; margin: 5px 10px 3px 0; font-size: 0.85em;">
           <input type="radio" name="input" checked="checked" style="vertical-align: top; margin-left: 1px;" value="unnormalized">
           <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Unnormalized&nbsp;</mtext><mi>L</mi></mrow><annotation encoding="application/x-tex">\text{Unnormalized} \ L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">Unnormalized</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">L</span></span></span></span>
          </label><label style="display: inline-block; margin: 5px 10px 3px 0; font-size: 0.85em;">
           <input type="radio" name="input" style="vertical-align: top; " value="normalized">
           <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Normalized&nbsp;</mtext><mover accent="true"><mi>L</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\text{Normalized} \ \tilde{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.92019em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">Normalized</span></span><span class="mspace">&nbsp;</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92019em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">L</span></span></span><span class="" style="top: -3.60233em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">~</span></span></span></span></span></span></span></span></span>
          </label>
      </div></form></div>
          <div id="observablehq-reset_coeffs_button_display-05850d43" style="margin-top: 25px; margin-bottom: 0;" class="observablehq"><span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container">
      <button>Reset Coefficients</button>
    </div></span></div>
          <div id="observablehq-poly_input_slider_watch-05850d43" style="display: none;" class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">poly_input_slider_watch = </span><span class="observablehq--undefined">undefined</span></span></div>
          <div id="observablehq-highlight_selected_cell-05850d43" style="display: none;" class="observablehq"><span class="observablehq--function observablehq--inspect"><span class="observablehq--cellname">highlight_selected_cell = </span><span class="observablehq--keyword">ƒ</span>()</span></div>
          <!-- <p>Credit: <a href="https://observablehq.com/@ameyasd/cleaner-interactive-graph-polynomial-convolutions">Interactive Graph Polynomial Convolutions by Ameya Daigavane</a></p> -->

          <script type="module">
          import {Runtime, Inspector} from "./observablehq-base/runtime.js";
          import define from "./notebooks/cleaner-interactive-graph-polynomial-convolutions.js";
          setTimeout(() => {
            new Runtime().module(define, name => {
              if (name === "grid_buttons_display") return new Inspector(document.querySelector("#observablehq-grid_buttons_display-05850d43"));
              if (name === "poly_color_scale") return new Inspector(document.querySelector("#observablehq-poly_color_scale-05850d43"));
              if (name === "poly_figcaptions") return new Inspector(document.querySelector("#observablehq-poly_figcaptions-05850d43"));
              if (name === "poly_conv_main_div") return new Inspector(document.querySelector("#observablehq-poly_conv_main_div-05850d43"));
              if (name === "viewof laplacian_type") return new Inspector(document.querySelector("#observablehq-viewof-laplacian_type-05850d43"));
              if (name === "polynomial_display") return new Inspector(document.querySelector("#observablehq-polynomial_display-05850d43"));
              if (name === "poly_conv_sliders") return new Inspector(document.querySelector("#observablehq-poly_conv_sliders-05850d43"));
              if (name === "highlight_selected_cell") return new Inspector(document.querySelector("#observablehq-highlight_selected_cell-05850d43"));
              if (name === "reset_coeffs_button_display") return new Inspector(document.querySelector("#observablehq-reset_coeffs_button_display-05850d43"));
              if (name === "poly_input_slider_watch") return new Inspector(document.querySelector("#observablehq-poly_input_slider_watch-05850d43"));
              return ["svg","draw_bottom_line","draw_arrow","draw_original_img","draw_convolutional_kernel","draw_updated_img","draw_static_graph_orig","draw_static_graph_upd","draw_dyn_graph_orig","draw_dyn_graph_upd"].includes(name);
            });
          }, 200);
          </script>
        </div>
        <figure>
          <figcaption>
            <p>
              Hover over a pixel in the input grid (left, representing <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>)
              to highlight it and see the equivalent convolutional kernel
              for that pixel under the arrow.
              The result <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> of the convolution is shown on the right:
              note that different convolutional kernels are applied at different pixels,
              depending on their location.
            </p>
            <p>
              Click on the input grid to toggle pixel values between <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span> (white) and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span></span></span></span></span> (blue).
              To randomize the input grid, press ‘Randomize Grid’. To reset all pixels to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span>, press ‘Reset Grid’.
              Use the sliders at the bottom to change the coefficients <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span></span>.
              To reset all coefficients <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span>, press ‘Reset Coefficients.’
            </p>
          </figcaption>
        </figure>

      <h3 id="chebnet">
        ChebNet
      </h3>
      <span>
        ChebNet <d-cite key="chebnet"></d-cite> refines this idea of polynomial filters by looking at polynomial filters of the form:
      </span>
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>T</mi><mi>i</mi></msub><mo>(</mo><mover accent="true"><mrow><mi>L</mi></mrow><mo>~</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">
          p_w(L) = \sum_{i = 1}^d w_i T_i(\tilde{L})
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8361130000000003em;"></span><span class="strut bottom" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>~</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>
      <span>
        where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> is the degree-<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">i</span></span></span></span></span>
        <a href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">Chebyshev polynomial of the first kind</a> and
        <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>L</mi></mrow><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201899999999998em;"></span><span class="strut bottom" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>~</span></span></span></span></span></span></span></span></span></span></span> is the normalized Laplacian defined using the largest eigenvalue of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>:
        <d-footnote>
          We discuss the eigenvalues of the Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> in more detail in <a href="#spectral">a later section</a>.
        </d-footnote>
      </span>
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>L</mi></mrow><mo>~</mo></mover><mo>=</mo><mfrac><mrow><mn>2</mn><mi>L</mi></mrow><mrow><msub><mi>λ</mi><mi>max</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo></mrow></mfrac><mo>−</mo><msub><mi>I</mi><mi>n</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          \tilde{L} = \frac{2L}{\lambda_{\max}(L)} - I_n.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36033em;"></span><span class="strut bottom" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>~</span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.151392em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.301392em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathit">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span> 
      <p>
        What is the motivation behind these choices?
      </p>
        <ul>
          <li>
            <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> is actually positive semi-definite: all of the eigenvalues of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> are not lesser than <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span>.
            If <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>λ</mi><mi>max</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_{\max}(L) &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.151392em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.301392em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mrel">&gt;</span><span class="mord mathrm">1</span></span></span></span></span>, the entries in the powers of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> rapidly increase in size.
            <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>L</mi></mrow><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201899999999998em;"></span><span class="strut bottom" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>~</span></span></span></span></span></span></span></span></span></span></span> is effectively a scaled-down version of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>, with eigenvalues guaranteed to be in the range <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">[</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">]</span></span></span></span></span>.
            This prevents the entries of powers of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>L</mi></mrow><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201899999999998em;"></span><span class="strut bottom" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>~</span></span></span></span></span></span></span></span></span></span></span> from blowing up.
            Indeed, in the <a href="#polynomial-convolutions">visualization above</a>: we restrict the higher-order coefficients
            when the unnormalized Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> is selected, but allow larger values when the normalized Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>L</mi></mrow><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201899999999998em;"></span><span class="strut bottom" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>~</span></span></span></span></span></span></span></span></span></span></span> is selected,
            in order to show the result <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> on the same color scale.
          </li>
          <li>
            The Chebyshev polynomials have certain interesting properties that make interpolation more numerically stable.
            We won’t talk about this in more depth here,
            but will advise interested readers to take a look at <d-cite key="chebyshev"></d-cite> as a definitive resource.
          </li>
        </ul>
      
      <h3 id="poly-filters-equivariance">
        Polynomial Filters are Node-Order Equivariant
      </h3>
      <p>
        The polynomial filters we considered here are actually independent of the ordering of the nodes.
        This is particularly easy to see when the degree of the polynomial <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">p_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> is <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span></span></span></span></span>:
        where each node’s feature is aggregated with the sum of its neighbour’s features.
        Clearly, this sum does not depend on the order of the neighbours.
        A similar proof follows for higher degree polynomials:
        the entries in the powers of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> are equivariant to the ordering of the nodes.
      </p>
      <div class="math-details shaded-figure">
        <b>Details for the Interested Reader</b>
        <p>
          As above, let’s assume an arbitrary node-order over the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">n</span></span></span></span></span> nodes of our graph.
          Any other node-order can be thought of as a permutation of this original node-order.
          We can represent any permutation by a
          <a href="https://en.wikipedia.org/wiki/Permutation_matrix">permutation matrix</a> <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span></span>.
          <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span></span> will always be an orthogonal <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathrm">0</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span></span> matrix:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><msup><mi>P</mi><mi>T</mi></msup><mo>=</mo><msup><mi>P</mi><mi>T</mi></msup><mi>P</mi><mo>=</mo><msub><mi>I</mi><mi>n</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
            PP^T = P^TP = I_n.
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.0413309999999998em;vertical-align:-0.15em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
          Then, we call an algorithm <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span></span> node-order equivariant iff for all permutations <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span></span>:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>P</mi><mi>x</mi><mo>)</mo><mo>=</mo><mi>P</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
            f(Px) = P f(x).
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord mathrm">.</span></span></span></span></span></span>

          When switching to the new node-order using the permutation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span></span>,
          the quantities below transform in the following way:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>L</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><mi>L</mi><msup><mi>P</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>L</mi><mi>i</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><msup><mi>L</mi><mi>i</mi></msup><msup><mi>P</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
            \begin{aligned}
              x &amp;\to Px \\
              L &amp;\to PLP^T \\
              L^i &amp;\to PL^iP^T
            \end{aligned}
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.5513310000000002em;"></span><span class="strut bottom" style="height:4.6026620000000005em;vertical-align:-2.0513310000000002em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5513310000000002em;"><span style="top:-4.711331em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-1.608669em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0513310000000002em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5513310000000002em;"><span style="top:-4.711331em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">L</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-1.608669em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0513310000000002em;"></span></span></span></span></span></span></span></span></span></span></span>
          and so, for the case of polynomial filters, we can see that:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo>(</mo><mi>P</mi><mi>x</mi><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo>(</mo><mi>P</mi><msup><mi>L</mi><mi>i</mi></msup><msup><mi>P</mi><mi>T</mi></msup><mo>)</mo><mo>(</mo><mi>P</mi><mi>x</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>P</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>d</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msup><mi>L</mi><mi>i</mi></msup><msup><mi>x</mi><mo mathvariant="normal">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>P</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
            \begin{aligned}
              f(Px) &amp; = \sum_{i = 0}^d w_i (PL^iP^T) (Px) \\
                    &amp; = P \sum_{i = 0}^d w_i L^i x’ \\
                    &amp; = P f(x).
            \end{aligned}
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:4.413782em;"></span><span class="strut bottom" style="height:8.327564em;vertical-align:-3.9137820000000003em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.413782em;"><span style="top:-6.413782em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span><span style="top:-0.5823309999999999em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9137820000000003em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.413782em;"><span style="top:-6.413782em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.5823309999999999em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord mathrm">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9137820000000003em;"></span></span></span></span></span></span></span></span></span></span></span> 
          as needed.
        </p>
      </div>

      <h3>
        Embedding Computation
      </h3>
        <p>
          We now describe how we can build a graph neural network
          by stacking ChebNet (or any polynomial filter) layers
          one after the other with non-linearities,
          much like a standard CNN.
          In particular, if we have <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span></span> different polynomial filter layers,
          the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>k</mi><mtext>th</mtext></msup></mrow><annotation encoding="application/x-tex">k^{\text{th}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">th</span></span></span></span></span></span></span></span></span></span></span></span></span></span> of which has its own learnable weights <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>w</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">w^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>,
          we would perform the following computation:
        </p>
        <div id="observablehq-cheb_figure-fa1f970f" role="img" aria-label="Equations defining ChebNet." class="observablehq"><figure id="cheb-conv">
 
  <div style="position:relative; left:0px; top:0px">
  <figcaption style="position:absolute; left:0px; top:0px; width:200px;">
    Start with the original features.
  </figcaption>

  <span style="position:absolute; left:0px; top:20px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\quad {\color{#FE6100}  h^{(0)}} = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.938em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>
  </span>
  </div>
  
  <div style="position:relative; left:0px; top:-45px">
  <figcaption style="position:absolute; left:0px; top:130px">
    Then iterate, for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>:
  </figcaption>
  
  <span style="position:absolute; left:0px; top:160px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"></mspace><msup><mi>p</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>p</mi><mstyle mathcolor="#4D9DB5"><msup><mi>w</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></msub><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"></mspace><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>p</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>×</mo><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"></mspace><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
      \begin{aligned}
        \quad {p^{(k)}} &amp;= p_{\color{#4D9DB5}  w^{(k)}}(L) \\
        \\
        \quad {g^{(k)}} &amp;= p^{(k)} \times {\color{#FE6100}  h^{(k - 1)}} \\
        \\
        \quad {\color{#FE6100}  h^{(k)}} &amp;= \sigma \left({g^{(k)}} \right)
      \end{aligned}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 8.29602em; vertical-align: -3.89801em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.39801em;"><span class="" style="top: -6.61001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.11001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -3.51201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.01201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -0.20201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.89801em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.39801em;"><span class="" style="top: -6.61001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.46938em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.02691em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.230625em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mclose">)</span></span></span><span class="" style="top: -3.51201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.20201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.89801em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  </span>

  <figcaption style="position:absolute; left:300px; top:175px; width: 300px; ">
    Compute the matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">p^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> as the polynomial defined by the filter weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>w</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  w^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.02691em; color: rgb(77, 157, 181);" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> evaluated at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:300px; top:240px; width: 300px; ">
    Multiply <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">p^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h^{(k - 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span>: a standard matrix-vector multiply operation.
  </figcaption>

  <figcaption style="position:absolute; left:300px; top:315px; width: 300px; ">
    Apply a non-linearity <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">{g}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> to get <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  {h}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:380px; top:45px; width:350px;">
    Color Codes:
    <ul class="legend">
        <li><span class="box main"></span> Computed node embeddings. </li>
        <li><span class="box param"></span> Learnable parameters. </li>
    </ul>
  </figcaption>
 
  </div>
</figure></div>
        <div id="observablehq-style-fa1f970f" class="observablehq"><style>
  #spectral-conv div {
    margin: 0 auto 10px auto;
    display: block;
  }
  
  #cheb-conv {
    width: 800px;
    height: 310px;
    display: block;
    margin-top: 0;
    margin-bottom: 0;
    margin-left: auto;
    margin-right: auto;
    position: relative;
  }
  
  
  span.green {
    color: #177245;
  }

  span.blue {
    color: #0047AB;
  }

  /* Legend */
  .legend {
    list-style: none;
    margin-top: 5px;
  }
  .legend li {
    margin-bottom: 5px;
  }
  .legend span.box {
    border: 1px solid #ccc;
    float: left;
    width: 12px;
    height: 12px;
    margin: 2px;
    margin-right: 5px;
  }

  .legend .main { background-color: #FE6100; }
  .legend .param { background-color: #4D9DB5; }

 </style></div>
        <!-- <p>Credit: <a href="https://observablehq.com/@ameyasd/updated-chebnet-equations">(Updated) ChebNet Equations by Ameya Daigavane</a></p> -->
        
        <script type="module">
        import {Runtime, Inspector} from "./observablehq-base/runtime.js";
        import define from "./notebooks/updated-chebnet-equations.js";
        setTimeout(() => {
          new Runtime().module(define, name => {
            if (name === "cheb_figure") return new Inspector(document.querySelector("#observablehq-cheb_figure-fa1f970f"));
            if (name === "style") return new Inspector(document.querySelector("#observablehq-style-fa1f970f"));
          });
        }, 200);
        </script>
        <p>
          Note that these networks
          reuse the same filter weights across different nodes,
          exactly mimicking weight-sharing in Convolutional Neural Networks (CNNs)
          which reuse weights for convolutional filters across a grid.
        </p>

    <h2 id="modern-gnns">
      Modern Graph Neural Networks
    </h2>
      <p>
        ChebNet was a breakthrough in learning localized filters over graphs,
        and it motivated many to think of graph convolutions from a different perspective.
      </p>
      <span>
        We return back to the result of convolving <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> by the polynomial kernel <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>w</mi></msub><mo>(</mo><mi>L</mi><mo>)</mo><mo>=</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">p_w(L) = L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">L</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">L</span></span></span></span></span>,
        focussing on a particular vertex <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span>:
      </span>
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>(</mo><mi>L</mi><mi>x</mi><msub><mo>)</mo><mi>v</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>L</mi><mi>v</mi></msub><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow></msub><msub><mi>L</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow></msub><mo>(</mo><msub><mi>D</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>−</mo><msub><mi>A</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>)</mo><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>D</mi><mi>v</mi></msub><mtext>&nbsp;</mtext><msub><mi>x</mi><mi>v</mi></msub><mo>−</mo><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mi>v</mi><mo>)</mo></mrow></msub><msub><mi>x</mi><mi>u</mi></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
          \begin{aligned}
           (Lx)_v &amp;= L_v x \\ 
                  &amp;= \sum_{u \in G} L_{vu} x_u \\ 
                  &amp;= \sum_{u \in G} (D_{vu} - A_{vu}) x_u \\ 
                  &amp;= D_v \  x_v - \sum_{u \in \mathcal{N}(v)} x_u
          \end{aligned}
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:5.104716000000001em;"></span><span class="strut bottom" style="height:9.709432000000001em;vertical-align:-4.604716000000001em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.104716000000001em;"><span style="top:-7.3147210000000005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit">L</span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-5.604716em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"></span></span><span style="top:-2.9330049999999996em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"></span></span><span style="top:-0.26129399999999947em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.604716000000001em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.104716000000001em;"><span style="top:-7.3147210000000005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathit">x</span></span></span><span style="top:-5.604716em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"></span></span></span></span><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-2.9330049999999996em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-0.26129399999999947em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span></span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.604716000000001em;"></span></span></span></span></span></span></span></span></span></span></span>
      <p> 
        As we noted before, this is a <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span></span></span></span></span>-hop localized convolution.
        But more importantly, we can think of this convolution as arising of two steps:
      </p>
        <ul>
          <li>Aggregating over immediate neighbour features <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">x_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>.</li>
          <li>Combining with the node’s own feature <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>.</li>
        </ul>
      <p class="shaded-figure" style="padding-left: 1em;">
        <b>Key Idea:</b>
        What if we consider different kinds of ‘aggregation’ and ‘combination’ steps,
        beyond what are possible using polynomial filters?
      </p>
      <p>
        By ensuring that the aggregation is node-order equivariant,
        the overall convolution becomes node-order equivariant.
      </p>
      <p>
        These convolutions can be thought of as ‘message-passing’ between adjacent nodes:
        after each step, every node receives some ‘information’ from its neighbours.
      </p>
      <p>
        By iteratively repeating the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span></span></span></span></span>-hop localized convolutions <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span></span> times (i.e., repeatedly ‘passing messages’),
        the receptive field of the convolution effectively includes all nodes upto <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span></span> hops away.
      </p>

      <h3>
        Embedding Computation
      </h3>
        <p>
          Message-passing forms the backbone of many GNN architectures today.
          We describe the most popular ones in depth below:
        </p>
          <ul>
            <li>Graph Convolutional Networks (GCN)<d-cite key="semi-supervised-gcn"></d-cite></li>
            <li>Graph Attention Networks (GAT)<d-cite key="gat"></d-cite></li>
            <li>Graph Sample and Aggregate (GraphSAGE)<d-cite key="graphsage"></d-cite></li>
            <li>Graph Isomorphism Network (GIN)<d-cite key="gin"></d-cite></li>
          </ul>
        
        <div class="shaded-figure l-screen" id="modern-gnns-equations" style="grid-column: page; padding-left: 2em; padding-right: 2em; padding-top: 0em;" role="img" aria-label="Equations defining the embedding computations for GCN, GAT, GraphSAGE and GIN models.">

          <div class="interactive-gnn-equations-fig_div" role="img"><div class="observablehq"><figure id="gnn-models" data-show="gcn" style="height: 510px;">
  <ul class="list"><li class="selected">GCN</li><li>GAT</li><li>GraphSAGE</li><li>GIN</li></ul>
  <div style="position:relative; left:30px; top:0px" class="gnn-model-gcn">

  <span style="position:absolute; left:0px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>
    
  <span style="position:absolute; left:150px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 
  </span>
  
  <figcaption style="position:absolute; left:0px; top:60px; width:60px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s initial embedding.
  </figcaption>
  
  <figcaption style="position:absolute; left:150px; top:60px; width:120px;">
    ... is just node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s original features.
  </figcaption>

  <figcaption style="position:absolute; left:200px; top:20px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:130px">
    and for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>:
  </figcaption>

  <span style="position:absolute; left:0px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>

  <span style="position:absolute; left:110px; top:152px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>⋅</mo><mfrac><mrow><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>u</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow></mfrac><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>⋅</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\color{#4D9DB5}
  f^{(k)}}\left({\color{#4D9DB5}  W^{(k)}} \cdot \frac{\sum\limits_{u 
\in \mathcal{N}(v)} {\color{#A95AA1}  h_u^{(k - 1)}}}{|\mathcal{N}(v)|} +
 {\color{#4D9DB5}  B^{(k)}} \cdot {\color{#FE6100}  h_v^{(k - 
1)}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.80084em; vertical-align: -2.15003em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65003em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎝</span></span></span><span class="" style="top: -2.8em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -3.39501em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -3.41001em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -4.65003em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65081em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mclose">)</span><span class="mord">∣</span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -4.65081em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.750005em;"><span class="" style="top: -2.059em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.00001em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.21601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span style="margin-right: 0.03148em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(169, 90, 161);">−</span><span class="mord mtight" style="color: rgb(169, 90, 161);">1</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65003em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎠</span></span></span><span class="" style="top: -2.8em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -3.39501em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -3.41001em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -4.65003em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> 
  </span>

  <figcaption style="position:absolute; left:0px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:240px; top:275px; width:100px;">
    Mean of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s neighbour's embeddings at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:410px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:520px; top:210px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:370px">
    Color Codes:
    <ul class="legend">
        <li><span class="box main"></span> Embedding of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box neigh"></span> Embedding of a neighbour of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box param"></span> (Potentially) Learnable parameters. </li>
    </ul>
  </figcaption>
</div>
  <div style="position:relative; left:30px; top:0px" class="gnn-model-gat">

  <span style="position:absolute; left:0px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>
    
  <span style="position:absolute; left:150px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 
  </span>
  
  <figcaption style="position:absolute; left:0px; top:60px; width:60px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s initial embedding.
  </figcaption>
  
  <figcaption style="position:absolute; left:150px; top:60px; width:120px;">
    ... is just node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s original features.
  </figcaption>

  <figcaption style="position:absolute; left:200px; top:20px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:130px">
    and for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>:
  </figcaption>

  <span style="position:absolute; left:0px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>

  <span style="position:absolute; left:110px; top:165px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>⋅</mo><mrow><mo fence="true">[</mo><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder><msubsup><mi>α</mi><mrow><mi>v</mi><mi>u</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>u</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><msubsup><mi>α</mi><mrow><mi>v</mi><mi>v</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">]</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\color{#4D9DB5}
   f^{(k)}}\left({\color{#4D9DB5}   W^{(k)}} \cdot \left[\sum\limits_{u 
\in \mathcal{N}(v)} \alpha_{vu}^{(k - 1)} {\color{#A95AA1}  h_u^{(k - 
1)}} + \alpha_{vv}^{(k - 1)} {\color{#FE6100}  h_v^{(k - 
1)}}\right]\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.60103em; vertical-align: -1.55002em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎝</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05101em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.80999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.05101em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.809em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mord mathdefault mtight">u</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span style="margin-right: 0.03148em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(169, 90, 161);">−</span><span class="mord mtight" style="color: rgb(169, 90, 161);">1</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05101em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.80999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.05101em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎠</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> 
  </span>

  <figcaption style="position:absolute; left:0px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:280px; top:275px; width:120px;">
    Weighted mean of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s neighbour's embeddings at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:465px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:590px; top:210px; width:90px;">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:380px">
    where the attention weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\alpha^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> are generated by an attention mechanism <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">{\color{#4D9DB5}  A^{(k)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span></span>, normalized such that the sum over all neighbours of each node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span> is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>:
  </figcaption>

  <span style="position:absolute; left:0px; top:450px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mrow><mi>v</mi><mi>u</mi></mrow><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\alpha_{vu}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mord mathdefault mtight">u</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:450px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>

  <span style="position:absolute; left:130px; top:435px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo stretchy="false">(</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo separator="true">,</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>u</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow><mi>w</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder><mstyle mathcolor="#4D9DB5"><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo stretchy="false">(</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo separator="true">,</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>w</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{{\color{#4D9DB5}
  A^{(k)}}({\color{#FE6100}  h_v^{(k)}}, {\color{#A95AA1}  
h_u^{(k)}})}{\sum\limits_{w \in \mathcal{N}(v)}{\color{#4D9DB5}  
A^{(k)}}({\color{#FE6100}  h_v^{(k)}}, {\color{#A95AA1}  h_w^{(k)}})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.87261em; vertical-align: -2.15081em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.7218em;"><span class="" style="top: -2.11em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.750005em;"><span class="" style="top: -2.059em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.02691em;" class="mord mathdefault mtight">w</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.00001em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.21601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.02691em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">w</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span style="margin-right: 0.03148em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.7218em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span style="margin-right: 0.03148em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15081em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
  </span>

  <figcaption style="position:absolute; left:390px; top:470px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">(v, u) \in E.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.05764em;" class="mord mathdefault">E</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:570px">
    Color Codes:
    <ul class="legend">
        <li><span class="box main"></span> Embedding of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box neigh"></span> Embedding of a neighbour of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box param"></span> (Potentially) Learnable parameters. </li>
    </ul>
  </figcaption>
  </div>
  <div style="position:relative; left:30px; top:0px" class="gnn-model-gin">

  <span style="position:absolute; left:0px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>
    
  <span style="position:absolute; left:150px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 
  </span>
  
  <figcaption style="position:absolute; left:0px; top:60px; width:60px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s initial embedding.
  </figcaption>
  
  <figcaption style="position:absolute; left:150px; top:60px; width:120px;">
    ... is just node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s original features.
  </figcaption>

  <figcaption style="position:absolute; left:200px; top:20px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:130px">
    and for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>:
  </figcaption>

  <span style="position:absolute; left:0px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>

  <span style="position:absolute; left:110px; top:165px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>u</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>ϵ</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo stretchy="false">)</mo><mo>⋅</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\color{#4D9DB5}
  f^{(k)}}\left(\sum\limits_{u \in \mathcal{N}(v)} {\color{#A95AA1}  
h_u^{(k - 1)}} + (1 + {\color{#4D9DB5}  \epsilon^{(k)}}) \cdot 
{\color{#FE6100}  h_v^{(k - 1)}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.60004em; vertical-align: -1.55002em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎝</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.809em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span style="margin-right: 0.03148em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(169, 90, 161);">−</span><span class="mord mtight" style="color: rgb(169, 90, 161);">1</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">ϵ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎠</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> 
  </span>

  <figcaption style="position:absolute; left:0px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:200px; top:275px; width:100px;">
    Sum of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s neighbour's embeddings at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:390px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:520px; top:210px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>

  <figcaption style="position:absolute; left:0px; top:370px">
    Color Codes:
    <ul class="legend">
        <li><span class="box main"></span> Embedding of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box neigh"></span> Embedding of a neighbour of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box param"></span> (Potentially) Learnable parameters. </li>
    </ul>
  </figcaption>

  </div>
  <div style="position:relative; left:30px; top:0px" class="gnn-model-graphsage">

    <span style="position:absolute; left:0px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>
    
  <span style="position:absolute; left:150px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 
  </span>
  
  <figcaption style="position:absolute; left:0px; top:60px; width:60px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s initial embedding.
  </figcaption>
  
  <figcaption style="position:absolute; left:150px; top:60px; width:120px;">
    ... is just node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s original features.
  </figcaption>

  <figcaption style="position:absolute; left:200px; top:20px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>
  
  <figcaption style="position:absolute; left:0px; top:130px">
    and for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>:
  </figcaption>

  <span style="position:absolute; left:0px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h_v^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.185em; vertical-align: -0.247em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span>
  </span>

  <span style="position:absolute; left:75px; top:190px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span>
  </span>

  <span style="position:absolute; left:110px; top:177px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>⋅</mo><mrow><mo fence="true">[</mo><mi><munder><mo><mstyle mathcolor="#4D9DB5"><mtext>AGG</mtext></mstyle></mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder></mi><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>u</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>&nbsp;</mtext><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">]</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\color{#4D9DB5}
  f^{(k)}}\left({\color{#4D9DB5}  W^{(k)}} \cdot \left[\underset{{u \in 
\mathcal{N}(v)}}{\color{#4D9DB5}  \text{AGG}}(\{ {\color{#A95AA1}  
h_u^{(k - 1)}} \}), \ {\color{#FE6100}  h_v^{(k - 1)}}\right]\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.416em; vertical-align: -0.966em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.309em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop"><span class="mord text" style="color: rgb(77, 157, 181);"><span class="mord" style="color: rgb(77, 157, 181);">AGG</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.966em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mopen">{</span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span style="margin-right: 0.03148em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(169, 90, 161);">−</span><span class="mord mtight" style="color: rgb(169, 90, 161);">1</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mclose">}</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span> 
  </span>

  <figcaption style="position:absolute; left:0px; top:275px; width:90px;">
    Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:230px; top:275px; width:100px;">
    Aggregation of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s neighbour's embeddings at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span> ...
  </figcaption>
  
  <figcaption style="position:absolute; left:300px; top:355px; width:100px;">
      ... concatenated with ...
  </figcaption>

  <figcaption style="position:absolute; left:380px; top:275px; width:90px;">
    ... Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>'s embedding at step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:520px; top:210px">
    for all <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">v \in V.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span><span class="mord">.</span></span></span></span>
  </figcaption>

  <figcaption style="position:absolute; left:0px; top:400px">
    Color Codes:
    <ul class="legend">
        <li><span class="box main"></span> Embedding of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box neigh"></span> Embedding of a neighbour of node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span></span>.</li>
        <li><span class="box param"></span> (Potentially) Learnable parameters. </li>
    </ul>
  </figcaption>
</div>
</figure></div></div>
          <div class="interactive-gnn-equations-text_div"><div class="observablehq"><span><p>Predictions can be made at each node by using the final computed embedding:
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mi>v</mi></msub><mo>^</mo></mover><mo>=</mo><mtext>PREDICT</mtext><mo stretchy="false">(</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>v</mi><mrow><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\hat{y_v} = \text{PREDICT}({\color{#FE6100} h_v^{(K)}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.188em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">PREDICT</span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.07153em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">K</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>PREDICT</mtext></mrow><annotation encoding="application/x-tex">\text{PREDICT}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">PREDICT</span></span></span></span></span> is generally another neural network, learnt together with the GCN model.</p>
  <div><p>For each step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span>, the function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  f^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span>, matrices <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  W^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  B^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> are shared across all nodes.</p>
<p>This allows the GCN model to scale well, because the number of parameters in the model is not tied to the size of the graph.</p>
<p>The variant we discuss here is the 2-parameter model from the original paper <d-cite key="semi-supervised-gcn"></d-cite>,
which is more expressive. We also consider the following normalization (iteration subscripts omitted):
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><mi>f</mi></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mi>W</mi></mstyle><mo>⋅</mo><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder><mfrac><mstyle mathcolor="#A95AA1"><msub><mi>h</mi><mi>u</mi></msub></mstyle><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow></mfrac><mo>+</mo><mstyle mathcolor="#4D9DB5"><mi>B</mi></mstyle><mo>⋅</mo><mstyle mathcolor="#FE6100"><msub><mi>h</mi><mi>v</mi></msub></mstyle><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
{\color{#4D9DB5}  f}\left({\color{#4D9DB5}  W} \cdot \sum_{u \in 
\mathcal{N}(v)} \frac{\color{#A95AA1}  h_u}{|\mathcal{N}(v)|} + 
{\color{#4D9DB5}  B} \cdot {\color{#FE6100}  h_v} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.60004em; vertical-align: -1.55002em;"></span><span class="mord"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎝</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.809em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mclose">)</span><span class="mord">∣</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎠</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>instead of the normalization defined in the original paper: <d-cite key="semi-supervised-gcn"></d-cite>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><mi>f</mi></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mi>W</mi></mstyle><mo>⋅</mo><munder><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></munder><mfrac><mstyle mathcolor="#A95AA1"><msub><mi>h</mi><mi>u</mi></msub></mstyle><msqrt><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow></msqrt></mfrac><mo>+</mo><mstyle mathcolor="#4D9DB5"><mi>B</mi></mstyle><mo>⋅</mo><mstyle mathcolor="#FE6100"><msub><mi>h</mi><mi>v</mi></msub></mstyle><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
{\color{#4D9DB5}  f}\left({\color{#4D9DB5}  W} \cdot \sum_{u \in 
\mathcal{N}(v)} \frac{\color{#A95AA1}  
h_u}{\sqrt{|\mathcal{N}(u)||\mathcal{N}(v)|}} + {\color{#4D9DB5}  B} 
\cdot {\color{#FE6100}  h_v} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.60004em; vertical-align: -1.55002em;"></span><span class="mord"><span style="margin-right: 0.10764em; color: rgb(77, 157, 181);" class="mord mathdefault">f</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎝</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎜</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.809em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span style="margin-right: 0.14736em;" class="mord mathcal mtight">N</span></span><span class="mopen mtight">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.175em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.935em;"><span class="svg-align" style="top: -3.2em;"><span class="pstrut" style="height: 3.2em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.14736em;" class="mord mathcal">N</span></span><span class="mopen">(</span><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span><span class="mclose">)</span><span class="mord">∣</span></span></span><span class="" style="top: -2.895em;"><span class="pstrut" style="height: 3.2em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.28em;"><svg width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.305em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mathdefault mtight" style="color: rgb(169, 90, 161);">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.13em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span style="margin-right: 0.03588em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05002em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎠</span></span></span><span class="" style="top: -2.81em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎟</span></span></span><span class="" style="top: -4.05002em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55002em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
              for ease of exposition.</p></div></span></div></div>
          <div class="interactive-gnn-equations-interactive_list" style="display: none;"><div class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">interactive_list = </span><span class="observablehq--undefined">undefined</span></span></div></div>
          <div class="interactive-gnn-equations-style"><div class="observablehq"><style>
  #gnn-models ul.list {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    grid-column-gap: 4px;
    text-align: center;
    padding: 0;
    list-style: none;
  }

  #gnn-models ul.list li {
    margin: 0;
    background: #f3f3f3;
    border-bottom: 3px solid #e3e3e3;
    cursor: pointer;
    line-height: 2em;
    border-top-left-radius: 3px;
    border-top-right-radius: 3px;
  }

  #gnn-models ul.list li:hover {
    border-bottom-color: #D9D9D9;
  }

  #gnn-models ul.list li.selected {
    background: #D9D9D9;
    border-bottom-color: #D9D9D9;
  }

  #gnn-models div {
    margin: 0 auto 10px auto;
    display: none;
  }
   
  #gnn-models {
    display: block;
    margin-left: auto;
    margin-right: auto;
    position: relative;
  }
  
  #gnn-models[data-show='gcn'] .gnn-model-gcn,
  #gnn-models[data-show='gin'] .gnn-model-gin,
  #gnn-models[data-show='graphsage'] .gnn-model-graphsage,
  #gnn-models[data-show='gat'] .gnn-model-gat {
    display: block;
  }
  
  /* Legend */
  .legend {
    list-style: none;
    margin-top: 5px;
  }
  .legend li {
    margin-bottom: 0;
  }
  .legend span.box {
    border: 1px solid #ccc;
    float: left;
    width: 12px;
    height: 12px;
    margin: 2px;
    margin-right: 5px;
  }
  .legend .main { background-color: #FE6100; }
  .legend .neigh { background-color: #A95AA1; }
  .legend .param { background-color: #4D9DB5; }
</style></div></div>
    
          <script type="module">
          import {Runtime, Inspector} from "./observablehq-base/runtime.js";     
          import define from "./notebooks/interactive-gnn-equations.js";
          setTimeout(() => {
            new Runtime().module(define, name => {
              if (name === "fig_div") return Inspector.into(".interactive-gnn-equations-fig_div")();
              if (name === "text_div") return Inspector.into(".interactive-gnn-equations-text_div")();
              if (name === "interactive_list") return Inspector.into(".interactive-gnn-equations-interactive_list")();
              if (name === "style") return Inspector.into(".interactive-gnn-equations-style")();
            });
          }, 200);
          </script>
        </div>
  
    <h3>
     Thoughts
    </h3>
      <p>
        An interesting point is to assess different aggregation functions: are some better and others worse?
        <d-cite key="gin"></d-cite> demonstrates that aggregation functions indeed can be compared on how well
        they can uniquely preserve node neighbourhood features;
        we recommend the interested reader take a look at the detailed theoretical analysis there.
      </p>
      <p>
        Here, we’ve talk about GNNs where the computation only occurs at the nodes.
        More recent GNN models
        such as Message-Passing Neural Networks <d-cite key="neural-message-passing"></d-cite>
        and Graph Networks <d-cite key="graphnets"></d-cite>
        perform computation over the edges as well;
        they compute edge embeddings together with node embeddings.
        This is an even more general framework -
        but the same ‘message passing’ ideas from this section apply.
      </p>

    <h2 id="interactive">
      Interactive Graph Neural Networks
    </h2>
      <p>
        Below is an interactive visualization of these GNN models on small graphs.
        For clarity, the node features are just real numbers here, shown inside the squares next to each node,
        but the same equations hold when the node features are vectors.
      </p>

      <div class="shaded-figure l-screen" style="grid-column: page;" role="img" aria-label="An interactive visualization of different GNN models with update equations displayed at the selected node.">
        <div class="interactive-gnn-visualizations-viz_list" style="padding-left: 2em; padding-right: 2em"><div class="observablehq"><div id="gnn-models-viz">
<ul class="none"><li class="selected">GCN</li><li>GAT</li><li>GraphSAGE</li><li>GIN</li></ul>
</div></div></div>
        <div class="interactive-gnn-visualizations-buttons"><div class="observablehq"><span><div class="gcn model">
    <span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container" style="">
      <button>Reset</button>
      <button disabled="disabled">Undo Last Update</button>
      <button>Update All Nodes</button>
      <button id="randomize">Randomize Graph</button>
    </div></span>
  </div>

  <div class="gat model" style="display: none;">
    <span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container" style="display: none;">
      <button>Reset</button>
      <button disabled="disabled">Undo Last Update</button>
      <button>Update All Nodes</button>
      <button id="randomize">Randomize Graph</button>
    </div></span>
  </div>

  <div class="graphsage model" style="display: none;">
    <span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container" style="display: none;">
      <button>Reset</button>
      <button disabled="disabled">Undo Last Update</button>
      <button>Update All Nodes</button>
      <button id="randomize">Randomize Graph</button>
    </div></span>
  </div>

  <div class="gin model" style="display: none;">
    <span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container" style="display: none;">
      <button>Reset</button>
      <button disabled="disabled">Undo Last Update</button>
      <button>Update All Nodes</button>
      <button id="randomize">Randomize Graph</button>
    </div></span>
  </div></span></div></div>
        <div class="interactive-gnn-visualizations-fig"><div class="observablehq"><span><div class="gcn model">
    <span><style>
    #main-div {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
    }
    
    #labels-div form {
      margin-top: 2%;
      margin-bottom: 2%;
    }

    #labels-div {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 65%;
    }
    
    #iteration {
      font-weight: bold;
      margin-bottom: 20%;
    }

    #sliders {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Nicer sliders. */
    input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
    }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
  </style>
  <div id="main-div" style="">
    <div id="labels-div" style="">
      <div id="iteration" style="">
        Initial Graph
      </div>
      <div id="params" class="no-override" style="">
        Parameters for Next Update
      </div>
      <form><div style=""><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
      <form><div style=""><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">B^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
    </div>
    <svg id="graph-svg" viewBox="483.6666666666667,0,483.6666666666667,500" width="1451" height="500"><g class="edges" stroke="gray"><line x1="625.7343122177549" y1="359.6123388045608" x2="615.0028374471307" y2="221.251935617894"></line><line x1="813.9921467222787" y1="212.09800668304877" x2="772.758928064796" y2="89.18174218794289"></line><line x1="800.0100511086977" y1="367.8546766504649" x2="615.0028374471307" y2="221.251935617894"></line><line x1="615.0028374471307" y1="221.251935617894" x2="813.9921467222787" y2="212.09800668304877"></line></g><g class="nodes"><g class="node" transform="translate(813.9921467222787,212.09800668304877)"><circle class="visible" r="7" fill="rgb(254, 97, 0)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">A</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">6</text></g></g><g class="node" transform="translate(625.7343122177549,359.6123388045608)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">B</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">2</text></g></g><g class="node" transform="translate(772.758928064796,89.18174218794289)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">C</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="45" height="45"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="22.5" dy="22.5">-10</text></g></g><g class="node" transform="translate(800.0100511086977,367.8546766504649)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">D</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">1</text></g></g><g class="node" transform="translate(615.0028374471307,221.251935617894)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">E</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">3</text></g></g></g></svg>
  </div></span>
  </div>

  <div class="gat model" style="display: none;">
    <span><style>
    #main-div {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
    }

    #labels-div {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 65%;
    }
    
    #iteration {
      font-weight: bold;
      margin-bottom: 20%;
    }

    #labels-div form {
      margin-top: 2%;
      margin-bottom: 2%;
    }

    /* Nicer sliders. */
    input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
    }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
  </style>
  <div id="main-div" style="display: none;">
    <div id="labels-div" style="display: none;">
      <div id="iteration" style="display: none;">
        Initial Graph
      </div>
      <div id="params" class="no-override" style="display: none;">
        Parameters for Next Update
      </div>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>A</mi><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">A_W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">W</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.01" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
    </div>
    <svg id="graph-svg" viewBox="483.6666666666667,0,483.6666666666667,500" width="1451" height="500"><g class="edges" stroke="gray"><line x1="625.7343122177549" y1="359.6123388045608" x2="615.0028374471307" y2="221.251935617894"></line><line x1="813.9921467222787" y1="212.09800668304877" x2="772.758928064796" y2="89.18174218794289"></line><line x1="800.0100511086977" y1="367.8546766504649" x2="615.0028374471307" y2="221.251935617894"></line><line x1="615.0028374471307" y1="221.251935617894" x2="813.9921467222787" y2="212.09800668304877"></line></g><g class="nodes"><g class="node" transform="translate(813.9921467222787,212.09800668304877)"><circle class="visible" r="7" fill="rgb(254, 97, 0)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">A</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">6</text></g></g><g class="node" transform="translate(625.7343122177549,359.6123388045608)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">B</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">2</text></g></g><g class="node" transform="translate(772.758928064796,89.18174218794289)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">C</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="45" height="45"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="22.5" dy="22.5">-10</text></g></g><g class="node" transform="translate(800.0100511086977,367.8546766504649)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">D</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">1</text></g></g><g class="node" transform="translate(615.0028374471307,221.251935617894)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">E</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">3</text></g></g></g></svg>
  </div></span>
  </div>

  <div class="graphsage model" style="display: none;">
    <span><style>
    #main-div {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
    }
    
    #labels-div form {
      margin-top: 2%;
      margin-bottom: 2%;
    }

    #labels-div {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 65%;
    }
    
    #iteration {
      font-weight: bold;
      margin-bottom: 20%;
    }

    #sliders {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Nicer sliders. */
    input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
    }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
  </style>
  <div id="main-div" style="display: none;">
    <div id="labels-div" style="display: none;">
      <div id="iteration" style="display: none;">
        Initial Graph
      </div>
      <div id="params" class="no-override" style="display: none;">
        Parameters for Next Update
      </div>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">B^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span style="margin-right: 0.05017em;" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>U</mi><mi>s</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">U_s^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.16139em; vertical-align: -0.116592em;"></span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>U</mi><mi>h</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">U_h^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="1">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">1</output></div></form>
  </div>
    <svg id="graph-svg" viewBox="483.6666666666667,0,483.6666666666667,500" width="1451" height="500"><g class="edges" stroke="gray"><line x1="625.7343122177549" y1="359.6123388045608" x2="615.0028374471307" y2="221.251935617894"></line><line x1="813.9921467222787" y1="212.09800668304877" x2="772.758928064796" y2="89.18174218794289"></line><line x1="800.0100511086977" y1="367.8546766504649" x2="615.0028374471307" y2="221.251935617894"></line><line x1="615.0028374471307" y1="221.251935617894" x2="813.9921467222787" y2="212.09800668304877"></line></g><g class="nodes"><g class="node" transform="translate(813.9921467222787,212.09800668304877)"><circle class="visible" r="7" fill="rgb(254, 97, 0)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">A</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">6</text></g></g><g class="node" transform="translate(625.7343122177549,359.6123388045608)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">B</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">2</text></g></g><g class="node" transform="translate(772.758928064796,89.18174218794289)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">C</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="45" height="45"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="22.5" dy="22.5">-10</text></g></g><g class="node" transform="translate(800.0100511086977,367.8546766504649)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">D</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">1</text></g></g><g class="node" transform="translate(615.0028374471307,221.251935617894)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">E</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">3</text></g></g></g></svg>
  </div></span>
  </div>

  <div class="gin model" style="display: none;">
    <span><style>
    #main-div {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
    }
    
    #labels-div form {
      margin-top: 2%;
      margin-bottom: 2%;
    }

    #labels-div {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 65%;
    }
    
    #iteration {
      font-weight: bold;
      margin-bottom: 20%;
    }

    #sliders {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Nicer sliders. */
    input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
    }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
  </style>
  <div id="main-div" style="display: none;">
    <div id="labels-div" style="display: none;">
      <div id="iteration" style="display: none;">
        Initial Graph
      </div>
      <div id="params" class="no-override" style="display: none;">
        Parameters for Next Update
      </div>
      <form><div style="display: none;"><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px; display: none;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ϵ</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">{\epsilon}^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ϵ</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-10" max="10" step="0.1" value="0">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0</output></div></form>
    </div>
    <svg id="graph-svg" viewBox="483.6666666666667,0,483.6666666666667,500" width="1451" height="500"><g class="edges" stroke="gray"><line x1="625.7343122177549" y1="359.6123388045608" x2="615.0028374471307" y2="221.251935617894"></line><line x1="813.9921467222787" y1="212.09800668304877" x2="772.758928064796" y2="89.18174218794289"></line><line x1="800.0100511086977" y1="367.8546766504649" x2="615.0028374471307" y2="221.251935617894"></line><line x1="615.0028374471307" y1="221.251935617894" x2="813.9921467222787" y2="212.09800668304877"></line></g><g class="nodes"><g class="node" transform="translate(813.9921467222787,212.09800668304877)"><circle class="visible" r="7" fill="rgb(254, 97, 0)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">A</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">6</text></g></g><g class="node" transform="translate(625.7343122177549,359.6123388045608)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">B</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">2</text></g></g><g class="node" transform="translate(772.758928064796,89.18174218794289)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">C</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="45" height="45"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="22.5" dy="22.5">-10</text></g></g><g class="node" transform="translate(800.0100511086977,367.8546766504649)"><circle class="visible" r="5" fill="rgb(128, 128, 128)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">D</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">1</text></g></g><g class="node" transform="translate(615.0028374471307,221.251935617894)"><circle class="visible" r="5" fill="rgb(169, 90, 161)"></circle><circle class="invisible" r="25" fill="transparent"></circle><text font-style="italic" x="10" y="3">E</text><g class="node_vector"><rect fill="#f5f2eb" stroke="gray" x="5" y="10" width="35" height="35"></rect><text text-anchor="middle" dominant-baseline="central" x="5" y="10" dx="17.5" dy="17.5">3</text></g></g></g></svg>
  </div></span>
  </div></span></div></div>
        <div class="interactive-gnn-visualizations-eqn"><div class="observablehq"><span><div class="gcn model eqn">
    <div style=""><p>  <strong>Next Update (Iteration 1):</strong><br>    Equation for Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span>:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mfrac><mrow><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><mn>2</mn></mfrac><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mfrac><mrow><mstyle mathcolor="#A95AA1"><mo>−</mo><mn>10</mn></mstyle><mo>+</mo><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle></mrow><mn>2</mn></mfrac><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mo>−</mo><mn>3.5</mn><mo>+</mo><mn>6</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mn>2.5</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mn>2.5</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>2.5.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{aligned}
    {\color{#FE6100} h_{A}^{(1)}}
              &amp;= {f} \left(
                  {\color{#4D9DB5}  W^{(1)}} \times \frac{{\color{#A95AA1} h_{C}^{(0)}} + {\color{#A95AA1} h_{E}^{(0)}}}{2} + 
                  {\color{#4D9DB5}  B^{(1)}} \times {\color{#FE6100} h_{A}^{(0)}} \right) \\ 
              &amp;= f \left(
                  {\color{#4D9DB5}  1} \times \frac{{\color{#A95AA1} -10} + {\color{#A95AA1} 3}}{2} + 
                  {\color{#4D9DB5}  1} \times {\color{#FE6100} 6} \right) \\
              &amp;= f \left(
                  -3.5 + 
                  6 \right) \\
              &amp;= f \left(2.5 \right) \\
              &amp;= \text{ReLU} \left(2.5\right)
              = 2.5.
    \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.5001em; vertical-align: -5.00003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.50003em;"><span class="" style="top: -7.50003em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.5em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"></span></span><span class="" style="top: -2.40997em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"></span></span><span class="" style="top: -0.90997em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"></span></span><span class="" style="top: 0.59003em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.00003em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.50003em;"><span class="" style="top: -7.50003em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.72833em;"><span class="" style="top: -2.3588em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.2748em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.72833em;"><span class="pstrut" style="height: 3.0448em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size4">)</span></span></span></span></span><span class="" style="top: -4.5em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">−</span><span class="mord" style="color: rgb(169, 90, 161);">1</span><span class="mord" style="color: rgb(169, 90, 161);">0</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">)</span></span></span></span></span><span class="" style="top: -2.40997em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">−</span><span class="mord">3</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">6</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -0.90997em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: 0.59003em;"><span class="pstrut" style="height: 3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.00003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>  Here, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span></span></span> is just <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ReLU</mtext></mrow><annotation encoding="application/x-tex">\text{ReLU}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">ReLU</span></span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x) = \max(x, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.  </p>
<p>  Note that the weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  B^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> are shared across all nodes!</p></div>
  </div>

  <div class="gat model eqn" style="display: none;">
    <div style="display: none;"><p>  <strong>Next Update (Iteration 1):</strong><br>    Equation for Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span>:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mrow><mo fence="true">(</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo>×</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub><mo>×</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>×</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mrow><mo fence="true">(</mo><mn>0</mn><mo>×</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mn>0.05</mn><mo>×</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mn>0.95</mn><mo>×</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mo fence="false">(</mo><mn>0</mn><mo>×</mo><mstyle mathcolor="#A95AA1"><mo>−</mo><mn>10</mn></mstyle><mo>+</mo><mn>0.05</mn><mo>×</mo><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle><mo>+</mo><mn>0.95</mn><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo fence="false">)</mo><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mo fence="false">(</mo><mn>0</mn><mo>+</mo><mn>0.14</mn><mo>+</mo><mn>5.72</mn><mo fence="false">)</mo><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mrow><mo fence="true">(</mo><mn>5.86</mn><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mn>5.86</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mn>5.86</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>5.86.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{aligned}
    {\color{#FE6100} h_{A}^{(1)}}
              &amp;= f \left({\color{#4D9DB5}  W^{(1)}} \times 
\left(\alpha_{AC} \times {\color{#A95AA1} h_{C}^{(0)}} + \alpha_{AE} 
\times {\color{#A95AA1} h_{E}^{(0)}} + \alpha_{AA} \times 
{\color{#FE6100} h_{A}^{(0)}} \right) \right) \\ 
              &amp;= f \left({\color{#4D9DB5}  W^{(1)}} \times \left(0 
\times {\color{#A95AA1} h_{C}^{(0)}} + 0.05 \times {\color{#A95AA1} 
h_{E}^{(0)}} + 0.95 \times {\color{#FE6100} h_{A}^{(0)}} \right) \right)
 \\
              &amp;= f \left({\color{#4D9DB5}  W^{(1)}} \times \big(0 
\times {\color{#A95AA1} -10} + 0.05 \times {\color{#A95AA1} 3} + 0.95 
\times {\color{#FE6100} 6}\big) \right) \\
              &amp;= f \left({\color{#4D9DB5}  W^{(1)}} \times \big(0 + 
0.14 + 5.72 \big) \right) \\
              &amp;= f \left({\color{#4D9DB5}  1} \times \left(5.86 
\right) \right) \\
              &amp;= f \left(5.86\right) \\
              &amp;= \text{ReLU} \left(5.86\right) 
              = 5.86.
    \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.9001em; vertical-align: -6.20004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.70004em;"><span class="" style="top: -8.70004em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -6.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -4.5em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -2.39998em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -0.60996em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: 0.89004em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: 2.39004em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.20004em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.70004em;"><span class="" style="top: -8.70004em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -6.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -4.5em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">−</span><span class="mord" style="color: rgb(169, 90, 161);">1</span><span class="mord" style="color: rgb(169, 90, 161);">0</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">3</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -2.39998em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">5</span><span class="mord">.</span><span class="mord">7</span><span class="mord">2</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -0.60996em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">5</span><span class="mord">.</span><span class="mord">8</span><span class="mord">6</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: 0.89004em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">5</span><span class="mord">.</span><span class="mord">8</span><span class="mord">6</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: 2.39004em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">5</span><span class="mord">.</span><span class="mord">8</span><span class="mord">6</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">5</span><span class="mord">.</span><span class="mord">8</span><span class="mord">6</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.20004em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  with attention weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span> computed as:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>α</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≈</mo><mn>0.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>α</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≈</mo><mn>0.05.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>α</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><mi>exp</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≈</mo><mn>0.95.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{aligned}
      \alpha_{AC} = \frac{\exp{(e_{AC})}}{\exp{(e_{AC})} + 
\exp{(e_{AE})} + \exp{(e_{AA})}} &amp;\approx 0. \\ \alpha_{AE} = 
\frac{\exp{(e_{AE})}}{\exp{(e_{AC})} + \exp{(e_{AE})} + \exp{(e_{AA})}} 
&amp;\approx 0.05. \\ \alpha_{AA} = \frac{\exp{(e_{AA})}}{\exp{(e_{AC})}
 + \exp{(e_{AE})} + \exp{(e_{AA})}} &amp;\approx 0.95.
    \end{aligned}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.989em; vertical-align: -3.7445em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.2445em;"><span class="" style="top: -6.2445em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.5815em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -0.9185em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.0037em;" class="mord mathdefault">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.7445em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.2445em;"><span class="" style="top: -6.2445em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span></span></span><span class="" style="top: -3.5815em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mord">.</span></span></span><span class="" style="top: -0.9185em;"><span class="pstrut" style="height: 3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">5</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.7445em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  where the unnormalized attention weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">e_{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span> are given by:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>e</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msubsup><mi>A</mi><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#A95AA1"><mo>−</mo><mn>10</mn></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mo>−</mo><mn>4</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>e</mi><mrow><mi>A</mi><mi>E</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msubsup><mi>A</mi><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mn>9</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>9.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>e</mi><mrow><mi>A</mi><mi>A</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msubsup><mi>A</mi><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mn>12</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>12.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{aligned}
      e_{AC} &amp;= \text{ReLU}\left({\color{#4D9DB5} A_{W}^{(1)}} 
\left({\color{#4D9DB5} W^{(1)}}{\color{#FE6100}  h_{A}^{(0)}} + 
{\color{#4D9DB5} W^{(1)}}{\color{#A95AA1}  h_{C}^{(0)}} \right)\right) =
 \text{ReLU}\left({\color{#4D9DB5} 1}\left({\color{#4D9DB5} 1}\times 
{\color{#FE6100} 6} + {\color{#4D9DB5} 1} \times  {\color{#A95AA1} 
-10}\right)\right) = \text{ReLU}\left(-4\right) = 0. \\ e_{AE} &amp;= 
\text{ReLU}\left({\color{#4D9DB5} A_{W}^{(1)}} \left({\color{#4D9DB5} 
W^{(1)}}{\color{#FE6100}  h_{A}^{(0)}} + {\color{#4D9DB5} 
W^{(1)}}{\color{#A95AA1}  h_{E}^{(0)}} \right)\right) = 
\text{ReLU}\left({\color{#4D9DB5} 1}\left({\color{#4D9DB5} 1}\times 
{\color{#FE6100} 6} + {\color{#4D9DB5} 1} \times  {\color{#A95AA1} 
3}\right)\right) = \text{ReLU}\left(9\right) = 9. \\ e_{AA} &amp;= 
\text{ReLU}\left({\color{#4D9DB5} A_{W}^{(1)}} \left({\color{#4D9DB5} 
W^{(1)}}{\color{#FE6100}  h_{A}^{(0)}} + {\color{#4D9DB5} 
W^{(1)}}{\color{#FE6100}  h_{A}^{(0)}} \right)\right) = 
\text{ReLU}\left({\color{#4D9DB5} 1}\left({\color{#4D9DB5} 1}\times 
{\color{#FE6100} 6} + {\color{#4D9DB5} 1} \times  {\color{#FE6100} 
6}\right)\right) = \text{ReLU}\left(12\right) = 12. \\
    \end{aligned}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 6.30006em; vertical-align: -2.90003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.40003em;"><span class="" style="top: -5.40003em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.07153em;" class="mord mathdefault mtight">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span style="margin-right: 0.05764em;" class="mord mathdefault mtight">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.90003em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.40003em;"><span class="" style="top: -5.40003em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">W</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">−</span><span class="mord" style="color: rgb(169, 90, 161);">1</span><span class="mord" style="color: rgb(169, 90, 161);">0</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">−</span><span class="mord">4</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span></span></span><span class="" style="top: -3.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">W</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">3</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">9</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">9</span><span class="mord">.</span></span></span><span class="" style="top: -1.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">W</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">1</span><span class="mord">2</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.90003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  We have omitted the superscripts on the attention weights for clarity.</p>
<p>  Here, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span></span></span> is just <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ReLU</mtext></mrow><annotation encoding="application/x-tex">\text{ReLU}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">ReLU</span></span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x) = \max(x, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.  </p>
<p>  Note that the weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msubsup><mi>A</mi><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  A_{W}^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.33833em; vertical-align: -0.293531em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">W</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span> are shared across all nodes!</p></div>
  </div>

  <div class="graphsage model eqn" style="display: none;">
    <div style="display: none;"><p>   <strong>Next Update (Iteration 1):</strong><br>   Equation for Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span>:
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mtext>RNN</mtext><mrow><mo fence="true">[</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo separator="true">,</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">]</mo></mrow><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mn>3</mn><mo>+</mo><mn>6</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mn>9</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mn>9</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>9.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
      \begin{aligned}
      {\color{#FE6100} h_{A}^{(1)}}
                &amp;= {f} \left(
                    {\color{#4D9DB5}  W^{(1)}} \times 
\text{RNN}\left[{\color{#A95AA1} h_{C}^{(0)}} , {\color{#A95AA1} 
h_{E}^{(0)}}\right] + 
                    {\color{#4D9DB5}  B^{(1)}} \times {\color{#FE6100} 
h_{A}^{(0)}} \right) \\ 
                &amp;= f \left(
                    {\color{#4D9DB5}  1} \times {\color{#A95AA1} 3} + 
                    {\color{#4D9DB5}  1} \times {\color{#FE6100} 6} 
\right) \\
                &amp;= f \left(
                    3 + 
                    6 \right) \\
                &amp;= f \left(9 \right) \\
                &amp;= \text{ReLU} \left(9\right)
                = 9.
      \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 8.10002em; vertical-align: -3.80001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.30001em;"><span class="" style="top: -6.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -3.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -1.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -0.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.80001em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.30001em;"><span class="" style="top: -6.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord text"><span class="mord">RNN</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">]</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -4.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">3</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -3.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">6</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -1.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">9</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -0.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">9</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">9</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.80001em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  Here, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span></span></span> is just <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ReLU</mtext></mrow><annotation encoding="application/x-tex">\text{ReLU}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">ReLU</span></span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x) = \max(x, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.  </p>
<p>  Considering the sequence of neighbours as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mstyle mathcolor="#A95AA1"><mi>C</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="#A95AA1"><mi>E</mi></mstyle><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[{\color{#A95AA1} C} , {\color{#A95AA1} E}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault">C</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault">E</span></span><span class="mclose">]</span></span></span></span>, the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RNN</mtext></mrow><annotation encoding="application/x-tex">\text{RNN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">RNN</span></span></span></span></span> computes:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="2em"></mspace><msub><mi>s</mi><mn>0</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>s</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msub><mi>U</mi><mi>s</mi></msub></mstyle><msub><mi>s</mi><mn>0</mn></msub><mo>+</mo><mstyle mathcolor="#4D9DB5"><msub><mi>U</mi><mi>h</mi></msub></mstyle><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mn>0</mn><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#A95AA1"><mo>−</mo><mn>10</mn></mstyle><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mo>−</mo><mn>10</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>s</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msub><mi>U</mi><mi>s</mi></msub></mstyle><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mstyle mathcolor="#4D9DB5"><msub><mi>U</mi><mi>h</mi></msub></mstyle><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mn>0</mn><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><mo>×</mo><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle><mo fence="true">)</mo></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mn>3</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>3.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
      \begin{aligned}
        \qquad s_0 &amp;= 0. \\
        s_{1}&amp;= \text{ReLU}\left({\color{#4D9DB5}  U_s} s_{0} + 
{\color{#4D9DB5}  U_h} {\color{#A95AA1}  h_{C}^{(0)}}\right) = 
\text{ReLU}\left(
      {\color{#4D9DB5}  1}
      \times 0 +    
      {\color{#4D9DB5}  1}    
      \times {\color{#A95AA1}  -10} \right) = 
\text{ReLU}\left(-10\right) = 0. \\ s_{2}&amp;= 
\text{ReLU}\left({\color{#4D9DB5}  U_s} s_{1} + {\color{#4D9DB5}  U_h} 
{\color{#A95AA1}  h_{E}^{(0)}}\right) = \text{ReLU}\left(
      {\color{#4D9DB5}  1}
      \times 0 +    
      {\color{#4D9DB5}  1}    
      \times {\color{#A95AA1}  3} \right) = \text{ReLU}\left(3\right) = 
3.
      \end{aligned}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.70004em; vertical-align: -2.60002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.10002em;"><span class="" style="top: -5.41002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.5em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.60002em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.10002em;"><span class="" style="top: -5.41002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span></span></span><span class="" style="top: -3.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">−</span><span class="mord" style="color: rgb(169, 90, 161);">1</span><span class="mord" style="color: rgb(169, 90, 161);">0</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">−</span><span class="mord">1</span><span class="mord">0</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span></span></span><span class="" style="top: -1.5em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">3</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">3</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">3</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.60002em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  The returned aggregated value <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{#A95AA1}  3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(169, 90, 161);">3</span></span></span></span> is just the last state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span> of the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RNN</mtext></mrow><annotation encoding="application/x-tex">\text{RNN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">RNN</span></span></span></span></span>.</p>
<p>  Concisely, the initial <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RNN</mtext></mrow><annotation encoding="application/x-tex">\text{RNN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">RNN</span></span></span></span></span> state is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s_0 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span>, and 
  the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RNN</mtext></mrow><annotation encoding="application/x-tex">\text{RNN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">RNN</span></span></span></span></span> state update equation is:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>s</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><msub><mi>U</mi><mi>s</mi></msub></mstyle><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mstyle mathcolor="#4D9DB5"><msub><mi>U</mi><mi>h</mi></msub></mstyle><msubsup><mi>h</mi><msub><mi>u</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>1</mn></mstyle><msubsup><mi>h</mi><msub><mi>u</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{aligned}
      s_{t} &amp;= \text{ReLU}\left({\color{#4D9DB5}  U_s} s_{t - 1} + 
{\color{#4D9DB5}  U_h} h_{u_t}^{(0)}\right) \\ &amp;= 
\text{ReLU}\left({\color{#4D9DB5}  1}  s_{t - 1} + {\color{#4D9DB5}  1} 
 h_{u_t}^{(0)}\right).
    \end{aligned}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.20004em; vertical-align: -1.85002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35002em;"><span class="" style="top: -4.35002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85002em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35002em;"><span class="" style="top: -4.35002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3471em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">1</span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3471em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85002em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">u_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span> is the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathdefault">t</span></span></span></span>-th neighbour of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="color: rgb(254, 97, 0);">A</span></span></span></span> in the considered sequence.</p>
<p>  In practice, we would consider different permutations of the neighbour sequence, and train the
  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RNN</mtext></mrow><annotation encoding="application/x-tex">\text{RNN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">RNN</span></span></span></span></span> to learn the same final aggregated value.
  This tries to make the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>RNN</mtext></mrow><annotation encoding="application/x-tex">\text{RNN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">RNN</span></span></span></span></span> node-order invariant.</p>
<p>  Note that the weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  W^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.13889em; color: rgb(77, 157, 181);" class="mord mathdefault">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>B</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  B^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.05017em; color: rgb(77, 157, 181);" class="mord mathdefault">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msubsup><mi>U</mi><mi>s</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  U_s^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.16139em; vertical-align: -0.116592em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">s</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msubsup><mi>U</mi><mi>h</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  U_h^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.34611em; vertical-align: -0.301308em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.10903em; color: rgb(77, 157, 181);" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.39869em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mathdefault mtight" style="color: rgb(77, 157, 181);">h</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span></span></span></span> are shared across all nodes!</p></div>
  </div>

  <div class="gin model eqn" style="display: none;">
    <div style="display: none;"><p>  <strong>Next Update (Iteration 1):</strong><br>    Equation for Node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">A</span></span></span></span>:
  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mrow><mo fence="true">(</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>C</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo>+</mo><mstyle mathcolor="#A95AA1"><msubsup><mi>h</mi><mi>E</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#4D9DB5"><msup><mi>ϵ</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo fence="true">)</mo></mrow><mo>×</mo><mstyle mathcolor="#FE6100"><msubsup><mi>h</mi><mi>A</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mstyle><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mrow><mo fence="true">(</mo><mstyle mathcolor="#A95AA1"><mo>−</mo><mn>10</mn></mstyle><mo>+</mo><mstyle mathcolor="#A95AA1"><mn>3</mn></mstyle><mo fence="true">)</mo></mrow><mo>+</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mstyle mathcolor="#4D9DB5"><mn>0</mn></mstyle><mo fence="true">)</mo></mrow><mo>×</mo><mstyle mathcolor="#FE6100"><mn>6</mn></mstyle><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mrow><mo fence="true">(</mo><mo>−</mo><mn>7</mn><mo fence="true">)</mo></mrow><mo>+</mo><mn>6</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mrow><mo fence="true">(</mo><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>ReLU</mtext><mrow><mo fence="true">(</mo><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo>=</mo><mn>0.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
    \begin{aligned}
    {\color{#FE6100} h_{A}^{(1)}}
              &amp;= {f} \left(
                  \left({\color{#A95AA1} h_{C}^{(0)}} + {\color{#A95AA1} h_{E}^{(0)}}\right) +
                  \left(1 + {\color{#4D9DB5}  {\epsilon}^{(1)}}\right) \times {\color{#FE6100} h_{A}^{(0)}} \right) \\ 
              &amp;= f \left(
                  \left({\color{#A95AA1} -10} + {\color{#A95AA1} 3}\right) +  
                  \left(1 + {\color{#4D9DB5}  0}\right)
                  \times {\color{#FE6100} 6} \right) \\
              &amp;= f \left(
                  \left(-7\right) + 
                  6 \right) \\
              &amp;= f \left(-1 \right) \\
              &amp;= \text{ReLU} \left(-1\right)
              = 0.
    \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 8.10002em; vertical-align: -3.80001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.30001em;"><span class="" style="top: -6.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -3.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -1.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -0.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.80001em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.30001em;"><span class="" style="top: -6.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.07153em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">C</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);"><span class="mord mathdefault" style="color: rgb(169, 90, 161);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span style="margin-right: 0.05764em; color: rgb(169, 90, 161);" class="mord mathdefault mtight">E</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(169, 90, 161);"><span class="mord mtight" style="color: rgb(169, 90, 161);"><span class="mopen mtight" style="color: rgb(169, 90, 161);">(</span><span class="mord mtight" style="color: rgb(169, 90, 161);">0</span><span class="mclose mtight" style="color: rgb(169, 90, 161);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">ϵ</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mord mathdefault mtight" style="color: rgb(254, 97, 0);">A</span></span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.293531em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span><span class="" style="top: -4.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">−</span><span class="mord" style="color: rgb(169, 90, 161);">1</span><span class="mord" style="color: rgb(169, 90, 161);">0</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(169, 90, 161);">3</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);">0</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);">6</span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -3.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">−</span><span class="mord">7</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">6</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -1.50999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -0.00999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.80001em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>  Here, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span></span></span></span> is just <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ReLU</mtext></mrow><annotation encoding="application/x-tex">\text{ReLU}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord text"><span class="mord">ReLU</span></span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x) = \max(x, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.10764em;" class="mord mathdefault">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.  </p>
<p>  Note that the weight <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mi>ϵ</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#4D9DB5}  {\epsilon}^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord mathdefault" style="color: rgb(77, 157, 181);">ϵ</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span class="mord mtight" style="color: rgb(77, 157, 181);">1</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span> is shared across all nodes!</p></div>
  </div></span></div></div>
        <div class="interactive-gnn-visualizations-network_display_hack" style="display: none;"><div class="observablehq"><span class="observablehq--collapsed observablehq--inspect"><span class="observablehq--cellname">network_display_hack = </span><a><svg width="8" height="8" class="observablehq--caret">
    <path d="M7 4L1 8V0z" fill="currentColor"></path>
  </svg>Array(9) [</a><span class="observablehq--shallow">HTMLDivElement</span>, <span class="observablehq--shallow">SVGSVGElement</span>, <span><span class="observablehq--undefined">undefined</span></span>, <span class="observablehq--shallow">SVGSVGElement</span>, <span><span class="observablehq--undefined">undefined</span></span>, <span class="observablehq--shallow">SVGSVGElement</span>, <span><span class="observablehq--undefined">undefined</span></span>, <span class="observablehq--shallow">SVGSVGElement</span>, <span><span class="observablehq--undefined">undefined</span></span>]</span></div></div>
        <div class="interactive-gnn-visualizations-style"><div class="observablehq"><style>
    div.eqn {
      margin-left: 2%;      
    }

    #gnn-models-viz ul {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      grid-column-gap: 4px;
      text-align: center;
      padding: 0;
      justify-content: center;
      align-content: center;
      list-style: none;
      max-width: 100%;
    }

    #gnn-models-viz ul li {
      margin: 0;
      background: #f3f3f3;
      border-bottom: 3px solid #e3e3e3;
      cursor: pointer;
      line-height: 2em;
      border-top-left-radius: 3px;
      border-top-right-radius: 3px;
    }

    #gnn-models-viz ul li:hover {
      border-bottom-color: #D9D9D9;
    }

    #gnn-models-viz ul li.selected {
      background: #D9D9D9;
      border-bottom-color: #D9D9D9;
    }

    #gnn-models-viz {

    }
    
    /* Nicer sliders. */
    input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
    }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
  </style></div></div>
      </div>

      <script type="module">
      import {Runtime, Inspector} from "./observablehq-base/runtime.js";
      import define from "./notebooks/interactive-gnn-visualizations.js";
      setTimeout(() => {
        new Runtime().module(define, name => {
          if (name === "viz_list") return Inspector.into(".interactive-gnn-visualizations-viz_list")();
          if (name === "buttons") return Inspector.into(".interactive-gnn-visualizations-buttons")();
          if (name === "fig") return Inspector.into(".interactive-gnn-visualizations-fig")();
          if (name === "eqn") return Inspector.into(".interactive-gnn-visualizations-eqn")();
          if (name === "network_display_hack") return Inspector.into(".interactive-gnn-visualizations-network_display_hack")();
          if (name === "style") return Inspector.into(".interactive-gnn-visualizations-style")();
          return ["interactive_list","select_fig","handle_click"].includes(name) || null;
        });
      }, 200);
      </script>
      <figure>
        <figcaption>
          Choose a GNN model using the tabs at the top. Click on a node 
to see the update equation at that node for the next iteration.
          Use the sliders on the left to change the weights for the 
current iteration, and watch how the update equation changes. 
        </figcaption>
      </figure>

      <p>
        In practice, each iteration above is generally thought of as a single ‘neural network layer’.
        This ideology is followed by many popular Graph Neural Network libraries,
        <d-footnote>
        For example: <a href="https://pytorch-geometric.readthedocs.io/en/latest/modules/nn.html">PyTorch Geometric</a>
        and <a href="https://stellargraph.readthedocs.io/en/stable/api.html#module-stellargraph.layer">StellarGraph</a>.
        </d-footnote>
        allowing one to compose different types of graph convolutions in the same model.
      </p>

    <h2 id="from-local-to-global">
      From Local to Global Convolutions       
    </h2>
      <p>
        The methods we’ve seen so far perform ‘local’ convolutions:
        every node’s feature is updated using a function of its local neighbours’ features.
      </p>
      <p>
        While performing enough steps of message-passing will eventually ensure that
        information from all nodes in the graph is passed,
        one may wonder if there are more direct ways to perform ‘global’ convolutions.
      </p>
      <p>
        The answer is yes; we will now describe an approach that was actually first put forward
        in the context of neural networks by <d-cite key="spectral-networks"></d-cite>,
        much before any of the GNN models we looked at above.
      </p> 

      <h3 id="spectral">
        Spectral Convolutions      
      </h3>
      <p>
        As before, we will focus on the case where nodes have one-dimensional features.
        After choosing an arbitrary node-order, we can stack all of the node features to get a
        ‘feature vector’ <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.72799em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>.
      </p>
      <p class="shaded-figure" style="padding-left: 1em;">
        <b>Key Idea:</b>
        Given a feature vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>, 
        the Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> allows us to quantify how smooth <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> is, with respect to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span>.
      </p>
      <p>
        How?
      </p>
      <p>
        After normalizing <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> such that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i = 1}^n x_i^2 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.113818em;vertical-align:-0.29971000000000003em;"></span><span class="base"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span>,
        if we look at the following quantity involving <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>:
        <d-footnote>
          <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">R_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> is formally called the <a href="https://en.wikipedia.org/wiki/Rayleigh_quotient">Rayleigh quotient</a>.
        </d-footnote> 
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>L</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mfrac><mrow><msup><mi>x</mi><mi>T</mi></msup><mi>L</mi><mi>x</mi></mrow><mrow><msup><mi>x</mi><mi>T</mi></msup><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>∈</mo><mi>E</mi></mrow></msub><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><msub><mo>∑</mo><mi>i</mi></msub><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>=</mo><msub><mo>∑</mo><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>∈</mo><mi>E</mi></mrow></msub><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          R_L(x) = \frac{x^T L x}{x^T x} = \frac{\sum_{(i, j) \in E} 
(x_i - x_j)^2}{\sum_i x_i^2} = \sum_{(i, j) \in E} (x_i - x_j)^2.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6788180000000001em;"></span><span class="strut bottom" style="height:3.1948230000000004em;vertical-align:-1.516005em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">L</span><span class="mord mathit">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mrel">=</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6788180000000001em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959080000000001em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.86471em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857100000000001em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        we immediately see that feature vectors <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> that assign similar values to 
        adjacent nodes in <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> (hence, are smooth) would have smaller values of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>L</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">R_L(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>.
      </p>
      <p>
        <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> is a real, symmetric matrix, which means it has all real eigenvalues <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>≤</mo><mo>…</mo><mo>≤</mo><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_1 \leq \ldots \leq \lambda_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">≤</span><span class="minner">…</span><span class="mrel">≤</span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>.
        <d-footnote>
          An eigenvalue <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">λ</span></span></span></span></span> of a matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span></span> is a value
          satisfying the equation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>u</mi><mo>=</mo><mi>λ</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">Au = \lambda u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span><span class="mord mathit">u</span><span class="mrel">=</span><span class="mord mathit">λ</span><span class="mord mathit">u</span></span></span></span></span> for a certain vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">u</span></span></span></span></span>, called an eigenvector.
          For a friendly introduction to eigenvectors,
          please see <a href="http://www.sosmath.com/matrix/eigen0/eigen0.html">this tutorial</a>.
        </d-footnote>
        Further, the corresponding eigenvectors <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>u</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">u_1, \ldots, u_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> can be taken to be orthonormal:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>u</mi><msub><mi>k</mi><mn>1</mn></msub><mi>T</mi></msubsup><msub><mi>u</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mspace width="1em"></mspace><mtext>&nbsp;if&nbsp;</mtext><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><mo>=</mo><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mspace width="1em"></mspace><mtext>&nbsp;if&nbsp;</mtext><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><mo>≠</mo><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
          u_{k_1}^T u_{k_2} =
          \begin{cases}
            1 \quad \text{ if } {k_1} = {k_2}. \\
            0 \quad \text{ if } {k_1} \neq {k_2}.
          \end{cases}
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.75em;"></span><span class="strut bottom" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="base"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.891331em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"></span></span></span></span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.34709999999999996em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"></span></span></span></span></span><span class="mrel">=</span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathrm">1</span><span class="mord text"><span class="mspace quad"></span><span class="mord mathrm">&nbsp;if&nbsp;</span></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathrm">0</span><span class="mord text"><span class="mspace quad"></span><span class="mord mathrm">&nbsp;if&nbsp;</span></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span><span class="mrel">≠</span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
        It turns out that these eigenvectors of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> are successively less smooth, as <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">R_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> indicates:
        <d-footnote>This is the <a href="https://en.wikipedia.org/wiki/Min-max_theorem">min-max theorem for eigenvalues.</a></d-footnote>
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo><mtext>argmin</mtext></mo><mrow><mi>x</mi><mo separator="true">,</mo><mtext>&nbsp;</mtext><mi>x</mi><mo>⊥</mo><mo>{</mo><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>}</mo></mrow></msub><msub><mi>R</mi><mi>L</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msub><mi>u</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi>min</mi><mrow><mi>x</mi><mo separator="true">,</mo><mtext>&nbsp;</mtext><mi>x</mi><mo>⊥</mo><mo>{</mo><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>}</mo></mrow></msub><msub><mi>R</mi><mi>L</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          \underset{x, \ x \perp \{u_1, \ldots, u_{i - 1}\}}{\text{argmin}} R_L(x) = u_i.
          \qquad
          \qquad
          \qquad
          \min_{x, \ x \perp \{u_1, \ldots, u_{i - 1}\}} R_L(x) = \lambda_i.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.91044em;vertical-align:-1.16044em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678600000000002em;"><span style="top:-2.11456em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight"><span class="mspace mtight"><span class="mtight">&nbsp;</span></span><span class="mord mathit mtight">x</span></span><span class="mrel mtight">⊥</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">…</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32808571428571426em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span><span style="top:-3.0000000000000004em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord text"><span class="mord mathrm">argmin</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.16044em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathrm">.</span><span class="mop op-limits"><span class="mspace qquad"></span><span class="mspace qquad"></span><span class="mspace qquad"></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.009em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight"><span class="mspace mtight"><span class="mtight">&nbsp;</span></span><span class="mord mathit mtight">x</span></span><span class="mrel mtight">⊥</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">…</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32808571428571426em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        The set of eigenvalues of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> are called its ‘spectrum’, hence the name!
        We denote the ‘spectral’ decomposition of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span> as:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mi>U</mi><mi mathvariant="normal">Λ</mi><msup><mi>U</mi><mi>T</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          L = U \Lambda U^T.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mord mathrm">Λ</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Λ</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">Λ</span></span></span></span></span> is the diagonal matrix of sorted eigenvalues,
        and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10903em;">U</span></span></span></span></span> denotes the matrix of the eigenvectors (sorted corresponding to increasing eigenvalues):
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Λ</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>⋱</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>λ</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>U</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>u</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><mo>⋯</mo><mtext>&nbsp;</mtext><msub><mi>u</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          \Lambda = \begin{bmatrix}
                        \lambda_{1} &amp;        &amp; \\
                                    &amp; \ddots &amp; \\
                                    &amp;        &amp; \lambda_{n}
                    \end{bmatrix}
          \qquad
          \qquad
          \qquad
          \qquad
          U = \begin{bmatrix}  \\ u_1 \ \cdots \ u_n \\ \end{bmatrix}.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em;"></span><span class="strut bottom" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="base"><span class="mord mathrm">Λ</span><span class="mrel">=</span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"></span></span></span></span></span></span><span class="mord mathit"><span class="mspace qquad"></span><span class="mspace qquad"></span><span class="mspace qquad"></span><span class="mspace qquad"></span><span class="mord mathit" style="margin-right:0.10903em;">U</span></span><span class="mrel">=</span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="minner"><span class="mspace">&nbsp;</span><span class="minner">⋯</span></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        The orthonormality condition between eigenvectors gives us that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>U</mi><mi>T</mi></msup><mi>U</mi><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">U^T U = I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span></span></span>, the identity matrix.
        As these <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">n</span></span></span></span></span> eigenvectors form a basis for <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.68889em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>,
        any feature vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> can be represented as a linear combination of these eigenvectors:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mover accent="true"><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>^</mo></mover><msub><mi>u</mi><mi>i</mi></msub><mo>=</mo><mi>U</mi><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          x = \sum_{i = 1}^n \hat{x_i} u_i = U \hat{x}.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6513970000000002em;"></span><span class="strut bottom" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord mathit">x</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span> is the vector of coefficients <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mo>…</mo><msub><mi>x</mi><mi>n</mi></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">[x_0, \ldots x_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">[</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>.
        We call <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span> as the spectral representation of the feature vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>.
        The orthonormality condition allows us to state:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mi>U</mi><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mspace width="1em"></mspace><mo>⟺</mo><mspace width="1em"></mspace><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi><mo>=</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          x = U \hat{x} \quad \Longleftrightarrow \quad U^T x = \hat{x}.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:0.9153309999999999em;vertical-align:-0.024em;"></span><span class="base"><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="mrel"><span class="mspace quad"></span><span class="mrel">⟺</span></span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        This pair of equations allows us to interconvert
        between the ‘natural’ representation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> and the ‘spectral’ representation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span>
        for any vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.72799em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit">x</span><span class="mrel">∈</span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>.
      </p>
      <h3 id="spectral-decompositions-of-natural-images">
        Spectral Representations of Natural Images
      </h3>
      <p>
        As discussed before, we can consider any image as a grid graph, where each pixel is a node,
        connected by edges to adjacent pixels.
        Thus, a pixel can have either <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">3, 5,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathrm">3</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mpunct">,</span></span></span></span></span> or <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">8</span></span></span></span></span> neighbours, depending on its location within the image grid.
        Each pixel gets a value as part of the image. If the image is grayscale, each value will be a single 
        real number indicating how dark the pixel is. If the image is colored, each value will be a <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">3</span></span></span></span></span>-dimensional
        vector, indicating the values for the red, green and blue (RGB) channels.
        <d-footnote>We use the alpha channel as well in the visualization below, so this is actually RGBA.</d-footnote>
      </p>
      <p>
        This construction allows us to compute the graph Laplacian and the eigenvector matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10903em;">U</span></span></span></span></span>.
        Given an image, we can then investigate what its spectral representation looks like.
      </p>
      <p>
        To shed some light on what the spectral representation actually encodes,
        we perform the following experiment over each channel of the image independently:  
      </p>
        <ul>
          <li>
            We first collect all pixel values across a channel into a feature vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>.
          </li>
          <li>
            Then, we obtain its spectral representation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span>.
            <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mo>=</mo><msup><mi>U</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">
              \hat{x} = U^T x
            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span></span></span></span></span></span>
          </li>
          <li>
            We truncate this to the first <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span></span></span></span></span> components to get <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\hat{x}_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>.
            By truncation, we mean zeroing out all of the remaining <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>−</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n - m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">n</span><span class="mbin">−</span><span class="mord mathit">m</span></span></span></span></span> components of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span>.
            This truncation is equivalent to using only the first <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span></span></span></span></span> eigenvectors to compute the spectral representation.
            <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mi>m</mi></msub><mo>=</mo><msub><mtext>Truncate</mtext><mi>m</mi></msub><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">
              \hat{x}_m = \text{Truncate}_m(\hat{x})
            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord text"><span class="mord mathrm">Truncate</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>
          </li>
          <li>
            Then, we convert this truncated representation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\hat{x}_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> back to the natural basis to get <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">x_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>.
            <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub><mo>=</mo><mi>U</mi><msub><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">
              x_m = U \hat{x}_m
            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span></span>
          </li>
        </ul>
      <p>
        Finally, we stack the resulting channels back together to get back an image.
        We can now see how the resulting image changes with choices of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span></span></span></span></span>.
        Note that when <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span><span class="mrel">=</span><span class="mord mathit">n</span></span></span></span></span>, the resulting image is identical to the original image,
        as we can reconstruct each channel exactly.
      </p>
      <div class="shaded-figure l-screen" id="spectral-decompositions-viz" style="grid-column: page; padding-bottom: 1em; padding-top: 1em;">
        <div id="observablehq-spectralDecompositionsAll-59114e0b" class="observablehq"><div id="specDecompAll">
    <div id="specDecompInputsRadio">
    <form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;">Sample Image</div>
        <label style="display: inline-block; margin: 5px 10px 3px 0; font-size: 0.85em;">
           <input type="radio" name="input" checked="checked" style="vertical-align: top; margin-left: 1px;" value="chicken">
           Chicken
          </label><label style="display: inline-block; margin: 5px 10px 3px 0; font-size: 0.85em;">
           <input type="radio" name="input" style="vertical-align: top; " value="fish">
           Fish
          </label><label style="display: inline-block; margin: 5px 10px 3px 0; font-size: 0.85em;">
           <input type="radio" name="input" style="vertical-align: top; " value="frog">
           Frog
          </label><label style="display: inline-block; margin: 5px 10px 3px 0; font-size: 0.85em;">
           <input type="radio" name="input" style="vertical-align: top; " value="spider">
           Spider
          </label>
      </div></form>
  </div>
    <div id="specDecompBody">
    <div id="orig">
      <canvas width="271" height="217"></canvas>
      <figcaption id="origCaption">
  Original Image
  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span>
</figcaption>
    </div>
    <svg id="svgArrow" width="320" height="50" viewBox="0 0 320 50">
<g>
  <text id="caption" text-anchor="middle" dominant-baseline="central" x="160" y="40">Keep First 200 Spectral Components</text>
<defs><marker id="arrow" viewBox="0,0,20,20" refX="10" refY="10" markerWidth="10" markerHeight="10" orient="auto-start-reverse"><path d="M0,0L0,20L20,10" stroke="black"></path></marker></defs><path d="M10,25L310,25" stroke="black" marker-end="url(#arrow)" fill="none"></path></g>
</svg>
    <div id="upd">
      <canvas width="271" height="217"></canvas>
      <figcaption id="updCaption">
  Transformed Image
  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo lspace="0em" rspace="0em" mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">x'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>
</figcaption>
    </div>
  </div>
    <div id="specDecompInputsSlider">
    <form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;">Number of Spectral Components (m)</div>
	<input name="input" type="range" min="0" max="11" step="1" value="6">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">200</output></div></form>
  </div>
  </div></div>
        <div id="observablehq-updateArrowCaption-59114e0b" style="display: none;" class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">updateArrowCaption = </span><span class="observablehq--undefined">undefined</span></span></div>
        <div id="observablehq-drawArrow-59114e0b" style="display: none;" class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">drawArrow = </span><span class="observablehq--undefined">undefined</span></span></div>
        <div id="observablehq-drawCurrBaseImg-59114e0b" style="display: none;" class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">drawCurrBaseImg = </span><span class="observablehq--undefined">undefined</span></span></div>
        <div id="observablehq-drawCurrUpdImg-59114e0b" style="display: none;" class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">drawCurrUpdImg = </span><span class="observablehq--undefined">undefined</span></span></div>
        <div id="observablehq-style-59114e0b" style="display: none;" class="observablehq"><style>
    #specDecompBody {
      display: flex;
      justify-content: center;
    }
    #svgArrow {
      margin-top: 83px;
      margin-left: 2em;
      margin-right: 2em;
    }
    #specDecompAll {
      display: flex;
      flex-direction: column;
      text-align: center;
      height: 350px;
      justify-content: space-evenly;
    }
    #specDecompInputsRadio input {
      margin-top: 0.5em;
      vertical-align: unset !important;
    }
    #origCaption {
      margin-top: 1em;
    }
    #updCaption {
      margin-top: 1em;
    }</style></div>
        <!-- <p>Credit: <a href="https://observablehq.com/@ameyasd/spectral-decompositions-of-natural-images">Spectral Decompositions of Natural Images by Ameya Daigavane</a></p> -->

        <script type="module">
        import {Runtime, Inspector} from "./observablehq-base/runtime.js";   
        import define from "./notebooks/spectral-decompositions-of-natural-images.js";
        setTimeout(() => {
          new Runtime().module(define, name => {
            if (name === "spectralDecompositionsAll") return new Inspector(document.querySelector("#observablehq-spectralDecompositionsAll-59114e0b"));
            if (name === "updateArrowCaption") return new Inspector(document.querySelector("#observablehq-updateArrowCaption-59114e0b"));
            if (name === "drawArrow") return new Inspector(document.querySelector("#observablehq-drawArrow-59114e0b"));
            if (name === "drawCurrBaseImg") return new Inspector(document.querySelector("#observablehq-drawCurrBaseImg-59114e0b"));
            if (name === "drawCurrUpdImg") return new Inspector(document.querySelector("#observablehq-drawCurrUpdImg-59114e0b"));
            if (name === "style") return new Inspector(document.querySelector("#observablehq-style-59114e0b"));
          });
        }, 200);
        </script>
      </div>
      <figure>
        <figcaption>
          Use the radio buttons at the top to chose one of the four sample images.
          Each of these images has been taken from the ImageNet <d-cite key="imagenet"></d-cite>
          dataset and downsampled to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span></span> pixels wide and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">40</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">4</span><span class="mord mathrm">0</span></span></span></span></span> pixels tall.
          As there are <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>5</mn><mn>0</mn><mo>×</mo><mn>4</mn><mn>0</mn><mo>=</mo><mn>2</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">n = 50 \times 40 = 2000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span><span class="mbin">×</span><span class="mord mathrm">4</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span> pixels in each image, there are <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">2000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span></span> Laplacian eigenvectors.
          Use the slider at the bottom to change the number of spectral components to keep, noting how
          images get progressively blurrier as the number of components decrease.
        </figcaption>
      </figure>
      <p>
        As <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span></span></span></span></span> decreases, we see that the output image <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">x_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> gets blurrier.
        If we decrease <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span></span></span></span></span>, the output image <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">x_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> is entirely the same color throughout.
        We see that we do not need to keep all <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">n</span></span></span></span></span> components;
        we can retain a lot of the information in the image with significantly fewer components.

        We can relate this to the Fourier decomposition of images:
        the more eigenvectors we use, the higher frequencies we can represent on the grid.
      </p>
      <p>
        To complement the visualization above,
        we additionally visualize the first few eigenvectors on a smaller <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>8</mn><mo>×</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8 \times 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord mathrm">8</span><span class="mbin">×</span><span class="mord mathrm">8</span></span></span></span></span> grid below.
        We change the coefficients of the first <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span></span> out of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>6</mn><mn>4</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">6</span><span class="mord mathrm">4</span></span></span></span></span> eigenvectors
        in the spectral representation
        and see how the resulting image changes:
      </p>
      <div class="shaded-figure l-screen" id="spectral-conversions" style="grid-column: page; padding-bottom: 0; padding-top: 0;">
        <div id="observablehq-figcaptions-6ac8e785" class="observablehq"><div id="figcaptions">
    <figcaption id="spec-caption-1">Spectral Representation</figcaption>
    <figcaption id="spec-caption-2"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>=</mo><mrow><mo fence="true">[</mo><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>1</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>2</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>3</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>4</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>5</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>6</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>7</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>8</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>9</mn></msub><mtext>&nbsp;</mtext><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>10</mn></msub><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{x}
 = \left[
    \hat{x}_{1} \ \hat{x}_{2} \ \hat{x}_{3} \ \hat{x}_{4} \ \hat{x}_{5} \
 \hat{x}_{6} \ \hat{x}_{7} \ \hat{x}_{8} \ \hat{x}_{9} \ \hat{x}_{10}
  \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">]</span></span></span></span></span></figcaption>
    <div id="quot-caption-div">
      <figcaption id="quot-caption-1"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1.77</mn></mrow><annotation encoding="application/x-tex">R_L(x) = 1.77</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span style="margin-right: 0.00773em;" class="mord mathdefault">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">7</span><span class="mord">7</span></span></span></span></figcaption>
    </div>
    <figcaption id="nat-caption-1">Natural Representation</figcaption>
    <figcaption id="nat-caption-2"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mn>64</mn></msup></mrow><annotation encoding="application/x-tex">x \in \mathbb{R}^{64}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></figcaption>
</div></div>
        <div id="observablehq-spec_conv_main_div-6ac8e785" class="l-page observablehq" style="padding-left: 80px;"><span><style>
   #spec-main-div {
      position: relative;
      height: 400px;
   }

   #spec-svg {
      position: absolute;
      left: 0px;
      top: 0px;
   }

   #figcaptions {
      position: relative;
   }

   #figcaptions figcaption {
      position: absolute;
   }

   #spec-caption-1 {
      left: 660px;
      top: 400px;
   }
   #spec-caption-2 {
      left: 620px;
      top: 420px;
   }
   #quot-caption-div {
      position: relative;
      width: 200px;
      left: 170px;
      top: 350px;
   }
   #figcaptions #quot-caption-1 {
      position: relative;
      text-align: center;
      font: inherit;
      color: inherit;
   }
   #nat-caption-1 {
      left: 205px;
      top: 400px;
   }
   #nat-caption-2 {
      left: 255px;
      top: 420px;
   }

   #spec-sliders form {
      margin-left: 2%;
      margin-right: 2%;
   }
    
   #spec-sliders input {
      width: 100%;
   }

   #spec-sliders output {
      width: 3em;
      margin-left: 0 !important;
   }

   #spec-sliders {
      display: flex;
      margin: 0 auto;
      text-align: center;
   }

   #subgrid-main-div {
      display: flex;
      margin: 0 auto;
   }

   input[type="range"] {
      -webkit-appearance: none;
      grid-column: middle;
      height: 5px;
      border-radius: 1px;   
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }

   input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%; 
      background: #575245;
      cursor: pointer;
    }

   input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #f5f2eb;
      cursor: pointer;
   }

   output[name="output"] {
      width: 1em;
      display: inline-block;
   }
</style>
  <div id="spec-main-div">
    <svg id="spec-svg" viewBox="0,0,1072,400" width="1072" height="400"><g class="img" transform="translate(150,100)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(36, 103, 166)"></rect><rect stroke="silver" x="12" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(21, 78, 137)"></rect><rect stroke="silver" x="24" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(21, 78, 137)"></rect><rect stroke="silver" x="36" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(53, 127, 184)"></rect><rect stroke="silver" x="48" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(231, 238, 242)"></rect><rect stroke="silver" x="60" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(228, 129, 104)"></rect><rect stroke="silver" x="72" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(246, 183, 154)"></rect><rect stroke="silver" x="84" y="0" width="12" height="12" stroke-width="0.5" fill="rgb(81, 153, 198)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(40, 110, 172)"></rect><rect stroke="silver" x="12" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(39, 108, 170)"></rect><rect stroke="silver" x="24" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(41, 111, 173)"></rect><rect stroke="silver" x="36" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(74, 148, 196)"></rect><rect stroke="silver" x="48" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(213, 231, 240)"></rect><rect stroke="silver" x="60" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(233, 142, 114)"></rect><rect stroke="silver" x="72" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(228, 130, 104)"></rect><rect stroke="silver" x="84" y="12" width="12" height="12" stroke-width="0.5" fill="rgb(233, 142, 114)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(124, 182, 214)"></rect><rect stroke="silver" x="12" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(110, 174, 210)"></rect><rect stroke="silver" x="24" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(96, 164, 204)"></rect><rect stroke="silver" x="36" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(125, 183, 214)"></rect><rect stroke="silver" x="48" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(233, 239, 242)"></rect><rect stroke="silver" x="60" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(232, 140, 112)"></rect><rect stroke="silver" x="72" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(207, 83, 73)"></rect><rect stroke="silver" x="84" y="24" width="12" height="12" stroke-width="0.5" fill="rgb(184, 45, 53)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(214, 99, 82)"></rect><rect stroke="silver" x="12" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(235, 147, 118)"></rect><rect stroke="silver" x="24" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(250, 210, 189)"></rect><rect stroke="silver" x="36" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(218, 233, 241)"></rect><rect stroke="silver" x="48" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(250, 223, 207)"></rect><rect stroke="silver" x="60" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(240, 162, 132)"></rect><rect stroke="silver" x="72" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(217, 104, 85)"></rect><rect stroke="silver" x="84" y="36" width="12" height="12" stroke-width="0.5" fill="rgb(194, 59, 60)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(157, 22, 42)"></rect><rect stroke="silver" x="12" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(194, 59, 60)"></rect><rect stroke="silver" x="24" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(221, 112, 91)"></rect><rect stroke="silver" x="36" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(242, 168, 138)"></rect><rect stroke="silver" x="48" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(250, 210, 189)"></rect><rect stroke="silver" x="60" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(251, 216, 198)"></rect><rect stroke="silver" x="72" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(248, 193, 167)"></rect><rect stroke="silver" x="84" y="48" width="12" height="12" stroke-width="0.5" fill="rgb(244, 176, 147)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(190, 53, 57)"></rect><rect stroke="silver" x="12" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(203, 75, 68)"></rect><rect stroke="silver" x="24" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(210, 89, 76)"></rect><rect stroke="silver" x="36" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(227, 126, 101)"></rect><rect stroke="silver" x="48" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(248, 194, 168)"></rect><rect stroke="silver" x="60" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(190, 219, 234)"></rect><rect stroke="silver" x="72" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(152, 199, 223)"></rect><rect stroke="silver" x="84" y="60" width="12" height="12" stroke-width="0.5" fill="rgb(124, 182, 214)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(117, 178, 212)"></rect><rect stroke="silver" x="12" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(251, 218, 200)"></rect><rect stroke="silver" x="24" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(218, 106, 87)"></rect><rect stroke="silver" x="36" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(215, 99, 82)"></rect><rect stroke="silver" x="48" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(243, 172, 142)"></rect><rect stroke="silver" x="60" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="72" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(118, 178, 212)"></rect><rect stroke="silver" x="84" y="72" width="12" height="12" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(5, 48, 97)"></rect><rect stroke="silver" x="12" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(91, 160, 202)"></rect><rect stroke="silver" x="24" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(218, 107, 88)"></rect><rect stroke="silver" x="36" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(200, 69, 65)"></rect><rect stroke="silver" x="48" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(238, 154, 124)"></rect><rect stroke="silver" x="60" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(152, 199, 223)"></rect><rect stroke="silver" x="72" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(109, 173, 209)"></rect><rect stroke="silver" x="84" y="84" width="12" height="12" stroke-width="0.5" fill="rgb(162, 204, 226)"></rect></g></g><g class="graph" transform="translate(500,-100)"><g transform="translate(0, 250)"><text x="320" y="30" text-anchor="middle" dominant-baseline="central">Spectral Coefficient</text><text x="150" y="184" text-anchor="middle" dominant-baseline="central">Eigenvector #</text><text x="-75" y="5">Value</text></g><g fill="none" font-size="10" font-family="sans-serif" text-anchor="middle" transform="translate(0, 250)"><path class="domain" stroke="currentColor" d="M0.5,6V0.5H300.5V6"></path></g><g fill="none" font-size="10" font-family="sans-serif" text-anchor="end" transform="translate(0, 0)"><path class="domain" stroke="currentColor" d="M-6,130.5H0.5V370.5H-6"></path><g class="tick" opacity="1" transform="translate(0,130.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">1.0</text></g><g class="tick" opacity="1" transform="translate(0,154.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">0.8</text></g><g class="tick" opacity="1" transform="translate(0,178.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">0.6</text></g><g class="tick" opacity="1" transform="translate(0,202.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">0.4</text></g><g class="tick" opacity="1" transform="translate(0,226.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">0.2</text></g><g class="tick" opacity="1" transform="translate(0,250.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">0.0</text></g><g class="tick" opacity="1" transform="translate(0,274.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">−0.2</text></g><g class="tick" opacity="1" transform="translate(0,298.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">−0.4</text></g><g class="tick" opacity="1" transform="translate(0,322.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">−0.6</text></g><g class="tick" opacity="1" transform="translate(0,346.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">−0.8</text></g><g class="tick" opacity="1" transform="translate(0,370.5)"><line stroke="currentColor" x2="-6"></line><text fill="currentColor" x="-9" dy="0.32em">−1.0</text></g></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="20" x2="20" display="" y1="0" y2="0"></line><circle class="coeff-circle" r="3" cx="20" stroke="black" stroke-width="0.1" display="" cy="0"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="20" display="" y="0" dy="20">1</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="40" x2="40" display="" y1="0" y2="36"></line><circle class="coeff-circle" r="3" cx="40" stroke="black" stroke-width="0.1" display="" cy="36"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="40" display="" y="36" dy="20">2</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="60" x2="60" display="" y1="0" y2="36"></line><circle class="coeff-circle" r="3" cx="60" stroke="black" stroke-width="0.1" display="" cy="36"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="60" display="" y="36" dy="20">3</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="80" x2="80" display="" y1="0" y2="-72"></line><circle class="coeff-circle" r="3" cx="80" stroke="black" stroke-width="0.1" display="" cy="-72"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="80" display="" y="-72" dy="-20">4</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="100" x2="100" display="" y1="0" y2="84"></line><circle class="coeff-circle" r="3" cx="100" stroke="black" stroke-width="0.1" display="" cy="84"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="100" display="" y="84" dy="20">5</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="120" x2="120" display="" y1="0" y2="-48"></line><circle class="coeff-circle" r="3" cx="120" stroke="black" stroke-width="0.1" display="" cy="-48"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="120" display="" y="-48" dy="-20">6</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="140" x2="140" display="" y1="0" y2="-48"></line><circle class="coeff-circle" r="3" cx="140" stroke="black" stroke-width="0.1" display="" cy="-48"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="140" display="" y="-48" dy="-20">7</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="160" x2="160" display="" y1="0" y2="-48"></line><circle class="coeff-circle" r="3" cx="160" stroke="black" stroke-width="0.1" display="" cy="-48"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="160" display="" y="-48" dy="-20">8</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="180" x2="180" display="" y1="0" y2="-48"></line><circle class="coeff-circle" r="3" cx="180" stroke="black" stroke-width="0.1" display="" cy="-48"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="180" display="" y="-48" dy="-20">9</text></g><g class="coeff" transform="translate(0, 250)"><line class="coeff-line" stroke="black" stroke-width="1" x1="200" x2="200" display="" y1="0" y2="-84"></line><circle class="coeff-circle" r="3" cx="200" stroke="black" stroke-width="0.1" display="" cy="-84"></circle><text class="coeff-text" text-anchor="middle" dominant-baseline="central" x="200" display="" y="-84" dy="-20">10</text></g></g></svg>
  </div></span></div>
        <div id="observablehq-spec_color_scale-6ac8e785" style="position: relative; left: 116px; top: -182px;" class="observablehq"><svg width="320" height="50" viewBox="0,0,320,50" style="overflow: visible; display: block;"><image x="0" y="18" width="320" height="10" preserveAspectRatio="none" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAA/UlEQVQ4T3WQ23EFIQxDMVtIykv/BYAjyQ/Ym+SDkXUkw87a9/jyx8Z4zHDeOv/l6M7odgeDZilzaDJq++KphkfVm3NMzMZZbI7KDI+dLLhYdjoHM91zOsdHxq5O937zyJ/u0ePSy2PG/mEPZt6biq48Ne+iVz9VuUWPPBQnmXatWKhXn7wOfzpmv5jj/2MBrDJ6k3dwPAzlGaGfHkFn6Ozy0M2dWzV7MB3vfs1/6cJFwaNPXTkvgOI1M6udZrgjePSp5V+MPWZXvsun9n75T+W38Z2Ll9e3gnvmxV0cfyd5KDx4z9rbuc9unO1nbqZsZSd1hW7xOyt/5eq+zw/+tV6miFyQngAAAABJRU5ErkJggg=="></image><g transform="translate(0,28)" fill="none" font-size="10" font-family="sans-serif" text-anchor="middle"><g class="tick" opacity="1" transform="translate(17.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">−0.4</text></g><g class="tick" opacity="1" transform="translate(59.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">−0.2</text></g><g class="tick" opacity="1" transform="translate(160.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">0.0</text></g><g class="tick" opacity="1" transform="translate(261.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">0.2</text></g><g class="tick" opacity="1" transform="translate(303.5,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">0.4</text></g><text x="0" y="-16" fill="currentColor" text-anchor="start" font-weight="bold" class="title">Color Scale</text></g></svg></div>
        <div id="observablehq-spec_conv_sliders-6ac8e785" class="l-page observablehq"><div id="spec-sliders"><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="-7e-18">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="-0.3">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">-0.3</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{3}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="-0.3">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">-0.3</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{4}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="0.6">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.6</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{5}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="-0.7">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">-0.7</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{6}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="0.4">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.4</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{7}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="0.4">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.4</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>8</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{8}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="0.4">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.4</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>9</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{9}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="0.4">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.4</output></div></form><form><div><div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">{\hat{x}_{10}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></div>
	<input name="input" type="range" min="-1" max="1" step="0.1" value="0.7">
  <output name="output" style="font: 14px Menlo, Consolas, monospace; margin-left: 0.5em;">0.7</output></div></form></div></div>
        <div id="observablehq-subgrid_main_div-6ac8e785" class="observablehq"><div id="subgrid-main-div">
    <svg id="subgrid-svg" viewBox="0,0,1072,60" width="1072" height="60"><g class="eigenvectors" transform="translate(32,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(107, 172, 208)"></rect></g></g><g class="eigenvectors" transform="translate(139.2,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(211, 90, 77)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(214, 97, 81)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(217, 104, 85)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(217, 105, 86)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(217, 104, 85)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(215, 101, 84)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(213, 95, 80)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(219, 108, 88)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(221, 113, 92)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(223, 117, 94)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(224, 119, 96)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(224, 120, 97)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(224, 119, 96)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(223, 117, 94)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(221, 113, 92)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(233, 143, 114)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(235, 146, 117)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(236, 149, 120)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 152, 123)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 152, 123)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(236, 148, 119)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(249, 196, 170)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 172)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(249, 199, 175)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(249, 201, 177)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 203, 179)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 203, 180)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 203, 180)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 202, 179)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(190, 219, 234)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(191, 220, 235)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(191, 220, 235)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(190, 219, 234)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(189, 218, 234)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(186, 217, 233)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(184, 216, 233)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(182, 215, 232)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(127, 184, 215)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(130, 186, 216)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(131, 187, 217)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(132, 187, 217)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(130, 186, 216)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(128, 185, 216)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(125, 183, 214)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(121, 180, 213)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(90, 160, 202)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(94, 163, 204)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(96, 164, 204)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(97, 165, 205)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(96, 164, 204)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(93, 162, 203)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(90, 160, 202)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(86, 157, 200)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(74, 148, 196)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(79, 151, 198)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(81, 153, 199)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(82, 154, 199)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(81, 153, 199)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(79, 152, 198)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(76, 149, 196)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(70, 144, 194)"></rect></g></g><g class="eigenvectors" transform="translate(246.4,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(213, 95, 80)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(221, 113, 92)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(236, 148, 119)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(250, 202, 179)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(182, 215, 232)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(121, 180, 213)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(86, 157, 200)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(70, 144, 194)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(215, 101, 84)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(223, 117, 94)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(250, 203, 180)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(184, 216, 233)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(125, 183, 214)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(90, 160, 202)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(76, 149, 196)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(217, 104, 85)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(224, 119, 96)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 152, 123)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(250, 203, 180)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(186, 217, 233)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(128, 185, 216)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(93, 162, 203)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(79, 152, 198)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(217, 105, 86)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(224, 120, 97)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(237, 152, 123)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 203, 179)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(189, 218, 234)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(130, 186, 216)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(96, 164, 204)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(81, 153, 199)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(217, 104, 85)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(224, 119, 96)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(249, 201, 177)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(190, 219, 234)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(132, 187, 217)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(97, 165, 205)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(82, 154, 199)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(223, 117, 94)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(236, 149, 120)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(249, 199, 175)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(191, 220, 235)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(131, 187, 217)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(96, 164, 204)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(81, 153, 199)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(214, 97, 81)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(221, 113, 92)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(235, 146, 117)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 172)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(191, 220, 235)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(130, 186, 216)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(94, 163, 204)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(79, 151, 198)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(211, 90, 77)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(219, 108, 88)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(233, 143, 114)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(249, 196, 170)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(190, 219, 234)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(127, 184, 215)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(90, 160, 202)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(74, 148, 196)"></rect></g></g><g class="eigenvectors" transform="translate(353.6,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(48, 121, 180)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(64, 139, 191)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(102, 168, 206)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(226, 125, 100)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(206, 82, 72)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(192, 56, 58)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(64, 139, 191)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(80, 153, 198)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(119, 179, 212)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(184, 216, 233)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(249, 197, 172)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(233, 141, 113)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(216, 103, 85)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(206, 82, 72)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(102, 168, 206)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(119, 179, 212)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(151, 198, 223)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 188)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(242, 169, 139)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(233, 141, 113)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(226, 125, 100)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(184, 216, 233)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(221, 234, 241)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 227, 214)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 188)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(249, 197, 172)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(249, 197, 172)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 188)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(250, 227, 214)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(221, 234, 241)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(184, 216, 233)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(226, 125, 100)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(233, 141, 113)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(242, 169, 139)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 188)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(151, 198, 223)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(119, 179, 212)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(102, 168, 206)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(206, 82, 72)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(216, 103, 85)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(233, 141, 113)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(249, 197, 172)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(184, 216, 233)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(119, 179, 212)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(80, 153, 198)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(64, 139, 191)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(192, 56, 58)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(206, 82, 72)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(226, 125, 100)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(102, 168, 206)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(64, 139, 191)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(48, 121, 180)"></rect></g></g><g class="eigenvectors" transform="translate(460.8,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(179, 40, 50)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(179, 40, 50)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(142, 193, 220)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(142, 193, 220)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(75, 148, 196)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(75, 148, 196)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(75, 148, 196)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(75, 148, 196)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(142, 193, 220)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(100, 167, 206)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(142, 193, 220)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(145, 195, 221)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(222, 235, 242)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(237, 151, 122)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(179, 40, 50)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(249, 198, 174)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(216, 101, 84)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(179, 40, 50)"></rect></g></g><g class="eigenvectors" transform="translate(568,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(164, 206, 227)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(84, 155, 200)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(53, 126, 184)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(53, 126, 184)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(84, 155, 200)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(164, 206, 227)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(245, 180, 152)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(133, 188, 217)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(85, 156, 200)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(85, 156, 200)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(133, 188, 217)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(245, 180, 152)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(218, 106, 87)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 124)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 124)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(218, 106, 87)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(197, 64, 62)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(219, 108, 88)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 146)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 146)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(219, 108, 88)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(197, 64, 62)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(197, 64, 62)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(219, 108, 88)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 146)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 146)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(219, 108, 88)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(197, 64, 62)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(218, 106, 87)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 124)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 124)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(218, 106, 87)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(245, 180, 152)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(133, 188, 217)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(85, 156, 200)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(85, 156, 200)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(133, 188, 217)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(245, 180, 152)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(164, 206, 227)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(84, 155, 200)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(53, 126, 184)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(53, 126, 184)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(84, 155, 200)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(164, 206, 227)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 238)"></rect></g></g><g class="eigenvectors" transform="translate(675.2,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(43, 114, 175)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(77, 150, 197)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(138, 191, 219)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(215, 232, 241)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(247, 188, 161)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(235, 146, 117)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(218, 107, 88)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(197, 64, 62)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(122, 182, 214)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(153, 199, 223)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(194, 221, 236)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(248, 234, 227)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 190)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(248, 195, 169)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(245, 178, 149)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(241, 163, 133)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(235, 146, 118)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(241, 163, 133)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(246, 182, 154)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(250, 208, 187)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(219, 234, 241)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(174, 211, 230)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(140, 192, 219)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(114, 176, 211)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(195, 61, 61)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(212, 94, 79)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(231, 138, 110)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(248, 195, 169)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(187, 218, 233)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(117, 178, 212)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(73, 146, 195)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(50, 123, 182)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(194, 59, 60)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(212, 93, 79)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(232, 139, 112)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(181, 214, 232)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(115, 177, 211)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(74, 147, 195)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(51, 125, 183)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 109)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(239, 159, 130)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(247, 189, 161)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(250, 226, 212)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(166, 207, 228)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(144, 194, 221)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(125, 183, 215)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(143, 194, 221)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(162, 204, 226)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(181, 215, 232)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(200, 224, 237)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(231, 238, 242)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(250, 206, 184)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(243, 171, 141)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(234, 144, 116)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(53, 126, 184)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(84, 156, 200)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(124, 183, 214)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(173, 210, 230)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(250, 223, 208)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(239, 157, 128)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(215, 99, 82)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(185, 47, 54)"></rect></g></g><g class="eigenvectors" transform="translate(782.4,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(197, 64, 62)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(241, 163, 133)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(114, 176, 211)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(50, 123, 182)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(51, 125, 183)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(125, 183, 215)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(234, 144, 116)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(185, 47, 54)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(218, 107, 88)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(245, 178, 149)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(140, 192, 219)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(73, 146, 195)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(74, 147, 195)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(144, 194, 221)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(243, 171, 141)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(215, 99, 82)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(235, 146, 117)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(248, 195, 169)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(174, 211, 230)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(117, 178, 212)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(115, 177, 211)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(166, 207, 228)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(250, 206, 184)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(239, 157, 128)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(247, 188, 161)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 190)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(219, 234, 241)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(187, 218, 233)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(181, 214, 232)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(231, 238, 242)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(250, 223, 208)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(215, 232, 241)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(248, 234, 227)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(250, 208, 187)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(248, 195, 169)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(250, 226, 212)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(200, 224, 237)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(173, 210, 230)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(138, 191, 219)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(194, 221, 236)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(246, 182, 154)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(231, 138, 110)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(232, 139, 112)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(247, 189, 161)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(181, 215, 232)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(124, 183, 214)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(77, 150, 197)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(153, 199, 223)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(241, 163, 133)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(212, 94, 79)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(212, 93, 79)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(239, 159, 130)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(162, 204, 226)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(84, 156, 200)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(43, 114, 175)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(122, 182, 214)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(235, 146, 118)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(195, 61, 61)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(194, 59, 60)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 109)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(143, 194, 221)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(53, 126, 184)"></rect></g></g><g class="eigenvectors" transform="translate(889.6,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(72, 146, 195)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(72, 146, 195)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 237)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 237)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(160, 203, 226)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(160, 203, 226)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(49, 122, 181)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(49, 122, 181)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(49, 122, 181)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(49, 122, 181)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(160, 203, 226)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(105, 170, 208)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(160, 203, 226)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 237)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(246, 183, 155)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(249, 200, 175)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(242, 239, 237)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(72, 146, 195)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(208, 84, 73)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(231, 137, 110)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(197, 223, 236)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(72, 146, 195)"></rect></g></g><g class="eigenvectors" transform="translate(996.8000000000001,10)"><g class="img-rows"><rect stroke="silver" x="0" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(159, 23, 42)"></rect><rect stroke="silver" x="6" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 189)"></rect><rect stroke="silver" x="12" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(88, 158, 201)"></rect><rect stroke="silver" x="18" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(132, 187, 217)"></rect><rect stroke="silver" x="24" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 123)"></rect><rect stroke="silver" x="30" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(220, 111, 90)"></rect><rect stroke="silver" x="36" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="42" y="0" width="6" height="6" stroke-width="0.5" fill="rgb(28, 90, 152)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 189)"></rect><rect stroke="silver" x="6" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="12" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(108, 172, 209)"></rect><rect stroke="silver" x="18" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="24" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 145)"></rect><rect stroke="silver" x="30" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(229, 131, 105)"></rect><rect stroke="silver" x="36" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(247, 185, 157)"></rect><rect stroke="silver" x="42" y="6" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(88, 158, 201)"></rect><rect stroke="silver" x="6" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(108, 172, 209)"></rect><rect stroke="silver" x="12" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(120, 180, 213)"></rect><rect stroke="silver" x="18" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="24" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="30" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(233, 142, 114)"></rect><rect stroke="silver" x="36" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(229, 131, 105)"></rect><rect stroke="silver" x="42" y="12" width="6" height="6" stroke-width="0.5" fill="rgb(220, 111, 90)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(132, 187, 217)"></rect><rect stroke="silver" x="6" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="12" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="18" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(207, 228, 239)"></rect><rect stroke="silver" x="24" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(251, 217, 198)"></rect><rect stroke="silver" x="30" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="36" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 145)"></rect><rect stroke="silver" x="42" y="18" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 123)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 123)"></rect><rect stroke="silver" x="6" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 145)"></rect><rect stroke="silver" x="12" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="18" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(251, 217, 198)"></rect><rect stroke="silver" x="24" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(207, 228, 239)"></rect><rect stroke="silver" x="30" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="36" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="42" y="24" width="6" height="6" stroke-width="0.5" fill="rgb(132, 187, 217)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(220, 111, 90)"></rect><rect stroke="silver" x="6" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(229, 131, 105)"></rect><rect stroke="silver" x="12" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(233, 142, 114)"></rect><rect stroke="silver" x="18" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(248, 190, 163)"></rect><rect stroke="silver" x="24" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(175, 212, 230)"></rect><rect stroke="silver" x="30" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(120, 180, 213)"></rect><rect stroke="silver" x="36" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(108, 172, 209)"></rect><rect stroke="silver" x="42" y="30" width="6" height="6" stroke-width="0.5" fill="rgb(88, 158, 201)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="6" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(247, 185, 157)"></rect><rect stroke="silver" x="12" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(229, 131, 105)"></rect><rect stroke="silver" x="18" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(244, 175, 145)"></rect><rect stroke="silver" x="24" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(158, 202, 225)"></rect><rect stroke="silver" x="30" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(108, 172, 209)"></rect><rect stroke="silver" x="36" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(170, 209, 229)"></rect><rect stroke="silver" x="42" y="36" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 189)"></rect></g><g class="img-rows"><rect stroke="silver" x="0" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(28, 90, 152)"></rect><rect stroke="silver" x="6" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(199, 224, 237)"></rect><rect stroke="silver" x="12" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(220, 111, 90)"></rect><rect stroke="silver" x="18" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(237, 153, 123)"></rect><rect stroke="silver" x="24" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(132, 187, 217)"></rect><rect stroke="silver" x="30" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(88, 158, 201)"></rect><rect stroke="silver" x="36" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(250, 210, 189)"></rect><rect stroke="silver" x="42" y="42" width="6" height="6" stroke-width="0.5" fill="rgb(159, 23, 42)"></rect></g></g></svg>
  </div></div>
        <div id="observablehq-spec_conv_buttons_display-6ac8e785" style="margin-top: 2em; margin-bottom: 1em;" class="observablehq"><span><style>
      #button-container {
        text-align: center;
      }
    </style>

    <div id="button-container">
      <button>Reset Coefficients</button>
    </div></span></div>
        <div id="observablehq-spec_input_slider_watch-6ac8e785" style="display: none;" class="observablehq"><span class="observablehq--inspect"><span class="observablehq--cellname">spec_input_slider_watch = </span><span class="observablehq--undefined">undefined</span></span></div>
        <!-- <p>Credit: <a href="https://observablehq.com/@ameyasd/interactive-spectral-conversions">Interactive Spectral Conversions by Ameya Daigavane</a></p> -->

      </div>
      <script type="module">
        import {Runtime, Inspector} from "./observablehq-base/runtime.js"; 
        import define from "./notebooks/interactive-spectral-conversions.js";
        setTimeout(() => {
          new Runtime().module(define, name => {
            if (name === "figcaptions") return new Inspector(document.querySelector("#observablehq-figcaptions-6ac8e785"));
            if (name === "spec_conv_main_div") return new Inspector(document.querySelector("#observablehq-spec_conv_main_div-6ac8e785"));
            if (name === "spec_color_scale") return new Inspector(document.querySelector("#observablehq-spec_color_scale-6ac8e785"));
            if (name === "subgrid_main_div") return new Inspector(document.querySelector("#observablehq-subgrid_main_div-6ac8e785"));
            if (name === "spec_conv_sliders") return new Inspector(document.querySelector("#observablehq-spec_conv_sliders-6ac8e785"));
            if (name === "spec_conv_buttons_display") return new Inspector(document.querySelector("#observablehq-spec_conv_buttons_display-6ac8e785"));
            if (name === "spec_input_slider_watch") return new Inspector(document.querySelector("#observablehq-spec_input_slider_watch-6ac8e785"));
            return ["svg","draw_img","draw_static_graph","draw_dyn_graph","draw_eigenvectors"].includes(name);
          });
        }, 200);
      </script>
      <figure>
        <figcaption>
          Move the sliders to change the spectral representation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span> (right),
          and see how <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span> itself changes on the image (left).
          Note how the first eigenvectors are much ‘smoother’ than the later ones,
          and the many patterns we can make with only <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span></span> eigenvectors.
        </figcaption>
      </figure>

      <p>
        These visualizations should convince you that the first eigenvectors are indeed smooth,
        and the smoothness correspondingly decreases as we consider later eigenvectors.
      </p>
      <p>
        For any image <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">x</span></span></span></span></span>, we can think of
        the initial entries of the spectral representation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span></span></span>
        as capturing ‘global’ image-wide trends, which are the low-frequency components,
        while the later entries as capturing ‘local’ details, which are the high-frequency components.
      </p>

      <h3>Embedding Computation</h3>
      <p>
        We now have the background to understand spectral convolutions
        and how they can be used to compute embeddings/feature representations of nodes.
      </p>
      <p>
        As before, the model we describe below has <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span></span> layers:
        each layer <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span></span> has learnable parameters <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mrow><mi>w</mi></mrow><mo>^</mo></mover><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{w}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.16668em;"><span>^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>,
        called the ‘filter weights’.
        These weights will be convolved with the spectral representations of the node features.
        As a result, the number of weights needed in each layer is equal to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">m</span></span></span></span></span>, the number of 
        eigenvectors used to compute the spectral representations.
        We had shown in the previous section that we can take <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>≪</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \ll n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit">m</span><span class="mrel">≪</span><span class="mord mathit">n</span></span></span></span></span>
        and still not lose out on significant amounts of information.
      </p>
      <p>
        Thus, convolution in the spectral domain enables the use of significantly fewer parameters
        than just direct convolution in the natural domain.
        Further, by virtue of the smoothness of the Laplacian eigenvectors across the graph,
        using spectral representations automatically enforces an inductive bias for
        neighbouring nodes to get similar representations.
      </p>
      <p>
        Assuming one-dimensional node features for now,
        the output of each layer is a vector of node representations <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">h^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>,
        where each node’s representation corresponds to a row
        of the vector.
      </p>
      <div class="spec_figure_init" role="img" aria-label="Equations defining spectral convolutions."><div class="observablehq"><figure id="spectral-conv-init">
   <div style="position:relative; left:0px; top:-10px">
    <span style="position: absolute; left:0px; top:0px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>h</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace width="0em" height="1.5em" mathbackground="black"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>h</mi><mi>n</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
      \quad h^{(k)} = \begin{bmatrix} h_1^{(k)} \\ \vdots \\ h_n^{(k)} \end{bmatrix}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.938em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.80303em; vertical-align: -2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.653em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.79999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.39599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -3.41198em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎢</span></span></span><span class="" style="top: -4.653em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.5848em;"><span class="" style="top: -5.2275em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.43369em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.3675em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width: 0em; border-top-width: 1.5em; bottom: 0em;"></span></span></span></span><span class="" style="top: -1.9627em;"><span class="pstrut" style="height: 3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.58341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.116592em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.0848em;"><span class=""></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.653em;"><span class="" style="top: -1.64999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.79999em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.39599em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -3.41198em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎥</span></span></span><span class="" style="top: -4.653em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15003em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
    </span>

    <figcaption style="position: absolute; left:200px; top:60px; width:500px;">
      for each <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 0, 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>.
    </figcaption>
  </div>
</figure></div></div>
      <p>
        We fix an ordering of the nodes in <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span>. This gives us the adjacency matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">A</span></span></span></span></span> and the graph Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>,
        allowing us to compute <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">U_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>.
        Finally, we can describe the computation that the layers perform, one after the other:
      </p>
      <div class="spec_figure"><div class="observablehq"><figure id="spectral-conv">
 
  <div style="position:relative; left:0px; top:0px">
  <figcaption style="position:absolute; left:0px; top:0px; width:200px;">
    Start with the original features.
  </figcaption>

  <span style="position:absolute; left:0px; top:20px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\quad {\color{#FE6100}  h^{(0)}} = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.938em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span class="mord mtight" style="color: rgb(254, 97, 0);">0</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>
  </span>
  </div>
  
  <div style="position:relative; left:0px; top:-45px">
  <figcaption style="position:absolute; left:0px; top:130px">
    Then iterate, for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k = 1, 2, \ldots </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span> upto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex"> K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.07153em;" class="mord mathdefault">K</span></span></span></span>:
  </figcaption>
  
  <span style="position:absolute; left:0px; top:160px">
    <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mover accent="true"><mi>h</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>U</mi><mi>m</mi><mi>T</mi></msubsup><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mover accent="true"><mi>g</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mstyle mathcolor="#4D9DB5"><msup><mover accent="true"><mi>w</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle><mo>⊙</mo><mstyle mathcolor="#FE6100"><msup><mover accent="true"><mi>h</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>U</mi><mi>m</mi></msub><msup><mover accent="true"><mi>g</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
      \begin{aligned}
        {\hat{h}^{(k - 1)}} &amp;= U_m^T {\color{#FE6100}  h^{(k - 1)}} \\
        \\
        {\hat{g}^{(k)}} &amp;=
            {\color{#4D9DB5}  \hat{w}^{(k)}} \odot {\color{#FE6100}  \hat{h}^{(k - 1)}} \\
        \\
        {g^{(k)}} &amp;= U_m {\hat{g}^{(k)}} \\
        \\
        {\color{#FE6100}  h^{(k)}} &amp;= \sigma \left({g^{(k)}} \right)
      \end{aligned}
    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 11.4338em; vertical-align: -5.46689em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.96689em;"><span class="" style="top: -8.15901em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.95788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">h</span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -6.65901em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -5.04113em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.54113em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: -1.94313em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.44313em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span><span class="" style="top: 1.36687em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.46689em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.96689em;"><span class="" style="top: -8.15901em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.04113em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord accent" style="color: rgb(77, 157, 181);"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.02691em; color: rgb(77, 157, 181);" class="mord mathdefault">w</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;"><span style="color: rgb(77, 157, 181);">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord accent" style="color: rgb(254, 97, 0);"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.95788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span style="color: rgb(254, 97, 0);">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.94313em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathdefault">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 1.36687em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.46689em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>
  </span>

  <figcaption style="position:absolute; left:300px; top:182px; width: 500px; ">
    Convert previous feature <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  h^{(k - 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mbin mtight" style="color: rgb(254, 97, 0);">−</span><span class="mord mtight" style="color: rgb(254, 97, 0);">1</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span> to its spectral representation <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>h</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{h}^{(k - 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.95788em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.95788em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">h</span></span></span><span class="" style="top: -3.26344em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:300px; top:238px; width: 500px; ">
    Convolve with filter weights <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#4D9DB5"><msup><mover accent="true"><mi>w</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">{\color{#4D9DB5}  \hat{w}^{(k)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord" style="color: rgb(77, 157, 181);"><span class="mord accent" style="color: rgb(77, 157, 181);"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: rgb(77, 157, 181);"><span style="margin-right: 0.02691em; color: rgb(77, 157, 181);" class="mord mathdefault">w</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.16666em;"><span style="color: rgb(77, 157, 181);">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(77, 157, 181);"><span class="mord mtight" style="color: rgb(77, 157, 181);"><span class="mopen mtight" style="color: rgb(77, 157, 181);">(</span><span style="margin-right: 0.03148em; color: rgb(77, 157, 181);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(77, 157, 181);">)</span></span></span></span></span></span></span></span></span></span></span></span></span> in the spectral domain to get <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>g</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">{\hat{g}^{(k)}}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span>
  </figcaption>

  <figcaption style="position:absolute; left:300px; top:258px; width: 500px; ">
    <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">⊙</span></span></span></span> represents element-wise multiplication.
  </figcaption>
  
  <figcaption style="position:absolute; left:300px; top:310px; width: 505px; ">
    Convert <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>g</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{g}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> back to its natural representation <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">{g}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>.
  </figcaption>

  <figcaption style="position:absolute; left:300px; top:380px; width: 500px; ">
    Apply a non-linearity <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">{g}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> to get <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="#FE6100"><msup><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\color{#FE6100}  {h}^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord" style="color: rgb(254, 97, 0);"><span class="mord mathdefault" style="color: rgb(254, 97, 0);">h</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: rgb(254, 97, 0);"><span class="mord mtight" style="color: rgb(254, 97, 0);"><span class="mopen mtight" style="color: rgb(254, 97, 0);">(</span><span style="margin-right: 0.03148em; color: rgb(254, 97, 0);" class="mord mathdefault mtight">k</span><span class="mclose mtight" style="color: rgb(254, 97, 0);">)</span></span></span></span></span></span></span></span></span></span></span></span>.
  </figcaption>
  
  <figcaption style="position:absolute; left:380px; top:45px; width:350px;">
    Color Codes:
    <ul class="legend">
        <li><span class="box main"></span> Computed node embeddings. </li>
        <li><span class="box param"></span> Learnable parameters. </li>
    </ul>
  </figcaption>
 
  </div>
</figure></div></div>
      <div class="spec_figure_style"><div class="observablehq"><style>
  #spectral-conv div {
    margin: 0 auto 10px auto;
    display: block;
  }
  
  #spectral-conv {
    width: 800px;
    height: 380px;
    display: block;
    margin-top: 0;
    margin-bottom: 0;
    margin-left: auto;
    margin-right: auto;
    position: relative;
  }
  
  #spectral-conv-init {
    width: 800px;
    height: 100px;
    display: block;
    margin-top: 0;
    margin-left: auto;
    margin-right: auto;
    position: relative;
  }
  
  span.green {
    color: #177245;
  }

  span.blue {
    color: #0047AB;
  }

  /* Legend */
  .legend {
    list-style: none;
    margin-top: 5px;
  }
  .legend li {
    margin-bottom: 5px;
  }
  .legend span.box {
    border: 1px solid #ccc;
    float: left;
    width: 12px;
    height: 12px;
    margin: 2px;
    margin-right: 5px;
  }

  .legend .main { background-color: #FE6100; }
  .legend .param { background-color: #4D9DB5; }

 </style></div></div>

      <script type="module">
      import {Runtime, Inspector} from "./observablehq-base/runtime.js";    
      import define from "./notebooks/spectral-convolutions-equation.js";
      setTimeout(() => {
        new Runtime().module(define, name => {
          if (name === "spec_figure_init") return Inspector.into(".spec_figure_init")();
          if (name === "spec_figure") return Inspector.into(".spec_figure")();
          if (name === "style") return Inspector.into(".spec_figure_style")();
        });
      }, 200);
      </script>
      <p>
        The method above generalizes easily to the case where each <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>d</mi><mi>k</mi></msub></msup></mrow><annotation encoding="application/x-tex">h^{(k)} \in \mathbb{R}^{d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.9270999999999999em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mrel">∈</span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>, as well:
        see <d-cite key="spectral-networks"></d-cite> for details.
      </p>
      <p>
        With the insights from the previous section, we see that convolution in the spectral-domain of graphs
        can be thought of as the generalization of convolution in the frequency-domain of images.
      </p>

      <h3 id="spectral-equivariance">
        Spectral Convolutions are Node-Order Equivariant
      </h3>
      <p>
        We can show spectral convolutions are node-order equivariant using a similar approach
        as for Laplacian polynomial filters. 
      </p>
      <div class="math-details shaded-figure">
        <b>
          Details for the Interested Reader
        </b>
        <p>
          As in <a href="#poly-filters-equivariance">our proof before</a>,
          let’s fix an arbitrary node-order.
          Then, any other node-order can be represented by a
          permutation of this original node-order.
          We can associate this permutation with its permutation matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span></span></span></span>.

          Under this new node-order,
          the quantities below transform in the following way:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><mi>A</mi><msup><mi>P</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>L</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><mi>L</mi><msup><mi>P</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>U</mi><mi>m</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mi>P</mi><msub><mi>U</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
            \begin{aligned}
              x &amp;\to Px \\
              A &amp;\to PAP^T \\
              L &amp;\to PLP^T \\
              U_m &amp;\to PU_m
            \end{aligned}
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.3013310000000002em;"></span><span class="strut bottom" style="height:6.1026620000000005em;vertical-align:-2.8013310000000007em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3013310000000002em;"><span style="top:-5.461331em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">A</span></span></span><span style="top:-2.358669em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">L</span></span></span><span style="top:-0.8586689999999995em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8013310000000007em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3013310000000002em;"><span style="top:-5.461331em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">A</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-2.358669em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">L</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-0.8586689999999995em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8013310000000007em;"></span></span></span></span></span></span></span></span></span></span></span>
          which implies that, in the embedding computation:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><msup><mrow><mo fence="true">(</mo><mi>P</mi><msub><mi>U</mi><mi>m</mi></msub><mo fence="true">)</mo></mrow><mi>T</mi></msup><mo>(</mo><mi>P</mi><mi>x</mi><mo>)</mo><mo>=</mo><msubsup><mi>U</mi><mi>m</mi><mi>T</mi></msubsup><mi>x</mi><mo>=</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mrow><mi>w</mi></mrow><mo>^</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><msup><mrow><mo fence="true">(</mo><mi>P</mi><msub><mi>U</mi><mi>m</mi></msub><mo fence="true">)</mo></mrow><mi>T</mi></msup><mo>(</mo><mi>P</mi><mi>w</mi><mo>)</mo><mo>=</mo><msubsup><mi>U</mi><mi>m</mi><mi>T</mi></msubsup><mi>w</mi><mo>=</mo><mover accent="true"><mrow><mi>w</mi></mrow><mo>^</mo></mover></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mrow><mi>g</mi></mrow><mo>^</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mover accent="true"><mrow><mi>g</mi></mrow><mo>^</mo></mover></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>g</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>→</mo><mo>(</mo><mi>P</mi><msub><mi>U</mi><mi>m</mi></msub><mo>)</mo><mover accent="true"><mrow><mi>g</mi></mrow><mo>^</mo></mover><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>U</mi><mi>m</mi></msub><mover accent="true"><mrow><mi>g</mi></mrow><mo>^</mo></mover><mo>)</mo><mo>=</mo><mi>P</mi><mi>g</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
            \begin{aligned}
              \hat{x} &amp;\to \left(PU_m\right)^T (Px) = U_m^T x = \hat{x} \\
              \hat{w} &amp;\to \left(PU_m\right)^T (Pw) = U_m^T w = \hat{w} \\
              \hat{g} &amp;\to \hat{g} \\
              g &amp;\to (PU_m)\hat{g} = P(U_m\hat{g}) = Pg
            \end{aligned}
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.3912310000000003em;"></span><span class="strut bottom" style="height:6.282462em;vertical-align:-2.8912309999999994em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3912310000000003em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span><span style="top:-3.7687690000000007em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.16668em;"><span>^</span></span></span></span></span></span></span></span></span><span style="top:-2.2687690000000007em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span></span></span><span style="top:-0.7687690000000007em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8912309999999994em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3912310000000003em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span></span></span><span style="top:-3.7687690000000007em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mrel">=</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.16668em;"><span>^</span></span></span></span></span></span></span></span></span><span style="top:-2.2687690000000007em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span></span></span><span style="top:-0.7687690000000007em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">→</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8912309999999994em;"></span></span></span></span></span></span></span></span></span></span></span>
          Hence, as <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">σ</span></span></span></span></span> is applied elementwise:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>P</mi><mi>x</mi><mo>)</mo><mo>=</mo><mi>σ</mi><mo>(</mo><mi>P</mi><mi>g</mi><mo>)</mo><mo>=</mo><mi>P</mi><mi>σ</mi><mo>(</mo><mi>g</mi><mo>)</mo><mo>=</mo><mi>P</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">
            f(Px) = \sigma(Pg) = P \sigma(g) = P f(x)
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></span>
          as required.
          Further, we see that the spectral quantities <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo>^</mo></mover><mo separator="true">,</mo><mover accent="true"><mrow><mi>w</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}, \hat{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.16668em;"><span>^</span></span></span></span></span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>g</mi></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0.05556em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span></span></span></span></span>
          are unchanged by permutations of the nodes.
          <d-footnote>
          Formally, they are what we would call node-order invariant.
          </d-footnote>
        </p>
      </div>

      <p>
        The theory of spectral convolutions is mathematically well-grounded;
        however, there are some key disadvantages that we must talk about:
      </p>
      <ul>
        <li>
          We need to compute the eigenvector matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">U_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>. For large graphs, this becomes quite infeasible.
        </li>
        <li>
          Even if we can compute <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">U_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>, global convolutions themselves are inefficient to compute,
          because of the repeated
          multiplications with <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">U_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>U</mi><mi>m</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">U_m^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span></span></span></span></span>.
        </li>
        <li>
          The learned filters are specific to the input graphs,
          as they are represented in terms
          of the spectral decomposition of input graph Laplacian <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">L</span></span></span></span></span>.
          This means they do not transfer well to new graphs
          which have significantly different structure (and hence, significantly
          different eigenvalues) <d-cite key="spectral-transfer"></d-cite>.
        </li>
      </ul>

      <p>
        While spectral convolutions have largely been superseded by
        ‘local’ convolutions for the reasons discussed above,
        there is still much merit to understanding the ideas behind them.
        Indeed, a recently proposed GNN model called Directional Graph Networks
        <d-cite key="directional-gnns"></d-cite>
        actually uses the Laplacian eigenvectors
        and their mathematical properties
        extensively.
      </p>

      <h3 id="graph-embeddings">
        Global Propagation via Graph Embeddings
      </h3>
      <p>
        A simpler way to incorporate graph-level information
        is to compute embeddings of the entire graph by pooling node
        (and possibly edge) embeddings,
        and then using the graph embedding to update node embeddings,
        following an iterative scheme similar to what we have looked at here.
        This is an approach used by Graph Networks
        <d-cite key="graphnets"></d-cite>.
        We will briefly discuss how graph-level embeddings
        can be constructed in <a href="#pooling">Pooling</a>.
        However, such approaches tend to ignore the underlying
        topology of the graph that spectral convolutions can capture.
      </p>

    <h2 id="learning">
      Learning GNN Parameters
    </h2>
      <p>
        All of the embedding computations we’ve described here, whether spectral or spatial, are completely differentiable.
        This allows GNNs to be trained in an end-to-end fashion, just like a standard neural network,
        once a suitable loss function <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathcal">L</span></span></span></span></span></span> is defined:
      </p>
        <ul>
          <li>
            <b>Node Classification</b>: By minimizing any of the standard losses for classification tasks,
            such as categorical cross-entropy when multiple classes are present:
            <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><msub><mi>y</mi><mi>v</mi></msub><mo separator="true">,</mo><mover accent="true"><mrow><msub><mi>y</mi><mi>v</mi></msub></mrow><mo>^</mo></mover><mo>)</mo><mo>=</mo><mo>−</mo><msub><mo>∑</mo><mi>c</mi></msub><msub><mi>y</mi><mrow><mi>v</mi><mi>c</mi></mrow></msub><mi>log</mi><mrow><mover accent="true"><mrow><msub><mi>y</mi><mrow><mi>v</mi><mi>c</mi></mrow></msub></mrow><mo>^</mo></mover></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
              \mathcal{L}(y_v, \hat{y_v}) = -\sum_{c} y_{vc} \log{\hat{y_{vc}}}.
            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.3000100000000003em;vertical-align:-1.250005em;"></span><span class="base"><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
            where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><msub><mi>y</mi><mrow><mi>v</mi><mi>c</mi></mrow></msub></mrow><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y_{vc}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span></span></span></span></span> is the predicted probability that node <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> is in class <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">c</span></span></span></span></span>.
            GNNs adapt well to the semi-supervised setting, which is when only some nodes in the graph are labelled.
            In this setting, one way to define a loss <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span> over an input graph <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> is:
            <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>G</mi></msub><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mrow><mi>v</mi><mo>∈</mo><mtext>Lab</mtext><mo>(</mo><mi>G</mi><mo>)</mo></mrow></msub><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><msub><mi>y</mi><mi>v</mi></msub><mo separator="true">,</mo><mover accent="true"><mrow><msub><mi>y</mi><mi>v</mi></msub></mrow><mo>^</mo></mover><mo>)</mo></mrow><mrow><mi mathvariant="normal">∣</mi><mtext>Lab</mtext><mo>(</mo><mi>G</mi><mo>)</mo><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
              \mathcal{L}_{G} = \frac{\sum\limits_{v \in \text{Lab}(G)} \mathcal{L}(y_v, \hat{y_v})}{| \text{Lab}(G) |}
            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3560100000000004em;"></span><span class="strut bottom" style="height:3.2920100000000003em;vertical-align:-0.936em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3560100000000004em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">∣</span><span class="mord text"><span class="mord mathrm">Lab</span></span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mclose">)</span><span class="mord mathrm">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.606005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7500050000000001em;"><span style="top:-2.058995em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord text mtight"><span class="mord mathrm mtight">Lab</span></span><span class="mopen mtight">(</span><span class="mord mathit mtight">G</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.216005em;"></span></span></span></span><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="margin-left:0em;"><span>^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
            where, we only compute losses over labelled nodes <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>Lab</mtext><mo>(</mo><mi>G</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\text{Lab}(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord text"><span class="mord mathrm">Lab</span></span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mclose">)</span></span></span></span></span>.
          </li>
          <li>
            <b>Graph Classification</b>: By aggregating node representations,
            one can construct a vector representation of the entire graph.
            This graph representation can be used for any graph-level task, even beyond classification.
            See <a href="#pooling">Pooling</a> for how representations of graphs can be constructed.
          </li>
          <li>
            <b>Link Prediction</b>: By sampling pairs of adjacent and non-adjacent nodes,
            and use these vector pairs as inputs to predict the presence/absence of an edge.
            For a concrete example, by minimizing the following ‘logistic regression’-like loss:
            <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow><mo>(</mo><msub><mi>y</mi><mi>v</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>u</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi>e</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mi>log</mi><mo>(</mo><msub><mi>p</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>)</mo><mo>−</mo><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>e</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>)</mo><mi>log</mi><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>p</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>σ</mi><mo>(</mo><msubsup><mi>y</mi><mi>v</mi><mi>T</mi></msubsup><msub><mi>y</mi><mi>u</mi></msub><mo>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
              \begin{aligned}
              \mathcal{L}(y_v, y_u, e_{vu}) &amp;= -e_{vu} \log(p_{vu}) - (1 - e_{vu}) \log(1 - p_{vu}) \\
              p_{vu} &amp;= \sigma(y_v^Ty_u)
              \end{aligned}
            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.7756655000000001em;"></span><span class="strut bottom" style="height:3.0513310000000002em;vertical-align:-1.2756655000000001em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7756655000000001em;"><span style="top:-3.9356655em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.3843345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2756655000000001em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7756655000000001em;"><span style="top:-3.9356655em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord">−</span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mbin">−</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.3843345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2756655000000001em;"></span></span></span></span></span></span></span></span></span></span></span>
            where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">σ</span></span></span></span></span> is the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid function</a>,
            and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><mi>v</mi><mi>u</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e_{vu} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span> iff there is an edge between nodes <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">u</span></span></span></span></span>, being <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord mathrm">0</span></span></span></span></span> otherwise.
          </li>
          <li>
            <b>Node Clustering</b>: By simply clustering the learned node representations.
          </li>
        </ul>

      <p>
        The broad success of pre-training for natural language processing models
        such as ELMo <d-cite key="elmo"></d-cite> and BERT <d-cite key="bert"></d-cite>
        has sparked interest in similar techniques for GNNs
        <d-cite key="strategies-pre-training,m3s,when-does-self-help,self-supervised-graphs-insights"></d-cite>.
        The key idea in each of these papers is to train GNNs to predict
        local (eg. node degrees, clustering coefficient, masked node attributes)
        and/or global graph properties (eg. pairwise distances, masked global attributes).
      </p>
      <p>
        Another self-supervised technique is to enforce that neighbouring nodes get similar embeddings,
        mimicking random-walk approaches such as node2vec <d-cite key="node2vec"></d-cite> and DeepWalk <d-cite key="deepwalk"></d-cite>:
      </p>
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>G</mi></msub><mo>=</mo><msub><mo>∑</mo><mi>v</mi></msub><msub><mo>∑</mo><mrow><mi>u</mi><mo>∈</mo><msub><mi>N</mi><mi>R</mi></msub><mo>(</mo><mi>v</mi><mo>)</mo></mrow></msub><mi>log</mi><mfrac><mrow><mi>exp</mi><mrow><msubsup><mi>z</mi><mi>v</mi><mi>T</mi></msubsup><msub><mi>z</mi><mi>u</mi></msub></mrow></mrow><mrow><msub><mo>∑</mo><msup><mi>u</mi><mo mathvariant="normal">′</mo></msup></msub><mi>exp</mi><mrow><msubsup><mi>z</mi><msup><mi>u</mi><mo mathvariant="normal">′</mo></msup><mi>T</mi></msubsup><msub><mi>z</mi><mi>u</mi></msub></mrow></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          L_{G} = \sum_{v} \sum_{u \in N_R(v)} \log\frac{\exp{z_v^T z_u}}{\sum\limits_{u’} \exp{z_{u’}^T z_u}}.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5183309999999999em;"></span><span class="strut bottom" style="height:3.225447em;vertical-align:-1.707116em;"></span><span class="base"><span class="mord"><span class="mord mathit">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"></span></span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.286869em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.750005em;"><span style="top:-2.106015em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.993985em;"></span></span></span></span><span class="mop">exp</span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231310000000001em;"><span style="top:-2.40682em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathrm mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29317999999999994em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.707116em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
      <p>
        where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mi>R</mi></msub><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">N_R(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span> is a multi-set of nodes visited when random walks are started from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span>.
        For large graphs, where computing the sum over all nodes may be computationally expensive,
        techniques such as Noise Contrastive Estimation <d-cite key="nce,nce-embeddings"></d-cite> are especially useful.
      </p>

    <!--
    <h2 id="gnns-vs-cnns">
      Are GNNs 'better' than CNNs?
    </h2>
      <p>
        We've shown how GNNs arose as a generalization of CNNs to arbitrary graphs.
        Given some of the powerful constructions we've explored in this article,
        a valid question to ask is if GNNs represent a more powerful class of models than CNNs.
  
        To enable a comparison, we now consider a problem defined on a fixed-size grid,
        allowing both CNNs and GNNs to be used.
      </p>
    
      <h3 id="game-of-life-problem">
        The Game of Life
      </h3>
      <p>
        Conway's Game of Life <d-cite key="game-of-life"></d-cite> is a simple game played on an infinite grid of cells. (Here, we focus on finite $8 \times 8$ grids.)
        Initially, each cell is either alive or dead.
        At the next step, the grid configuration updates in the following manner:
      </p>
        <ul>
          <li>Alive cells which have fewer than 2 alive neighbours, die by loneliness.</li>
          <li>Alive cells which have greater than 3 alive neighbours, die by overpopulation.</li>
          <li>Dead cells which have exactly 3 alive neighbours, become alive.</li>
          <li>Every other cell maintains its state.</li>
        </ul>
        <figure id="game-of-life-example" class="l-page" style="text-align: center;">
        <img src="images/game-of-life-example.svg" style="width: 80%;"
             alt="A Game of Life grid with an initial configuration, updated to a new configuration. Alive cells are filled in with black. Dead cells are filled in with white.">
        <figcaption>
          A grid with an initial configuration, updated to a new configuration.
          Alive cells are filled in with black. Dead cells are filled in with white.
        </figcaption>
      </figure>
      <p>
        The Game of Life is simple, but research <d-cite key='game-of-life-nns'></d-cite> has shown that neural networks struggle to solve the Game of Life Problem!
      </p>
      <p class="shaded-figure" style="padding-left: 1em;">
        <b>The Game of Life Problem:</b>
        Given a grid with an initial configuration of alive and dead cells, compute the next configuration of the grid, according to the rules of the Game of Life.
      </p>
      <p>
        The Game of Life rules do not vary across the grid:
        this allows both CNNs and GNNs to model the dynamics of the Game of Life, since they share weights across pixels/nodes.
      </p>
      <p>
        In this spirit, <d-cite key='game-of-life-nns'></d-cite> defines a minimal 3-layer CNN model that can solve the Game of Life Problem perfectly.
        However, they find that only CNN models with many more parameters can actually find the optimal solution consistently, when trained with stochastic gradient descent.
      </p>
      <p>
        How would GNNs fare at the Game of Life?
        We mimic <d-cite key='game-of-life-nns'></d-cite>, and create an equivalent minimal 3-layer GCN model
        <d-footnote>
          See <a href="#minimal-models">Appendix: Minimal Models for The Game of Life</a>.
        </d-footnote>
        that can solve the Game of Life Problem perfectly.
      </p>
      <p>
        Note that the rules of the Game of Life treat all neighbours of a cell on an equal footing:
        all that matters is the count of alive neighbours surrounding a cell, not their positions.
        This aligns well with the inductive bias of the GCN models to treat each neighbour equally.
        <d-footnote>
          Indeed, on a grid, the GCN variant here is equivalent to a uniform $3 \times 3$ filter (except for the center pixel which can have a different weight).
        </d-footnote>
        For this reason, we would expect GCN models to perform better than CNN models on this task,
        which would have to learn to weigh neighbours equally.
      </p>
      <p>
        Following <d-cite key='game-of-life-nns'></d-cite>, we vary the number of parameters in each of these models,
        relative to the minimal model for each class. This variation is captured by the overparametrization factor ($m$):
        <d-footnote>
          $m = 1$ recovers the structure of the minimal model. As a function of the overparametrization factor $m$,
          the GCN models have $2m^2 + 9m + 2$ parameters, while the CNN models have $2m^2 + 23m + 2$.
          Thus, the CNN models vary from about $2\times$ (at $m = 1$) to about $1.5\times$ (at $m = 10$) as big as the GCN models,
          in terms of number of parameters.
        </d-footnote>
        <d-footnote>
          The linear layer in the CNNs is implemented as a standard 2D-convolution with filter shape $1 \times 1$.
        </d-footnote>
      </p>
      <figure id="overparametrization-factor" class="l-page" style="text-align: center;">
        <img src="images/overparametrization-factor.svg" style="width: 80%;"
             alt="Architectures for the CNN and GCN models. The CNN has a 3x3 Conv2D + ReLU + Linear + ReLU + Linear structure, while the GCN has a GCNConv + ReLU + Linear + ReLU + Linear structure. Both models output a 2-dimensional vector at each cell indicating their predictions.">
      </figure>
      <p>
        However, our experiments show that CNNs and GCNs perform very similarly on the Game of Life.
        For each value of the overparametrization factor, both models are trained separately until the validation loss doesn't decrease for 300 iterations.
        <d-footnote>
          See <a href="#game-of-life-details">Appendix: The Game of Life Experiment Details</a>.
        </d-footnote>
        The results below are for 40 different random initializations for each model.
      </p>
      <figure id="validation-accuracy-boxplot" class="l-screen" style="margin-top: 0; text-align: center;">
        <img src="images/validation-accuracy-boxplot.svg" style="width: 80%;"
             alt="Distribution of validation accuracies for each trained model as the overparametrization factor is varied. Both GCNs and CNNs do similarly, with increasing performance as the number of parameters increase.">
        <figcaption style="width: 50%; margin-left: 25%; margin-right: 25%;">
          Distribution of validation accuracies for each trained model as the overparametrization factor ($m$) is varied.
          The boxplot bodies extend from the 25th percentile to the 75th percentile accuracies, while the whiskers extend from the 5th percentile to the 95th percentile accuracies.
          The horizontal lines in the middle of the boxplot bodies indicate the median accuracy.
        </figcaption>
      </figure>
      <p>
        Defining a successful model as one that has perfect validation accuracy,
        we find that GCNs and CNNs have similar probabilities of success to learn the Game of Life, increasing with the number
        of parameters in the models.
      </p>
      <figure id="success-probabilities" class="l-page" style="margin-top: 0; text-align: center;">
        <img src="images/success-probabilities.svg" style="width: 100%;"
             alt="Fraction of models that could correctly learn the rules of the Game of Life. Both GCNs and CNNs perform similarly.">
      </figure>
      <p>
        These experiments suggest that the GCN models don't learn the rules of the Game of Life in the form they are given above,
        minimizing the benefits of their inductive bias.
      </p>
      <p>
        To understand what these models have learned, we have created the interactive visualization below!
        See predictions for the worst and best performing models in each class, at overparametrization factors 1, 2, 5 and 10.
      </p>
      <div class="shaded-figure l-screen" style="margin-bottom: 1em; grid-column: page;">
        <div class="game_of_life_buttons_div"></div>
        <div class="inputs"></div>
        <div class="game_of_life_main_div"></div>
        <div class="style"></div>
      </div>
        
      <script type="module">
        import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
        import define from "https://api.observablehq.com/d/5cda95a13cb635cf.js?v=3";
        (new Runtime).module(define, name => {
          if (name === "game_of_life_buttons_div") return Inspector.into(".game_of_life_buttons_div")();
          if (name === "inputs") return Inspector.into(".inputs")();
          if (name === "game_of_life_main_div") return Inspector.into(".game_of_life_main_div")();
          if (name === "style") return Inspector.into(".style")();
          return ["svg","draw_text","draw_separator_lines","draw_inp_img","draw_pred_img_gcn","draw_pred_img_cnn","draw_next_img"].includes(name) || null;
        });
      </script>
      <figure>
        <figcaption style="margin-bottom: 1em;">
          Modify the input grid (left) by clicking on the individual cells to toggle them (black: alive, white: dead), or randomize the entire grid with the 'Randomize Grid' button.
          Clicking the 'Reset' button sets all cells as dead.
        </figcaption>
      </figure>
      <p>
        The visualization above serves as an excellent test for generalizability of these models, beyond the standard validation set metrics.
        On closer observation, we see that:
      </p>
        <ul>
          <li>The best CNN and GCN models at $m = 1$ have nearly identical predictions.</li>
          <li>Although not identical, there are many similarities between the predictions of the worst CNN and GCN models at $m = 5$.</li>
        </ul> -->

    <h2 id="further-reading">
      Conclusion and Further Reading
    </h2>
      
      <p>
        While we have looked at many techniques and ideas in this article,
        the field of Graph Neural Networks is extremely vast.
        We have been forced to restrict our discussion to a small subset of the entire literature,
        while still communicating the key ideas and design principles behind GNNs.
        We recommend the interested reader take a look at
        <d-cite key="gnn-survey,gnn-review"></d-cite> for a more comprehensive survey.
      </p>
      <p>
        We end with pointers and references for additional concepts readers might be interested in:
      </p>

      <h3 id="practical-techniques">
        GNNs in Practice
      </h3>
      <p>
        It turns out that accomodating the different structures of graphs is often hard to do efficiently,
        but we can still represent many GNN update equations using
        as sparse matrix-vector products (since generally, the adjacency matrix is sparse for most real-world graph datasets.)
        For example, the GCN variant discussed here can be represented as:
        <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>h</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mo>=</mo><msup><mi>D</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>A</mi><mo>⋅</mo><msup><mi>h</mi><mrow><mo>(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo>)</mo></mrow></msup><msup><msup><mi>W</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mi>T</mi></msup><mo>+</mo><msup><mi>h</mi><mrow><mo>(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo>)</mo></mrow></msup><msup><msup><mi>B</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup><mi>T</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
          h^{(k)} = D^{-1} A \cdot h^{(k - 1)} {W^{(k)}}^T + h^{(k - 1)} {B^{(k)}}^T.
        </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.169231em;"></span><span class="strut bottom" style="height:1.2525609999999998em;vertical-align:-0.08333em;"></span><span class="base"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathit">A</span><span class="mbin">⋅</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.169231em;"><span style="top:-3.3909000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.169231em;"><span style="top:-3.3909000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathrm">.</span></span></span></span></span></span>
        Restructuring the update equations in this way allows for efficient vectorized implementations of GNNs on accelerators
        such as GPUs.
      </p>
      <p>
        Regularization techniques for standard neural networks,
        such as Dropout <d-cite key="dropout"></d-cite>,
        can be applied in a straightforward manner to the parameters
        (for example, zero out entire rows of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>W</mi><mrow><mo>(</mo><mi>k</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">W^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span> above).
        However, there are graph-specific techniques such as DropEdge <d-cite key="dropedge"></d-cite>
        that removes entire edges at random from the graph,
        that also boost the performance of many GNN models.
      </p>

      <h3 id="different-kinds-of-graphs">
        Different Kinds of Graphs
      </h3>
      <p>
        Here, we have focused on undirected graphs, to avoid going into too many unnecessary details.
        However, there are some simple variants of spatial convolutions for:
      </p>
        <ul>
          <li>Directed graphs: Aggregate across in-neighbourhood and/or out-neighbourhood features. </li>
          <li>Temporal graphs: Aggregate across previous and/or future node features.</li>
          <li>Heterogeneous graphs: Learn different aggregation functions for each node/edge type.</li>
        </ul>
      <p>
        There do exist more sophisticated techniques that can take advantage of the different structures of these graphs:
        see <d-cite key="gnn-survey,gnn-review"></d-cite> for more discussion.
      </p>

      <h3 id="pooling">
        Pooling
      </h3>
        <p>
          This article discusses how GNNs compute useful representations
 of nodes.
          But what if we wanted to compute representations of graphs for
 graph-level tasks (for example, predicting the toxicity of a molecule)?
        </p>
        <p>
          A simple solution is to just aggregate the final node embeddings and pass them through another neural network <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mtext>PREDICT</mtext><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">\text{PREDICT}_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord text"><span class="mord mathrm">PREDICT</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span>:
          <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>G</mi></msub><mo>=</mo><msub><mtext>PREDICT</mtext><mi>G</mi></msub><mo fence="false">(</mo><msub><mtext>AGG</mtext><mrow><mi>v</mi><mo>∈</mo><mi>G</mi></mrow></msub><mrow><mo fence="true">(</mo><mo>{</mo><msub><mi>h</mi><mi>v</mi></msub><mo>}</mo><mo fence="true">)</mo></mrow><mo fence="false">)</mo></mrow><annotation encoding="application/x-tex">
            h_G = \text{PREDICT}_G \Big( \text{AGG}_{v \in G}\left(\{ h_v \} \right) \Big)
          </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.15em;"></span><span class="strut bottom" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="base"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord text"><span class="mord mathrm">PREDICT</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord text"><span class="mord mathrm">AGG</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17737em;"></span></span></span></span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mopen">{</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">}</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span></span></span></span>
          However, there do exist more powerful techniques for ‘pooling’ together node representations:
        </p>
          <ul>
            <li>SortPool<d-cite key="sortpool"></d-cite>: Sort vertices 
of the graph to get a fixed-size node-order invariant representation of 
the graph, and then apply any standard neural network architecture.</li>
            <li>DiffPool<d-cite key="diffpool"></d-cite>: Learn to 
cluster vertices, build a coarser graph over clusters instead of nodes, 
then apply a GNN over the coarser graph. Repeat until only one cluster 
is left. </li>
            <li>SAGPool<d-cite key="sagpool"></d-cite>: Apply a GNN to 
learn node scores, then keep only the nodes with the top scores, 
throwing away the rest. Repeat until only one node is left.</li>
          </ul>
      
    <h2 id="supplementary">
      Supplementary Material
    </h2>
      <h3 id="experiments-notebooks">
        Reproducing Experiments
      </h3>
      <p>
        The experiments from
        <a href="#spectral-decompositions-of-natural-images">Spectral Representations of Natural Images</a>
        can be reproduced using the following
        Colab <img src="Understanding%20Convolutions%20on%20Graphs_files/colab.svg" alt="Google Colaboratory" style="position: relative; top: 2px"> notebook:
        <a href="https://colab.research.google.com/github/google-research/google-research/blob/master/understanding_convolutions_on_graphs/SpectralRepresentations.ipynb">Spectral Representations of Natural Images</a>.
      </p>
<!-- 
      <p>
        The experiments from <a href="#gnns-vs-cnns">Are GNNs 'better' than CNNs?</a> can be reproduced using the following Colab <img src="images/colab.svg" alt="Google Colaboratory" style="position: relative; top: 2px"> notebook:
      </p>
        <ul>
          <li><a href="https://colab.research.google.com/github/google-research/google-research/blob/master/understanding_convolutions_on_graphs/TheGameOfLifeWithGNNs.ipynb">The Game of Life Colab</a></li>
        </ul>
      <p>
        The saved models (in TensorFlow Saved Model format) can be found at the Google Drive <img src="images/google-drive.svg" alt="Google Drive" width="20" height="20" style="position: relative; top: 2px"> folders below.
        <d-footnote>Currently unavailable, pending official data release.</d-footnote>
        These saved models were converted to a TensorFlow.js Graphs Model using the <a href="https://github.com/tensorflow/tfjs/tree/master/tfjs-converter">TensorFlow.js converter script</a>.
      </p>
        <ul>
          <li><a href="">The Game of Life Saved Models </a></li>
          <li><a href="">The Game of Life Saved Models Converted</a></li>
        </ul>
 -->
      <h3 id="visualizations-notebooks">
        Recreating Visualizations
      </h3>
      <p>
        To aid in the creation of future interactive articles,
        we have created ObservableHQ
        <img src="Understanding%20Convolutions%20on%20Graphs_files/observable.svg" alt="ObservableHQ" style="position: relative; top: 3px" width="20" height="20">
        notebooks for each of the interactive visualizations here:
      </p>
        <ul>
          <li><a href="https://observablehq.com/@ameyasd/neighbourhoods-for-cnns-and-gnns">Neighbourhood Definitions for CNNs and GNNs</a></li>
          <li><a href="https://observablehq.com/@ameyasd/cleaner-interactive-graph-polynomial-convolutions">Graph Polynomial Convolutions on a Grid</a></li>
          <li><a href="https://observablehq.com/@ameyasd/updated-chebnet-equations">Graph Polynomial Convolutions: Equations</a></li>
          <li><a href="https://observablehq.com/@ameyasd/interactive-gnn-equations">Modern Graph Neural Networks: Equations</a></li>
          <li>
            <a href="https://observablehq.com/@ameyasd/interactive-gnn-visualizations">Modern Graph Neural Networks: Interactive Models</a>
            which pulls together the following standalone notebooks:
            <ul>
              <li><a href="https://observablehq.com/@ameyasd/graph-convolutional-networks">Graph Convolutional Networks</a></li>
              <li><a href="https://observablehq.com/@ameyasd/graph-attention-networks">Graph Attention Networks</a></li>
              <li><a href="https://observablehq.com/@ameyasd/graph-sample-and-aggregate-graphsage">GraphSAGE</a></li>
              <li><a href="https://observablehq.com/@ameyasd/graph-isomorphism-networks">Graph Isomorphism Networks</a></li>
            </ul>
          </li>
          <li><a href="https://observablehq.com/@ameyasd/interactive-spectral-conversions">Laplacian Eigenvectors for Grids</a></li>
          <li><a href="https://observablehq.com/@ameyasd/spectral-decompositions-of-natural-images">Spectral Decomposition of Natural Images</a></li>
          <li><a href="https://observablehq.com/@ameyasd/spectral-convolutions-equation">Spectral Convolutions: Equations</a></li>
          <!-- <li><a href="https://observablehq.com/@ameyasd/the-game-of-life">The Game of Life</a></li> -->
        </ul>

  </d-article>


  <d-appendix id="appendix">
    
    <d-footnote-list></d-footnote-list>

    <!-- <h3 id="minimal-models">Appendix: Minimal Models for The Game of Life</h3>
    <p>
      We use a variant of the GCN that doesn't normalize by neighbour degrees, and has an additional constant bias term $C$:
      <d-math block>
        h_v' = f\left(W \cdot \sum_{u \in \mathcal{N}(v)} h_u + B \cdot h_v + C \right).
      </d-math>
      This variant can capture the optimal update rule with only a few parameters (henceforth, the 'minimal' GCN model, although there may
      be modifications to make this architecture even smaller):
    </p>
      <ul>
        <li>GCNConv:
          <d-math block>
              W = \begin{bmatrix} 1 \\ 1 \end{bmatrix} \qquad
              B = \begin{bmatrix} \frac{1}{10} \\ 1 \end{bmatrix} \qquad
              C = \begin{bmatrix} -3 \\ -2 \end{bmatrix} \qquad 
              f \equiv \text{identity}.
          </d-math>
        </li>
        <li>Linear:
          <d-math block>
              w = \begin{bmatrix} -10 & 1 \end{bmatrix} \qquad
              b = \begin{bmatrix} 0 \end{bmatrix}.
          </d-math>
        </li>
        <li>Linear:
          (This layer is necessary only for overparametrization factor $(m) > 1$,
          as it serves as a projection down to $2$-dimensions.)
          <d-math block>
              w = \begin{bmatrix} -1 \\ 1 \end{bmatrix} \qquad
              b = \begin{bmatrix} 1 \\ 0 \end{bmatrix}.
          </d-math>
        </li>
      </ul>
    <p>
      Unlike <d-cite key='game-of-life-nns'></d-cite>, we use ReLU activations exclusively, for consistency.
      With this, the 'minimal' CNN model is slightly different:
    </p>
      <ul>
        <li>GCNConv:
          <d-math block>
              w_1 = \begin{bmatrix} 1 & 1 & 1 \\ 1 & \frac{1}{10} & 1 \\ 1 & 1 & 1 \end{bmatrix} \qquad
              b_1 = -3 \qquad
              w_2 = \begin{bmatrix} 1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1 \end{bmatrix} \qquad
              b_2 = -2.
          </d-math>
        </li>
        <li>Linear:
          <d-math block>
              w = \begin{bmatrix} -10 & 1 \end{bmatrix} \qquad
              b = \begin{bmatrix} 0 \end{bmatrix}.
          </d-math>
        </li>
        <li>Linear:
          (As before, and similar to <d-cite key='game-of-life-nns'></d-cite>, this layer is necessary only for overparametrization factor $(m) > 1$.)
          <d-math block>
              w = \begin{bmatrix} -1 \\ 1 \end{bmatrix} \qquad
              b = \begin{bmatrix} 1 \\ 0 \end{bmatrix}.
          </d-math>
        </li>
      </ul>
    <p>
      The variant described earlier in the article needs many more parameters to capture the optimal update rule on finite grids,
      since it would need to distinguish between non-central cells which have fewer neighbours.
      However, in an infinite grid, it would be able to capture the optimal update rule with only a few parameters,
      since all cells would have $7$ neighbours.
    </p>

    <h3 id="game-of-life-details">Appendix: The Game of Life Experiment Details </h3>
    <p>
      We generate $32 \times 5 = 160$ unique grids by varying the number of alive cells from 1 to 32, and randomly creating $5$ grids with the required number of alive cells.
      Then, we repeat these grids $2500$ times, shuffle the entire set of $160 \times 2500$ grids and batch them into $8000$ batches of $50$ grids each.
      Over each of these grids, $25\%$ of these cells are marked as 'training', while $25\%$ of them are marked as 'validation'.
      This is significantly lesser than the amount of training data used in <d-cite key='game-of-life-nns'></d-cite>.
    </p>
    <p>
      At each step, a training batch is fed in, and the categorical cross-entropy loss is computed over all of the 'training' cells in the batch,
      to update the weights of each model via stochastic gradient descent.
      Additionally, the categorical cross-entropy loss is computed over the 'validation' cells, and is tracked over the last $300$ steps.
      If the 'validation' loss hasn't improved over its value $300$ steps ago, the training procedure stops ('early-stopping').
    </p>
    <p>
      For each value of the overparametrization factor $m$ from $1$ to $10$, we train $40$ GCN and $40$ CNN models, each initialized differently (according to a random seed).
      Across all of these, only $2$ models went through all $8000$ training steps, and both of them had perfect validation accuracy.
    </p>
    <p>
      For completeness, we list the best and worst seeds (according to the validation accuracy after training) for each value of the overparametrization factor $m$.
      If multiple seeds had the same final validation accuracy, the largest seed (in numeric value) was chosen.
    </p>
      <table>
        <caption>GCN Seeds</caption>
        <thead>
          <tr><th>$m$</th><th>Best Seed</th><th>Worst Seed</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>1</td><td>25</td></tr>
          <tr><td>2</td><td>13</td><td>31</td></tr>
          <tr><td>3</td><td>29</td><td>5</td></tr>
          <tr><td>4</td><td>0</td><td>13</td></tr>
          <tr><td>5</td><td>39</td><td>25</td></tr>
          <tr><td>6</td><td>39</td><td>3</td></tr>
          <tr><td>7</td><td>39</td><td>32</td></tr>
          <tr><td>8</td><td>39</td><td>17</td></tr>
          <tr><td>9</td><td>39</td><td>5</td></tr>
          <tr><td>10</td><td>39</td><td>0</td></tr>
        </tbody>
      </table>
      <table>
        <caption>CNN Seeds</caption>
        <thead>
          <tr><th>$m$</th><th>Best Seed</th><th>Worst Seed</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>25</td><td>24</td></tr>
          <tr><td>2</td><td>37</td><td>11</td></tr>
          <tr><td>3</td><td>19</td><td>4</td></tr>
          <tr><td>4</td><td>19</td><td>21</td></tr>
          <tr><td>5</td><td>39</td><td>8</td></tr>
          <tr><td>6</td><td>39</td><td>17</td></tr>
          <tr><td>7</td><td>39</td><td>30</td></tr>
          <tr><td>8</td><td>39</td><td>13</td></tr>
          <tr><td>9</td><td>39</td><td>30</td></tr>
          <tr><td>10</td><td>39</td><td>34</td></tr>
        </tbody>
      </table>
    <p>
      Links to all of this code are available in the <a href="#supplementary">Supplementary Material</a>.
    </p> -->
    <!-- XManager Experiment ID: 19174057 -->

    <h3>Acknowledgments</h3>
    <p>
      We are deeply grateful to <a href="https://observablehq.com/">ObservableHQ</a>, a wonderful platform for developing interactive visualizations.
      The static visualizations would not have been possible without <a href="https://inkscape.org/">Inkscape</a>
      and Alexander Lenail’s <a href="https://alexlenail.me/NN-SVG/index.html">Neural Network SVG Generator</a>.
      The molecule diagrams depicted above were obtained and modified from
      <a href="https://commons.wikimedia.org/wiki/File:Caramboxin.svg">Wikimedia Commons</a>,
      available in the public domain.
    </p>
    <p>
      We would like to acknowledge the following Distill articles for inspiration on article design:
    </p>
      <ul>
        <li><a href="https://distill.pub/2019/memorization-in-rnns/">Visualizing memorization in RNNs</a></li>
        <li><a href="https://distill.pub/2020/understanding-rl-vision/">Understanding RL Vision</a></li>
      </ul>
    <p>
      We would like to thank Thomas Kipf for his valuable feedback on the technical content within this article.
    </p>
    <p>
      We would like to thank David Nichols for creating <a href="https://davidmathlogic.com/colorblind/#%23D81B60-%231E88E5-%23FFC107-%23004D40">Coloring for Colorblindness</a>
      which helped us improve the accessibility of this article’s color scheme.
    </p>
    <p>
      We would also like to acknowledge <a href="http://web.stanford.edu/class/cs224w/">CS224W: Machine Learning with Graphs</a> as an excellent reference from which the authors benefitted significantly.
    </p>
    <p>
      Ashish Tendulkar from Google Research India provided significant 
feedback on the content within this article, helping its readability.
      He also helped with identifying the topics this article should 
cover, and with brainstorming the experiments here.
    </p>
    <p>
      Adam Pearce from Google Research helped us immensely with article hosting and rendering.
    </p>
    <p>
      Finally, we would like to thank Anirban Santara, Sujoy Paul and 
Ansh Khurana from Google Research India for their help with setting up 
and running experiments.
    </p>

    <h3>Author Contributions</h3>
    <p>
      <b>Ameya Daigavane</b> drafted most of the text, designed experiments and created the interactive visualizations in this article.
      <b>Balaraman Ravindran</b> and <b>Gaurav Aggarwal</b> extensively guided the overall direction of the article,
      deliberated over the design and scope of experiments, provided much feedback on the interactive visualizations,
      edited the text, and described improvements to make the article more accessible to readers.
    </p>

    <h3>Discussion and Review</h3>
    <p>
      <a href="https://github.com/distillpub/exploring-graph-nns/issues/1">Review 1 - Chaitanya K. Joshi</a><br>
      <a href="https://github.com/distillpub/exploring-graph-nns/issues/2">Review 2 - Nick Moran</a><br>
      <a href="https://github.com/distillpub/exploring-graph-nns/issues/3">Review 3 - Anonymous</a><br>
    </p>

    <d-citation-list distill-prerendered="true"><style>
d-citation-list {
  contain: style;
}

d-citation-list .references {
  grid-column: text;
}

d-citation-list .references .title {
  font-weight: 500;
}
</style><h3 id="references">References</h3><ol id="references-list" class="references"><li id="gnn-intro"><span class="title">A Gentle Introduction to Graph Neural Networks</span> <br>Sanchez-Lengeling, B., Reif, E., Pearce, A. and Wiltschko, A., 2021. Distill.  <a href="https://doi.org/10.23915/distill.00033" style="text-decoration:inherit;">DOI: 10.23915/distill.00033</a></li><li id="graph-kernels"><span class="title">Graph Kernels</span>   <a href="http://jmlr.org/papers/v11/vishwanathan10a.html">[HTML]</a><br>Vishwanathan,
 S., Schraudolph, N.N., Kondor, R. and Borgwardt, K.M., 2010. Journal of
 Machine Learning Research, Vol 11(40), pp. 1201-1242. </li><li id="node2vec"><span class="title">Node2vec: Scalable Feature Learning for Networks</span>   <a href="https://doi.org/10.1145/2939672.2939754">[link]</a><br>Grover,
 A. and Leskovec, J., 2016. Proceedings of the 22nd ACM SIGKDD 
International Conference on Knowledge Discovery and Data Mining, pp. 
855–864. Association for Computing Machinery. <a href="https://doi.org/10.1145/2939672.2939754" style="text-decoration:inherit;">DOI: 10.1145/2939672.2939754</a></li><li id="deepwalk"><span class="title">DeepWalk: Online Learning of Social Representations</span>   <a href="https://doi.org/10.1145/2623330.2623732">[link]</a><br>Perozzi,
 B., Al-Rfou, R. and Skiena, S., 2014. Proceedings of the 20th ACM 
SIGKDD International Conference on Knowledge Discovery and Data Mining, 
pp. 701–710. Association for Computing Machinery. <a href="https://doi.org/10.1145/2623330.2623732" style="text-decoration:inherit;">DOI: 10.1145/2623330.2623732</a></li><li id="molecules-gnn"><span class="title">Convolutional Networks on Graphs for Learning Molecular Fingerprints</span>   <a href="https://proceedings.neurips.cc/paper/2015/file/f9be311e65d81a9ad8150a60844bb94c-Paper.pdf">[PDF]</a><br>Duvenaud,
 D.K., Maclaurin, D., Iparraguirre, J., Bombarell, R., Hirzel, T., 
Aspuru-Guzik, A. and Adams, R.P., 2015. Advances in Neural Information 
Processing Systems, Vol 28, pp. 2224-2232. Curran Associates, Inc.</li><li id="neural-message-passing"><span class="title">Neural Message Passing for Quantum Chemistry</span>   <a href="http://proceedings.mlr.press/v70/gilmer17a.html">[HTML]</a><br>Gilmer,
 J., Schoenholz, S.S., Riley, P.F., Vinyals, O. and Dahl, G.E., 2017. 
Proceedings of the 34th International Conference on Machine Learning, 
Vol 70, pp. 1263-1272. PMLR.</li><li id="patchysan"><span class="title">Learning Convolutional Neural Networks for Graphs</span> <br>Niepert,
 M., Ahmed, M. and Kutzkov, K., 2016. Proceedings of the 33rd 
International Conference on International Conference on Machine Learning
 - Volume 48, pp. 2014–2023. JMLR.org.</li><li id="spectral-clustering"><span class="title">A Tutorial on Spectral Clustering</span>   <a href="http://arxiv.org/pdf/0711.0189.pdf">[PDF]</a><br>Luxburg, U.v., 2007. CoRR, Vol abs/0711.0189. </li><li id="chebnet"><span class="title">Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering</span>   <a href="https://proceedings.neurips.cc/paper/2016/file/04df4d434d481c5bb723be1b6df1ee65-Paper.pdf">[PDF]</a><br>Defferrard,
 M., Bresson, X. and Vandergheynst, P., 2016. Advances in Neural 
Information Processing Systems, Vol 29, pp. 3844-3852. Curran 
Associates, Inc.</li><li id="wavelets-graphs"><span class="title">Wavelets on Graphs via Spectral Graph Theory</span>   <a href="http://www.sciencedirect.com/science/article/pii/S1063520310000552">[link]</a><br>Hammond,
 D.K., Vandergheynst, P. and Gribonval, R., 2011. Applied and 
Computational Harmonic Analysis, Vol 30(2), pp. 129 - 150.  <a href="https://doi.org/https://doi.org/10.1016/j.acha.2010.04.005" style="text-decoration:inherit;">DOI: https://doi.org/10.1016/j.acha.2010.04.005</a></li><li id="chebyshev"><span class="title">Chebyshev Polynomials</span>   <a href="https://books.google.co.in/books?id=8FHf0P3to0UC">[link]</a><br>Mason, J. and Handscomb, D., 2002. CRC Press.</li><li id="semi-supervised-gcn"><span class="title">Semi-Supervised Classification with Graph Convolutional Networks</span>   <a href="https://openreview.net/forum?id=SJU4ayYgl">[link]</a><br>Kipf,
 T.N. and Welling, M., 2017. 5th International Conference on Learning 
Representations (ICLR) 2017, Toulon, France, April 24-26, 2017, 
Conference Track Proceedings. OpenReview.net.</li><li id="gat"><span class="title">Graph Attention Networks</span>   <a href="https://openreview.net/forum?id=rJXMpikCZ">[link]</a><br>Veličković,
 P., Cucurull, G., Casanova, A., Romero, A., Liò, P. and Bengio, Y., 
2018. International Conference on Learning Representations. </li><li id="graphsage"><span class="title">Inductive Representation Learning on Large Graphs</span>   <a href="https://proceedings.neurips.cc/paper/2017/file/5dd9db5e033da9c6fb5ba83c7a7ebea9-Paper.pdf">[PDF]</a><br>Hamilton,
 W., Ying, Z. and Leskovec, J., 2017. Advances in Neural Information 
Processing Systems, Vol 30, pp. 1024-1034. Curran Associates, Inc.</li><li id="gin"><span class="title">How Powerful are Graph Neural Networks?</span>   <a href="https://openreview.net/forum?id=ryGs6iA5Km">[link]</a><br>Xu, K., Hu, W., Leskovec, J. and Jegelka, S., 2019. International Conference on Learning Representations. </li><li id="graphnets"><span class="title">Relational inductive biases, deep learning, and graph networks</span>   <a href="http://arxiv.org/pdf/1806.01261.pdf">[PDF]</a><br>Battaglia,
 P.W., Hamrick, J.B., Bapst, V., Sanchez-Gonzalez, A., Zambaldi, V.F., 
Malinowski, M., Tacchetti, A., Raposo, D., Santoro, A., Faulkner, R., 
Gulcehre, C., Song, H.F., Ballard, A.J., Gilmer, J., Dahl, G.E., 
Vaswani, A., Allen, K.R., Nash, C., Langston, V., Dyer, C., Heess, N., 
Wierstra, D., Kohli, P., Botvinick, M., Vinyals, O., Li, Y. and Pascanu,
 R., 2018. CoRR, Vol abs/1806.01261. </li><li id="spectral-networks"><span class="title">Spectral Networks and Locally Connected Networks on Graphs</span>   <a href="http://arxiv.org/pdf/1312.6203.pdf">[PDF]</a><br>Bruna,
 J., Zaremba, W., Szlam, A. and LeCun, Y., 2014. International 
Conference on Learning Representations (ICLR 2014), CBLS, April 2014. </li><li id="imagenet"><span class="title">ImageNet: A Large-Scale Hierarchical Image Database</span> <br>Deng, J., Dong, W., Socher, R., Li, L., Li, K. and Fei-Fei, L., 2009. CVPR09. </li><li id="spectral-transfer"><span class="title">On the Transferability of Spectral Graph Filters</span> <br>Levie,
 R., Isufi, E. and Kutyniok, G., 2019. 2019 13th International 
conference on Sampling Theory and Applications (SampTA), Vol (), pp. 
1-5.  <a href="https://doi.org/10.1109/SampTA45681.2019.9030932" style="text-decoration:inherit;">DOI: 10.1109/SampTA45681.2019.9030932</a></li><li id="directional-gnns"><span class="title">Directional Graph Networks</span> <br>Beaini, D., Passaro, S., Létourneau, V., Hamilton, W.L., Corso, G. and Liò, P., 2021. </li><li id="elmo"><span class="title">Deep contextualized word representations</span> <br>Peters, M.E., Neumann, M., Iyyer, M., Gardner, M., Clark, C., Lee, K. and Zettlemoyer, L., 2018. Proc. of NAACL. </li><li id="bert"><span class="title">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</span>   <a href="https://www.aclweb.org/anthology/N19-1423">[link]</a><br>Devlin,
 J., Chang, M., Lee, K. and Toutanova, K., 2019. Proceedings of the 2019
 Conference of the North American Chapter of the Association for 
Computational Linguistics: Human Language Technologies, Volume 1 (Long 
and Short Papers), pp. 4171-4186. Association for Computational 
Linguistics. <a href="https://doi.org/10.18653/v1/N19-1423" style="text-decoration:inherit;">DOI: 10.18653/v1/N19-1423</a></li><li id="strategies-pre-training"><span class="title">Strategies for Pre-training Graph Neural Networks</span>   <a href="https://openreview.net/forum?id=HJlWWJSFDH">[link]</a><br>Hu*,
 W., Liu*, B., Gomes, J., Zitnik, M., Liang, P., Pande, V. and Leskovec,
 J., 2020. International Conference on Learning Representations. </li><li id="m3s"><span class="title">Multi-Stage Self-Supervised Learning for Graph Convolutional Networks on Graphs with Few Labeled Nodes</span>   <a href="https://aaai.org/ojs/index.php/AAAI/article/view/6048">[link]</a><br>Sun,
 K., Lin, Z. and Zhu, Z., 2020. The Thirty-Fourth AAAI Conference on 
Artificial Intelligence, AAAI 2020, The Thirty-Second Innovative 
Applications of Artificial Intelligence Conference, IAAI 2020, The Tenth
 AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI
 2020, New York, NY, USA, February 7-12, 2020, pp. 5892-5899. AAAI 
Press.</li><li id="when-does-self-help"><span class="title">When Does Self-Supervision Help Graph Convolutional Networks?</span>   <a href="http://arxiv.org/pdf/2006.09136.pdf">[PDF]</a><br>You, Y., Chen, T., Wang, Z. and Shen, Y., 2020. </li><li id="self-supervised-graphs-insights"><span class="title">Self-supervised Learning on Graphs: Deep Insights and New Direction</span>   <a href="http://arxiv.org/pdf/2006.10141.pdf">[PDF]</a><br>Jin, W., Derr, T., Liu, H., Wang, Y., Wang, S., Liu, Z. and Tang, J., 2020. </li><li id="nce"><span class="title">Noise-Contrastive Estimation of Unnormalized Statistical Models, with Applications to Natural Image Statistics</span>   <a href="http://jmlr.org/papers/v13/gutmann12a.html">[HTML]</a><br>Gutmann, M.U. and Hyvärinen, A., 2012. Journal of Machine Learning Research, Vol 13(11), pp. 307-361. </li><li id="nce-embeddings"><span class="title">Learning word embeddings efficiently with noise-contrastive estimation</span>   <a href="https://proceedings.neurips.cc/paper/2013/file/db2b4182156b2f1f817860ac9f409ad7-Paper.pdf">[PDF]</a><br>Mnih,
 A. and Kavukcuoglu, K., 2013. Advances in Neural Information Processing
 Systems, Vol 26, pp. 2265-2273. Curran Associates, Inc.</li><li id="gnn-survey"><span class="title">A Comprehensive Survey on Graph Neural Networks</span>   <a href="https://ieeexplore.ieee.org/document/9046288">[link]</a><br>Wu,
 Z., Pan, S., Chen, F., Long, G., Zhang, C. and Yu, P.S., 2020. IEEE 
Transactions on Neural Networks and Learning Systems, pp. 1-21.  <a href="https://doi.org/10.1109/TNNLS.2020.2978386" style="text-decoration:inherit;">DOI: 10.1109/TNNLS.2020.2978386</a></li><li id="gnn-review"><span class="title">Graph Neural Networks: A Review of Methods and Applications</span>   <a href="http://arxiv.org/pdf/1812.08434.pdf">[PDF]</a><br>Zhou, J., Cui, G., Zhang, Z., Yang, C., Liu, Z. and Sun, M., 2018. CoRR, Vol abs/1812.08434. </li><li id="dropout"><span class="title">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</span>   <a href="http://jmlr.org/papers/v15/srivastava14a.html">[HTML]</a><br>Srivastava,
 N., Hinton, G., Krizhevsky, A., Sutskever, I. and Salakhutdinov, R., 
2014. Journal of Machine Learning Research, Vol 15(56), pp. 1929-1958. </li><li id="dropedge"><span class="title">DropEdge: Towards Deep Graph Convolutional Networks on Node Classification</span>   <a href="https://openreview.net/forum?id=Hkx1qkrKPr">[link]</a><br>Rong, Y., Huang, W., Xu, T. and Huang, J., 2020. International Conference on Learning Representations. </li><li id="sortpool"><span class="title">An End-to-End Deep Learning Architecture for Graph Classification</span>   <a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17146">[link]</a><br>Zhang,
 M., Cui, Z., Neumann, M. and Chen, Y., 2018. Proceedings of the 
Thirty-Second AAAI Conference on Artificial Intelligence, (AAAI-18), the
 30th innovative Applications of Artificial Intelligence (IAAI-18), and 
the 8th AAAI Symposium on Educational Advances in Artificial 
Intelligence (EAAI-18), New Orleans, Louisiana, USA, February 2-7, 2018,
 pp. 4438-4445. AAAI Press.</li><li id="diffpool"><span class="title">Hierarchical Graph Representation Learning with Differentiable Pooling</span>   <a href="https://proceedings.neurips.cc/paper/2018/file/e77dbaf6759253c7c6d0efc5690369c7-Paper.pdf">[PDF]</a><br>Ying,
 Z., You, J., Morris, C., Ren, X., Hamilton, W. and Leskovec, J., 2018. 
Advances in Neural Information Processing Systems, Vol 31, pp. 
4800-4810. Curran Associates, Inc.</li><li id="sagpool"><span class="title">Self-Attention Graph Pooling</span>   <a href="http://proceedings.mlr.press/v97/lee19c.html">[HTML]</a><br>Lee,
 J., Lee, I. and Kang, J., 2019. Proceedings of the 36th International 
Conference on Machine Learning, Vol 97, pp. 3734-3743. PMLR.</li></ol></d-citation-list>
  <distill-appendix>
<style>
  distill-appendix {
    contain: layout style;
  }

  distill-appendix .citation {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  distill-appendix > * {
    grid-column: text;
  }
</style>

    <h3 id="updates-and-corrections">Updates and Corrections</h3>
    <p>
    If you see mistakes or want to suggest changes, please <a href="https://github.com/distillpub/post--understanding-gnns/issues/new">create an issue on GitHub</a>. </p>
    
    <h3 id="reuse">Reuse</h3>
    <p>Diagrams and text are licensed under Creative Commons Attribution <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> with the <a class="github" href="https://github.com/distillpub/post--understanding-gnns">source available on GitHub</a>,
 unless noted otherwise. The figures that have been reused from other 
sources don’t fall under this license and can be recognized by a note in
 their caption: “Figure from …”.</p>
    
    <h3 id="citation">Citation</h3>
    <p>For attribution in academic contexts, please cite this work as</p>
    <pre class="citation short">Daigavane, et al., "Understanding Convolutions on Graphs", Distill, 2021.</pre>
    <p>BibTeX citation</p>
    <pre class="citation long">@article{daigavane2021understanding,
  author = {Daigavane, Ameya and Ravindran, Balaraman and Aggarwal, Gaurav},
  title = {Understanding Convolutions on Graphs},
  journal = {Distill},
  year = {2021},
  note = {https://distill.pub/2021/understanding-gnns},
  doi = {10.23915/distill.00032}
}</pre>
    </distill-appendix></d-appendix>

  <!-- bibliography will be inlined during Distill pipeline's pre-rendering -->
  <d-bibliography><script type="text/json">[["graph-kernels",{"author":"S.V.N. Vishwanathan and Nicol N. Schraudolph and Risi Kondor and Karsten M. Borgwardt","title":"Graph Kernels","journal":"Journal of Machine Learning Research","year":"2010","volume":"11","number":"40","pages":"1201-1242","url":"http://jmlr.org/papers/v11/vishwanathan10a.html","type":"article"}],["spectral-networks",{"title":"Spectral Networks and Locally Connected Networks on Graphs","author":"Joan Bruna and Wojciech Zaremba and Arthur Szlam and Yann LeCun","year":"2014","language":"English (US)","booktitle":"International Conference on Learning Representations (ICLR 2014), CBLS, April 2014","url":"https://arxiv.org/abs/1312.6203","type":"inproceedings"}],["imagenet",{"author":"Deng, J. and Dong, W. and Socher, R. and Li, L.-J. and Li, K. and Fei-Fei, L.","title":"ImageNet: A Large-Scale Hierarchical Image Database","booktitle":"CVPR09","year":"2009","bibsource":"http://www.image-net.org/papers/imagenet_cvpr09.bib","type":"inproceedings"}],["semi-supervised-gcn",{"author":"Thomas N. Kipf and Max Welling","title":"Semi-Supervised Classification with Graph Convolutional Networks","booktitle":"5th International Conference on Learning Representations (ICLR) 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings","publisher":"OpenReview.net","year":"2017","url":"https://openreview.net/forum?id=SJU4ayYgl","timestamp":"Thu, 25 Jul 2019 14:25:55 +0200","biburl":"https://dblp.org/rec/conf/iclr/KipfW17.bib","bibsource":"dblp computer science bibliography, https://dblp.org","type":"inproceedings"}],["graphsage",{"author":"Hamilton, Will and Ying, Zhitao and Leskovec, Jure","booktitle":"Advances in Neural Information Processing Systems","editor":"I. Guyon and U. V. Luxburg and S. Bengio and H. Wallach and R. Fergus and S. Vishwanathan and R. Garnett","pages":"1024-1034","publisher":"Curran Associates, Inc.","title":"Inductive Representation Learning on Large Graphs","url":"https://proceedings.neurips.cc/paper/2017/file/5dd9db5e033da9c6fb5ba83c7a7ebea9-Paper.pdf","volume":"30","year":"2017","type":"inproceedings"}],["molecules-gnn",{"author":"Duvenaud, David K and Maclaurin, Dougal and Iparraguirre, Jorge and Bombarell, Rafael and Hirzel, Timothy and Aspuru-Guzik, Alan and Adams, Ryan P","booktitle":"Advances in Neural Information Processing Systems","editor":"C. Cortes and N. Lawrence and D. Lee and M. Sugiyama and R. Garnett","pages":"2224-2232","publisher":"Curran Associates, Inc.","title":"Convolutional Networks on Graphs for Learning Molecular Fingerprints","url":"https://proceedings.neurips.cc/paper/2015/file/f9be311e65d81a9ad8150a60844bb94c-Paper.pdf","volume":"28","year":"2015","type":"inproceedings"}],["gat",{"title":"Graph Attention Networks","author":"Petar Veličković and Guillem Cucurull and Arantxa Casanova and Adriana Romero and Pietro Liò and Yoshua Bengio","booktitle":"International Conference on Learning Representations","year":"2018","url":"https://openreview.net/forum?id=rJXMpikCZ","type":"inproceedings"}],["gin",{"title":"How Powerful are Graph Neural Networks?","author":"Keyulu Xu and Weihua Hu and Jure Leskovec and Stefanie Jegelka","booktitle":"International Conference on Learning Representations","year":"2019","url":"https://openreview.net/forum?id=ryGs6iA5Km","type":"inproceedings"}],["chebnet",{"author":"Defferrard, Micha\\\"{e}l and Bresson, Xavier and Vandergheynst, Pierre","booktitle":"Advances in Neural Information Processing Systems","editor":"D. Lee and M. Sugiyama and U. Luxburg and I. Guyon and R. Garnett","pages":"3844-3852","publisher":"Curran Associates, Inc.","title":"Convolutional Neural Networks on Graphs with Fast Localized Spectral Filtering","url":"https://proceedings.neurips.cc/paper/2016/file/04df4d434d481c5bb723be1b6df1ee65-Paper.pdf","volume":"29","year":"2016","type":"inproceedings"}],["chebyshev",{"title":"Chebyshev Polynomials","author":"Mason, J.C. and Handscomb, D.C.","isbn":"9781420036114","url":"https://books.google.co.in/books?id=8FHf0P3to0UC","year":"2002","publisher":"CRC Press","type":"book"}],["self-supervised-graphs-insights",{"title":"Self-supervised Learning on Graphs: Deep Insights and New Direction","author":"Wei Jin and Tyler Derr and Haochen Liu and Yiqi Wang and Suhang Wang and Zitao Liu and Jiliang Tang","year":"2020","eprint":"2006.10141","archivePrefix":"arXiv","primaryClass":"cs.LG","url":"https://arxiv.org/abs/2006.10141","archiveprefix":"arXiv","primaryclass":"cs.LG","type":"misc"}],["when-does-self-help",{"title":"When Does Self-Supervision Help Graph Convolutional Networks?","author":"Yuning You and Tianlong Chen and Zhangyang Wang and Yang Shen","year":"2020","eprint":"2006.09136","archivePrefix":"arXiv","primaryClass":"cs.LG","url":"https://arxiv.org/abs/2006.09136","archiveprefix":"arXiv","primaryclass":"cs.LG","type":"misc"}],["elmo",{"author":"Peters, Matthew E. and Neumann, Mark and Iyyer, Mohit and Gardner, Matt and Clark, Christopher and Lee, Kenton and Zettlemoyer, Luke","title":"Deep contextualized word representations","booktitle":"Proc. of NAACL","year":"2018","type":"inproceedings"}],["bert",{"title":"BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding","author":"Devlin, Jacob and Chang, Ming-Wei and Lee, Kenton and Toutanova, Kristina","booktitle":"Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)","month":"jun","year":"2019","address":"Minneapolis, Minnesota","publisher":"Association for Computational Linguistics","url":"https://www.aclweb.org/anthology/N19-1423","doi":"10.18653/v1/N19-1423","pages":"4171-4186","type":"inproceedings"}],["strategies-pre-training",{"title":"Strategies for Pre-training Graph Neural Networks","author":"Weihua Hu* and Bowen Liu* and Joseph Gomes and Marinka Zitnik and Percy Liang and Vijay Pande and Jure Leskovec","booktitle":"International Conference on Learning Representations","year":"2020","url":"https://openreview.net/forum?id=HJlWWJSFDH","type":"inproceedings"}],["m3s",{"author":"Ke Sun and Zhouchen Lin and Zhanxing Zhu","title":"Multi-Stage Self-Supervised Learning for Graph Convolutional Networks on Graphs with Few Labeled Nodes","booktitle":"The Thirty-Fourth AAAI Conference on Artificial Intelligence, AAAI 2020, The Thirty-Second Innovative Applications of Artificial Intelligence Conference, IAAI 2020, The Tenth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2020, New York, NY, USA, February 7-12, 2020","pages":"5892-5899","publisher":"AAAI Press","year":"2020","url":"https://aaai.org/ojs/index.php/AAAI/article/view/6048","timestamp":"Thu, 04 Jun 2020 16:49:55 +0200","biburl":"https://dblp.org/rec/conf/aaai/SunLZ20.bib","bibsource":"dblp computer science bibliography, https://dblp.org","type":"inproceedings"}],["wavelets-graphs",{"title":"Wavelets on Graphs via Spectral Graph Theory","journal":"Applied and Computational Harmonic Analysis","volume":"30","number":"2","pages":"129 - 150","year":"2011","issn":"1063-5203","doi":"https://doi.org/10.1016/j.acha.2010.04.005","url":"http://www.sciencedirect.com/science/article/pii/S1063520310000552","author":"David K. Hammond and Pierre Vandergheynst and Rémi Gribonval","keywords":"Graph theory, Wavelets, Spectral graph theory, Overcomplete wavelet frames","type":"article"}],["diffpool",{"author":"Ying, Zhitao and You, Jiaxuan and Morris, Christopher and Ren, Xiang and Hamilton, Will and Leskovec, Jure","booktitle":"Advances in Neural Information Processing Systems","editor":"S. Bengio and H. Wallach and H. Larochelle and K. Grauman and N. Cesa-Bianchi and R. Garnett","pages":"4800-4810","publisher":"Curran Associates, Inc.","title":"Hierarchical Graph Representation Learning with Differentiable Pooling","url":"https://proceedings.neurips.cc/paper/2018/file/e77dbaf6759253c7c6d0efc5690369c7-Paper.pdf","volume":"31","year":"2018","type":"inproceedings"}],["sagpool",{"title":"Self-Attention Graph Pooling","author":"Lee, Junhyun and Lee, Inyeop and Kang, Jaewoo","booktitle":"Proceedings of the 36th International Conference on Machine Learning","pages":"3734-3743","year":"2019","editor":"Kamalika Chaudhuri and Ruslan Salakhutdinov","volume":"97","series":"Proceedings of Machine Learning Research","address":"Long Beach, California, USA","month":"09-15 Jun","publisher":"PMLR","pdf":"http://proceedings.mlr.press/v97/lee19c/lee19c.pdf","url":"http://proceedings.mlr.press/v97/lee19c.html","type":"inproceedings"}],["sortpool",{"author":"Muhan Zhang and Zhicheng Cui and Marion Neumann and Yixin Chen","editor":"Sheila A. McIlraith and Kilian Q. Weinberger","title":"An End-to-End Deep Learning Architecture for Graph Classification","booktitle":"Proceedings of the Thirty-Second AAAI Conference on Artificial Intelligence, (AAAI-18), the 30th innovative Applications of Artificial Intelligence (IAAI-18), and the 8th AAAI Symposium on Educational Advances in Artificial Intelligence (EAAI-18), New Orleans, Louisiana, USA, February 2-7, 2018","pages":"4438-4445","publisher":"AAAI Press","year":"2018","url":"https://www.aaai.org/ocs/index.php/AAAI/AAAI18/paper/view/17146","timestamp":"Tue, 23 Oct 2018 06:42:15 +0200","biburl":"https://dblp.org/rec/conf/aaai/ZhangCNC18.bib","bibsource":"dblp computer science bibliography, https://dblp.org","type":"inproceedings"}],["game-of-life-nns",{"title":"It's Hard for Neural Networks To Learn the Game of Life","author":"Jacob M. Springer and Garrett T. Kenyon","year":"2020","eprint":"2009.01398","archivePrefix":"arXiv","primaryClass":"cs.LG","url":"https://arxiv.org/abs/2009.01398","archiveprefix":"arXiv","primaryclass":"cs.LG","type":"misc"}],["directional-gnns",{"title":"Directional Graph Networks","author":"Dominique Beaini and Saro Passaro and Vincent Létourneau and William L. Hamilton and Gabriele Corso and Pietro Liò","year":"2021","eprint":"2010.02863","archivePrefix":"arXiv","primaryClass":"cs.LG","archiveprefix":"arXiv","primaryclass":"cs.LG","type":"misc"}],["gnn-survey",{"author":"Z. Wu and S. Pan and F. Chen and G. Long and C. Zhang and P. S. Yu","journal":"IEEE Transactions on Neural Networks and Learning Systems","title":"A Comprehensive Survey on Graph Neural Networks","url":"https://ieeexplore.ieee.org/document/9046288","year":"2020","pages":"1-21","doi":"10.1109/TNNLS.2020.2978386","type":"article"}],["dropedge",{"title":"DropEdge: Towards Deep Graph Convolutional Networks on Node Classification","author":"Yu Rong and Wenbing Huang and Tingyang Xu and Junzhou Huang","booktitle":"International Conference on Learning Representations","year":"2020","url":"https://openreview.net/forum?id=Hkx1qkrKPr","type":"inproceedings"}],["dropout",{"author":"Nitish Srivastava and Geoffrey Hinton and Alex Krizhevsky and Ilya Sutskever and Ruslan Salakhutdinov","title":"Dropout: A Simple Way to Prevent Neural Networks from Overfitting","journal":"Journal of Machine Learning Research","year":"2014","volume":"15","number":"56","pages":"1929-1958","url":"http://jmlr.org/papers/v15/srivastava14a.html","type":"article"}],["nce",{"author":"Michael U. Gutmann and Aapo Hyvärinen","title":"Noise-Contrastive Estimation of Unnormalized Statistical Models, with Applications to Natural Image Statistics","journal":"Journal of Machine Learning Research","year":"2012","volume":"13","number":"11","pages":"307-361","url":"http://jmlr.org/papers/v13/gutmann12a.html","type":"article"}],["nce-embeddings",{"author":"Mnih, Andriy and Kavukcuoglu, Koray","booktitle":"Advances in Neural Information Processing Systems","editor":"C. J. C. Burges and L. Bottou and M. Welling and Z. Ghahramani and K. Q. Weinberger","pages":"2265-2273","publisher":"Curran Associates, Inc.","title":"Learning word embeddings efficiently with noise-contrastive estimation","url":"https://proceedings.neurips.cc/paper/2013/file/db2b4182156b2f1f817860ac9f409ad7-Paper.pdf","volume":"26","year":"2013","type":"inproceedings"}],["node2vec",{"author":"Grover, Aditya and Leskovec, Jure","title":"Node2vec: Scalable Feature Learning for Networks","year":"2016","isbn":"9781450342322","publisher":"Association for Computing Machinery","address":"New York, NY, USA","url":"https://doi.org/10.1145/2939672.2939754","doi":"10.1145/2939672.2939754","booktitle":"Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining","pages":"855–864","numpages":"10","keywords":"graph representations, information networks, node embeddings, feature learning","location":"San Francisco, California, USA","series":"KDD '16","type":"inproceedings"}],["deepwalk",{"author":"Perozzi, Bryan and Al-Rfou, Rami and Skiena, Steven","title":"DeepWalk: Online Learning of Social Representations","year":"2014","isbn":"9781450329569","publisher":"Association for Computing Machinery","address":"New York, NY, USA","url":"https://doi.org/10.1145/2623330.2623732","doi":"10.1145/2623330.2623732","booktitle":"Proceedings of the 20th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining","pages":"701–710","numpages":"10","keywords":"deep learning, latent representations, learning with partial labels, online learning, social networks, network classification","location":"New York, New York, USA","series":"KDD '14","type":"inproceedings"}],["neural-message-passing",{"title":"Neural Message Passing for Quantum Chemistry","author":"Justin Gilmer and Samuel S. Schoenholz and Patrick F. Riley and Oriol Vinyals and George E. Dahl","booktitle":"Proceedings of the 34th International Conference on Machine Learning","pages":"1263-1272","year":"2017","editor":"Doina Precup and Yee Whye Teh","volume":"70","series":"Proceedings of Machine Learning Research","address":"International Convention Centre, Sydney, Australia","month":"06-11 Aug","publisher":"PMLR","pdf":"http://proceedings.mlr.press/v70/gilmer17a/gilmer17a.pdf","url":"http://proceedings.mlr.press/v70/gilmer17a.html","type":"InProceedings"}],["graphnets",{"author":"Peter W. Battaglia and Jessica B. Hamrick and Victor Bapst and Alvaro Sanchez-Gonzalez and Vin{\\'i}cius Flores Zambaldi and Mateusz Malinowski and Andrea Tacchetti and David Raposo and Adam Santoro and Ryan Faulkner and Caglar Gulcehre and H. Francis Song and Andrew J. Ballard and Justin Gilmer and George E. Dahl and Ashish Vaswani and Kelsey R. Allen and Charles Nash and Victoria Langston and Chris Dyer and Nicolas Heess and Daan Wierstra and Pushmeet Kohli and Matthew Botvinick and Oriol Vinyals and Yujia Li and Razvan Pascanu","title":"Relational inductive biases, deep learning, and graph networks","journal":"CoRR","volume":"abs/1806.01261","year":"2018","url":"http://arxiv.org/abs/1806.01261","archivePrefix":"arXiv","eprint":"1806.01261","timestamp":"Wed, 24 Jul 2019 18:56:21 +0200","biburl":"https://dblp.org/rec/journals/corr/abs-1806-01261.bib","bibsource":"dblp computer science bibliography, https://dblp.org","archiveprefix":"arXiv","type":"article"}],["gnn-review",{"author":"Jie Zhou and Ganqu Cui and Zhengyan Zhang and Cheng Yang and Zhiyuan Liu and Maosong Sun","title":"Graph Neural Networks: A Review of Methods and Applications","journal":"CoRR","volume":"abs/1812.08434","year":"2018","url":"http://arxiv.org/abs/1812.08434","archivePrefix":"arXiv","eprint":"1812.08434","timestamp":"Tue, 01 Dec 2020 13:54:50 +0100","biburl":"https://dblp.org/rec/journals/corr/abs-1812-08434.bib","bibsource":"dblp computer science bibliography, https://dblp.org","archiveprefix":"arXiv","type":"article"}],["game-of-life",{"ISSN":"00368733, 19467087","URL":"http://www.jstor.org/stable/24927642","author":"Martin Gardner","journal":"Scientific American","number":"4","pages":"120-123","publisher":"Scientific American, a division of Nature America, Inc.","title":"Mathematical Games","volume":"223","year":"1970","issn":"00368733, 19467087","url":"http://www.jstor.org/stable/24927642","type":"article"}],["spectral-transfer",{"author":"Levie, Ron and Isufi, Elvin and Kutyniok, Gitta","booktitle":"2019 13th International conference on Sampling Theory and Applications (SampTA)","title":"On the Transferability of Spectral Graph Filters","year":"2019","volume":"","number":"","pages":"1-5","doi":"10.1109/SampTA45681.2019.9030932","type":"inproceedings"}],["patchysan",{"author":"Niepert, Mathias and Ahmed, Mohamed and Kutzkov, Konstantin","title":"Learning Convolutional Neural Networks for Graphs","year":"2016","publisher":"JMLR.org","booktitle":"Proceedings of the 33rd International Conference on International Conference on Machine Learning - Volume 48","pages":"2014–2023","numpages":"10","location":"New York, NY, USA","series":"ICML'16","type":"inproceedings"}],["spectral-clustering",{"author":"Ulrike von Luxburg","title":"A Tutorial on Spectral Clustering","journal":"CoRR","volume":"abs/0711.0189","year":"2007","url":"http://arxiv.org/abs/0711.0189","archivePrefix":"arXiv","eprint":"0711.0189","timestamp":"Mon, 13 Aug 2018 16:48:34 +0200","biburl":"https://dblp.org/rec/journals/corr/abs-0711-0189.bib","bibsource":"dblp computer science bibliography, https://dblp.org","archiveprefix":"arXiv","type":"article"}],["gnn-intro",{"author":"Sanchez-Lengeling, Benjamin and Reif, Emily and Pearce, Adam and Wiltschko, Alex","title":"A Gentle Introduction to Graph Neural Networks","journal":"Distill","year":"2021","note":"https://distill.pub/2021/gnn-intro","doi":"10.23915/distill.00033","type":"article"}]]</script></d-bibliography>

<script type="text/javascript" src="Understanding%20Convolutions%20on%20Graphs_files/index.js"></script>
<distill-footer>
<style>

:host {
  color: rgba(255, 255, 255, 0.5);
  font-weight: 300;
  padding: 2rem 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  background-color: hsl(180, 5%, 15%); /*hsl(200, 60%, 15%);*/
  text-align: left;
  contain: content;
}

.footer-container .logo svg {
  width: 24px;
  position: relative;
  top: 4px;
  margin-right: 2px;
}

.footer-container .logo svg path {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 3px;
}

.footer-container .logo {
  font-size: 17px;
  font-weight: 200;
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  margin-right: 6px;
}

.footer-container {
  grid-column: text;
}

.footer-container .nav {
  font-size: 0.9em;
  margin-top: 1.5em;
}

.footer-container .nav a {
  color: rgba(255, 255, 255, 0.8);
  margin-right: 6px;
  text-decoration: none;
}

</style>

<div class="footer-container">

  <a href="https://distill.pub/" class="logo">
    <svg viewBox="-607 419 64 64">
  <path d="M-573.4,478.9c-8,0-14.6-6.4-14.6-14.5s14.6-25.9,14.6-40.8c0,14.9,14.6,32.8,14.6,40.8S-565.4,478.9-573.4,478.9z"></path>
</svg>

    Distill
  </a> is dedicated to clear explanations of machine learning

  <div class="nav">
    <a href="https://distill.pub/about/">About</a>
    <a href="https://distill.pub/journal/">Submit</a>
    <a href="https://distill.pub/prize/">Prize</a>
    <a href="https://distill.pub/archive/">Archive</a>
    <a href="https://distill.pub/rss.xml">RSS</a>
    <a href="https://github.com/distillpub">GitHub</a>
    <a href="https://twitter.com/distillpub">Twitter</a>
    &nbsp;&nbsp;&nbsp;&nbsp; ISSN 2476-0757
  </div>

</div>

</distill-footer><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-83741880-1', 'auto');
  ga('send', 'pageview');
</script></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>