<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><script src="Feature%20Visualization_files/template.js"></script><style>body {transition: opacity ease-in 0.2s; } 
body[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } 
</style><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><script async="" src="Feature%20Visualization_files/analytics.js"></script><script>
window.addEventListener('WebComponentsReady', function() {
  console.warn('WebComponentsReady');
  const loaderTag = document.createElement('script');
  loaderTag.src = 'https://distill.pub/template.v2.js';
  document.head.insertBefore(loaderTag, document.head.firstChild);
});
</script><script src="Feature%20Visualization_files/webcomponents-loader.js"></script><script src="Feature%20Visualization_files/webcomponents-hi.js"></script>
  
  
  <style id="distill-prerendered-styles" type="text/css">/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

html {
  font-size: 14px;
	line-height: 1.6em;
  /* font-family: "Libre Franklin", "Helvetica Neue", sans-serif; */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  /*, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";*/
  text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}

@media(min-width: 768px) {
  html {
    font-size: 16px;
  }
}

body {
  margin: 0;
}

a {
  color: #004276;
}

figure {
  margin: 0;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}

table th {
	text-align: left;
}

table thead {
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

table thead th {
  padding-bottom: 0.5em;
}

table tbody :first-child td {
  padding-top: 0.5em;
}

pre {
  overflow: auto;
  max-width: 100%;
}

p {
  margin-top: 0;
  margin-bottom: 1em;
}

sup, sub {
  vertical-align: baseline;
  position: relative;
  top: -0.4em;
  line-height: 1em;
}

sub {
  top: 0.4em;
}

.kicker,
.marker {
  font-size: 15px;
  font-weight: 600;
  color: rgba(0, 0, 0, 0.5);
}


/* Headline */

@media(min-width: 1024px) {
  d-title h1 span {
    display: block;
  }
}

/* Figure */

figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

figcaption+figure {

}

figure img {
  width: 100%;
}

figure svg text,
figure svg tspan {
}

figcaption,
.figcaption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

@media(min-width: 1024px) {
figcaption,
.figcaption {
    font-size: 13px;
  }
}

figure.external img {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

figcaption a {
  color: rgba(0, 0, 0, 0.6);
}

figcaption b,
figcaption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@supports not (display: grid) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    display: block;
    padding: 8px;
  }
}

.base-grid,
distill-header,
d-title,
d-abstract,
d-article,
d-appendix,
distill-appendix,
d-byline,
d-footnote-list,
d-citation-list,
distill-footer {
  display: grid;
  justify-items: stretch;
  grid-template-columns: [screen-start] 8px [page-start kicker-start text-start gutter-start middle-start] 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr [text-end page-end gutter-end kicker-end middle-end] 8px [screen-end];
  grid-column-gap: 8px;
}

.grid {
  display: grid;
  grid-column-gap: 8px;
}

@media(min-width: 768px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start middle-start text-start] 45px 45px 45px 45px 45px 45px 45px 45px [ kicker-end text-end gutter-start] 45px [middle-end] 45px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }
}

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 50px [middle-start] 50px [text-start kicker-end] 50px 50px 50px 50px 50px 50px 50px 50px [text-end gutter-start] 50px [middle-end] 50px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}




.base-grid {
  grid-column: screen;
}

/* .l-body,
d-article > *  {
  grid-column: text;
}

.l-page,
d-title > *,
d-figure {
  grid-column: page;
} */

.l-gutter {
  grid-column: gutter;
}

.l-text,
.l-body {
  grid-column: text;
}

.l-page {
  grid-column: page;
}

.l-body-outset {
  grid-column: middle;
}

.l-page-outset {
  grid-column: page;
}

.l-screen {
  grid-column: screen;
}

.l-screen-inset {
  grid-column: screen;
  padding-left: 16px;
  padding-left: 16px;
}


/* Aside */

d-article aside {
  grid-column: gutter;
  font-size: 12px;
  line-height: 1.6em;
  color: rgba(0, 0, 0, 0.6)
}

@media(min-width: 768px) {
  aside {
    grid-column: gutter;
  }

  .side {
    grid-column: gutter;
  }
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-title {
  padding: 2rem 0 1.5rem;
  contain: layout style;
  overflow-x: hidden;
}

@media(min-width: 768px) {
  d-title {
    padding: 4rem 0 1.5rem;
  }
}

d-title h1 {
  grid-column: text;
  font-size: 40px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

@media(min-width: 768px) {
  d-title h1 {
    font-size: 50px;
  }
}

d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  grid-column: text;
}

d-title .status {
  margin-top: 0px;
  font-size: 12px;
  color: #009688;
  opacity: 0.8;
  grid-column: kicker;
}

d-title .status span {
  line-height: 1;
  display: inline-block;
  padding: 6px 0;
  border-bottom: 1px solid #80cbc4;
  font-size: 11px;
  text-transform: uppercase;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-byline {
  contain: style;
  overflow: hidden;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  font-size: 0.8rem;
  line-height: 1.8em;
  padding: 1.5rem 0;
  min-height: 1.8em;
}


d-byline .byline {
  grid-template-columns: 1fr 1fr;
  grid-column: text;
}

@media(min-width: 768px) {
  d-byline .byline {
    grid-template-columns: 1fr 1fr 1fr 1fr;
  }
}

d-byline .authors-affiliations {
  grid-column-end: span 2;
  grid-template-columns: 1fr 1fr;
  margin-bottom: 1em;
}

@media(min-width: 768px) {
  d-byline .authors-affiliations {
    margin-bottom: 0;
  }
}

d-byline h3 {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  margin: 0;
  text-transform: uppercase;
}

d-byline p {
  margin: 0;
}

d-byline a,
d-article d-byline a {
  color: rgba(0, 0, 0, 0.8);
  text-decoration: none;
  border-bottom: none;
}

d-article d-byline a:hover {
  text-decoration: underline;
  border-bottom: none;
}

d-byline p.author {
  font-weight: 500;
}

d-byline .affiliations {

}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

d-article {
  contain: layout style;
  overflow-x: hidden;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  padding-top: 2rem;
  color: rgba(0, 0, 0, 0.8);
}

d-article > * {
  grid-column: text;
}

@media(min-width: 768px) {
  d-article {
    font-size: 16px;
  }
}

@media(min-width: 1024px) {
  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
}


/* H2 */


d-article .marker {
  text-decoration: none;
  border: none;
  counter-reset: section;
  grid-column: kicker;
  line-height: 1.7em;
}

d-article .marker:hover {
  border: none;
}

d-article .marker span {
  padding: 0 3px 4px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  position: relative;
  top: 4px;
}

d-article .marker:hover span {
  color: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid rgba(0, 0, 0, 0.7);
}

d-article h2 {
  font-weight: 600;
  font-size: 24px;
  line-height: 1.25em;
  margin: 2rem 0 1.5rem 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 1rem;
}

@media(min-width: 1024px) {
  d-article h2 {
    font-size: 36px;
  }
}

/* H3 */

d-article h3 {
  font-weight: 700;
  font-size: 18px;
  line-height: 1.4em;
  margin-bottom: 1em;
  margin-top: 2em;
}

@media(min-width: 1024px) {
  d-article h3 {
    font-size: 20px;
  }
}

/* H4 */

d-article h4 {
  font-weight: 600;
  text-transform: uppercase;
  font-size: 14px;
  line-height: 1.4em;
}

d-article a {
  color: inherit;
}

d-article p,
d-article ul,
d-article ol,
d-article blockquote {
  margin-top: 0;
  margin-bottom: 1em;
  margin-left: 0;
  margin-right: 0;
}

d-article blockquote {
  border-left: 2px solid rgba(0, 0, 0, 0.2);
  padding-left: 2em;
  font-style: italic;
  color: rgba(0, 0, 0, 0.6);
}

d-article a {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  text-decoration: none;
}

d-article a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.8);
}

d-article .link {
  text-decoration: underline;
  cursor: pointer;
}

d-article ul,
d-article ol {
  padding-left: 24px;
}

d-article li {
  margin-bottom: 1em;
  margin-left: 0;
  padding-left: 0;
}

d-article li:last-child {
  margin-bottom: 0;
}

d-article pre {
  font-size: 14px;
  margin-bottom: 20px;
}

d-article hr {
  grid-column: screen;
  width: 100%;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  margin-top: 60px;
  margin-bottom: 60px;
}

d-article section {
  margin-top: 60px;
  margin-bottom: 60px;
}

d-article span.equation-mimic {
  font-family: georgia;
  font-size: 115%;
  font-style: italic;
}

d-article > d-code,
d-article section > d-code  {
  display: block;
}

d-article > d-math[block],
d-article section > d-math[block]  {
  display: block;
}

@media (max-width: 768px) {
  d-article > d-code,
  d-article section > d-code,
  d-article > d-math[block],
  d-article section > d-math[block] {
      overflow-x: scroll;
      -ms-overflow-style: none;  // IE 10+
      overflow: -moz-scrollbars-none;  // Firefox
  }

  d-article > d-code::-webkit-scrollbar,
  d-article section > d-code::-webkit-scrollbar,
  d-article > d-math[block]::-webkit-scrollbar,
  d-article section > d-math[block]::-webkit-scrollbar {
    display: none;  // Safari and Chrome
  }
}

d-article .citation {
  color: #668;
  cursor: pointer;
}

d-include {
  width: auto;
  display: block;
}

d-figure {
  contain: layout style;
}

/* KaTeX */

.katex, .katex-prerendered {
  contain: style;
  display: inline-block;
}

/* Tables */

d-article table {
  border-collapse: collapse;
  margin-bottom: 1.5rem;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

d-article table th {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

d-article table td {
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

d-article table tr:last-of-type td {
  border-bottom: none;
}

d-article table th,
d-article table td {
  font-size: 15px;
  padding: 2px 8px;
}

d-article table tbody :first-child td {
  padding-top: 2px;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

span.katex-display {
  text-align: left;
  padding: 8px 0 8px 0;
  margin: 0.5em 0 0.5em 1em;
}

span.katex {
  -webkit-font-smoothing: antialiased;
  color: rgba(0, 0, 0, 0.8);
  font-size: 1.18em;
}
/*
 * Copyright 2018 The Distill Template Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@media print {

  @page {
    size: 8in 11in;
    @bottom-right {
      content: counter(page) " of " counter(pages);
    }
  }

  html {
    /* no general margins -- CSS Grid takes care of those */
  }

  p, code {
    page-break-inside: avoid;
  }

  h2, h3 {
    page-break-after: avoid;
  }

  d-header {
    visibility: hidden;
  }

  d-footer {
    display: none!important;
  }

}
</style>
  <style>
    .optimize-nojitter-sprite {
  background-image: url("images/optimize_nojitter_sprite_128.jpeg");
}
.optimize-jitter-sprite {
  background-image: url("images/optimize_jitter_sprite_128.jpeg");
}
.steepst-dir-sprite {
  background-image: url("images/steepest_dir_spritemap_14.jpg");
}
.interpolation-sprite {
  background-image: url("images/interpolation.jpg");
}
d-fn {
  line-height: 100%;
}
.example-vis {
  display: flex;
  flex-wrap: wrap;
  flex-flow: row;
  /*align-items: center;*/
  justify-content: space-between;
  align-items: flex-start;
  min-height: 240px;
}
.example-vis > .chunk {
  /*width: calc(3 * 64px + 3 * 2px);*/
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  flex-flow: column;
  flex-wrap: wrap;
  align-items: flex-start;
  /*--padding-right: 46px;*/
  /*padding-right: 24px;*/
}
.example-vis > .chunk:last-child {
  padding-right: 0px;
}
.example-vis > .chunk > img {
  width: 64px;
  height: 64px;
  padding-right: 1px;
  padding-bottom: 1px;
  display: block;
}
.example-vis > .chunk > img:first {
  padding-bottom: 10px;
}
.example-vis > .chunk > .big {
  width: 147px;
  height: 147px;
}
.example-vis > .chunk > figcaption {
  margin-top: 15px;
}

.example-vis2 {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  flex-wrap: wrap;
  /*align-items: center;*/
  justify-content: flex-start;
  align-items: flex-start;
}

.example-vis2 > .chunk > img {
  width: 170px;
  height: 170px;
  padding-right: 10px;
}
.example-vis2 > .chunk > figcaption {
  margin-top: 5px;
}

.draft {
  border-left: 2px solid orange;
  padding-left: 5px;
  /*font-family: "Comic Sans MS", fantasy;*/
  color: orange;
}

d-slider {
  width: 100%;
}

d-title figure {
  margin: 0;
}

.shaded-figure {
  background-color: hsl(0, 0%, 97%);
  border-top: 1px solid hsla(0, 0%, 0%, 0.1);
  border-bottom: 1px solid hsla(0, 0%, 0%, 0.1);
  padding: 30px 0;
}

code,
tt {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 90%;
  background-color: hsl(0, 0%, 96%);
  border-radius: 3px;
}

figcaption code,
figcaption tt {
  color: rgba(0, 0, 0, 0.7);
}

code::before, 
code::after,
tt::before, 
tt::after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

figcaption,
.figcaption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

@media(min-width: 1024px) {
figcaption,
.figcaption {
    font-size: 13px;
  }
}

#fv-vs-attribution {
  grid-auto-rows: 1fr; 
  grid-row-gap: 30px;
  grid-column-gap: 30px;
  margin: 1em 0 1.5em 0;
}

#fv-vs-attribution .images {
  display: grid; 
  grid-auto-columns: 1fr; 
  grid-auto-flow: column; 
  grid-column-gap: 5px;
}

#fv-vs-attribution figcaption {
   padding-top: 0.5em;
}

@media(min-width: 512px) {
  #fv-vs-attribution {
    grid-auto-columns: 1fr; 
    grid-auto-flow: column; 
    margin: 1em 0 1.5em 0;
  }
  
  #fv-vs-attribution .images {
    grid-column-gap: 10px;
  }
}

/* Min-Height anti-reflow opgtimizations */

/*
#googlenet-examples {
  grid-column: left / text;
  min-height: 363px;
}
#example-optimization-comparison {
  min-height: 368px;
}
#optimization-and-examples {
  min-height: 276px;
}

@media (min-width: 960px) {
  #example-optimization-comparison {
    min-height: 418px;
  }
}

@media (min-width: 1105px) {
  #googlenet-examples {
    grid-column: start / end;
  }
}

@media (min-width: 1400px) {
  #googlenet-examples {
    min-height: 412px;
  }
}*/
  </style>
<link rel="stylesheet" href="Feature%20Visualization_files/katex.css" crossorigin="anonymous">
    
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA99JREFUeNrsG4t1ozDMzQSM4A2ODUonKBucN2hugtIJ6E1AboLcBiQTkJsANiAb9OCd/OpzMWBJBl5TvaeXPiiyJetry0J8wW3D3QpjRh3GjneXDq+fSQA9s2mH9x3KDhN4foJfCb8N/Jrv+2fnDn8vLRQOplWHVYdvHZYdZsBcZP1vBmh/n8DzEmhUQDPaOuP9pFuY+JwJHwHnCLQE2tnWBGEyXozY9xCUgHMhhjE2I4heVWtgIkZ83wL6Qgxj1obfWBxymPwe+b00BCCRNPbwfb60yleAkkBHGT5AEehIYz7eJrFDMF9CvH4wwhcGHiHMneFvLDQwlwvMLQq58trRcYBWfYn0A0OgHWQUSu25mE+BnoYKnnEJoeIWAifzOv7vLWd2ZKRfWAIme3tOiUaQ3UnLkb0xj1FxRIeEGKaGIHOs9nEgLaaA9i0JRYo1Ic67wJW86KSKE/ZAM8KuVMk8ITVhmxUxJ3Cl2xlm9Vtkeju1+mpCQNxaEGNCY8bs9X2YqwNoQeGjBWut/ma0QAWy/TqAsHx9wSya3I5IRxOfTC+leG+kA/4vSeEcGBtNUN6byhu3+keEZCQJUNh8MAO7HL6H8pQLnsW/Hd4T4lv93TPjfM7A46iEEqbB5EDOvwYNW6tGNZzT/o+CZ6sqZ6wUtR/wf7mi/VL8iNciT6rHih48Y55b4nKCHJCCzb4y0nwFmin3ZEMIoLfZF8F7nncFmvnWBaBj7CGAYA/WGJsUwHdYqVDwAmNsUgAx4CGgAA7GOOxADYOFWOaIKifuVYzmOpREqA21Mo7aPsgiY1PhOMAmxtR+AUbYH3Id2wc0SAFIQTsn9IUGWR8k9jx3vtXSiAacFxTAGakBk9UudkNECd6jLe+6HrshshvIuC6IlLMRy7er+JpcKma24SlE4cFZSZJDGVVrsNvitQhQrDhW0jfiOLfFd47C42eHT56D/BK0To+58Ahj+cAT8HT1UWlfLZCCd/uKawzU0Rh2EyIX/Icqth3niG8ybNroezwe6khdCNxRN+l4XGdOLVLlOOt2hTRJlr1ETIuMAltVTMz70mJrkdGAaZLSmnBEqmAE32JCMmuTlCnRgsBENtOUpHhvvsYIL0ibnBkaC6QvKcR7738GKp0AKnim7xgUSNv1bpS8QwhBt8r+EP47v/oyRK/S34yJ9nT+AN0Tkm4OdB9E4BsmXM3SnMlRFUrtp6IDpV2eKzdYvF3etm3KhQksbOLChGkSmcBdmcEwvqkrMy5BzL00NZeu3qPYJOOuCc+5NjcWKXQxFvTa3NoXJ4d8in7fiAUuTt781dkvuHX4K8AA2Usy7yNKLy0AAAAASUVORK5CYII=">
    <link href="https://distill.pub/rss.xml" rel="alternate" type="application/rss+xml" title="Articles from Distill">
  
    <title>Feature Visualization</title>
    
    <link rel="canonical" href="https://distill.pub/2017/feature-visualization">
    
    <!--  https://schema.org/Article -->
    <meta property="description" itemprop="description" content="How neural networks build up their understanding of images">
    <meta property="article:published" itemprop="datePublished" content="2017-11-07">
    <meta property="article:created" itemprop="dateCreated" content="2017-11-07">
    
    <meta property="article:modified" itemprop="dateModified" content="2019-08-28T00:26:22.000Z">
    
    <meta property="article:author" content="Chris Olah">
    <meta property="article:author" content="Alexander Mordvintsev">
    <meta property="article:author" content="Ludwig Schubert">
    <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Feature Visualization">
    <meta property="og:description" content="How neural networks build up their understanding of images">
    <meta property="og:url" content="https://distill.pub/2017/feature-visualization">
    <meta property="og:image" content="https://distill.pub/2017/feature-visualization/thumbnail.jpg">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Distill">
  
    <!--  https://dev.twitter.com/cards/types/summary -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Feature Visualization">
    <meta name="twitter:description" content="How neural networks build up their understanding of images">
    <meta name="twitter:url" content="https://distill.pub/2017/feature-visualization">
    <meta name="twitter:image" content="https://distill.pub/2017/feature-visualization/thumbnail.jpg">
    <meta name="twitter:image:width" content="560">
    <meta name="twitter:image:height" content="295">
  
      <!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
    <meta name="citation_title" content="Feature Visualization">
    <meta name="citation_fulltext_html_url" content="https://distill.pub/2017/feature-visualization">
    <meta name="citation_volume" content="2">
    <meta name="citation_issue" content="11">
    <meta name="citation_firstpage" content="e7">
    <meta name="citation_doi" content="10.23915/distill.00007">
    <meta name="citation_journal_title" content="Distill">
    <meta name="citation_journal_abbrev" content="Distill">
    <meta name="citation_issn" content="2476-0757">
    <meta name="citation_fulltext_world_readable" content="">
    <meta name="citation_online_date" content="2017/11/07">
    <meta name="citation_publication_date" content="2017/11/07">
    <meta name="citation_author" content="Olah, Chris">
    <meta name="citation_author_institution" content="Google Brain Team">
    <meta name="citation_author" content="Mordvintsev, Alexander">
    <meta name="citation_author_institution" content="Google Research">
    <meta name="citation_author" content="Schubert, Ludwig">
    <meta name="citation_author_institution" content="Google Brain Team">
    <meta name="citation_reference" content="citation_title=Going deeper with convolutions;citation_author=Christian Szegedy;citation_author=Wei Liu;citation_author=Yangqing Jia;citation_author=Pierre Sermanet;citation_author=Scott Reed;citation_author=Dragomir Anguelov;citation_author=Dumitru Erhan;citation_author=Vincent Vanhoucke;citation_author=Andrew Rabinovich;citation_publication_date=2015;citation_arxiv_id=1409.4842;">
    <meta name="citation_reference" content="citation_title=Imagenet: A large-scale hierarchical image database;citation_author=Jia Deng;citation_author=Wei Dong;citation_author=Richard Socher;citation_author=Li-Jia Li;citation_author=Kai Li;citation_author=Li Fei-Fei;citation_publication_date=2009;">
    <meta name="citation_reference" content="citation_title=Visualizing higher-layer features of a deep network;citation_author=Dumitru Erhan;citation_author=Yoshua Bengio;citation_author=Aaron Courville;citation_author=Pascal Vincent;citation_publication_date=2009;citation_journal_title=University of Montreal;citation_volume=1341;">
    <meta name="citation_reference" content="citation_title=Inceptionism: Going deeper into neural networks;citation_author=Alexander Mordvintsev;citation_author=Christopher Olah;citation_author=Mike Tyka;citation_publication_date=2015;citation_journal_title=Google Research Blog;">
    <meta name="citation_reference" content="citation_title=Deep inside convolutional networks: Visualising image classification models and saliency maps;citation_author=Karen Simonyan;citation_author=Andrea Vedaldi;citation_author=Andrew Zisserman;citation_publication_date=2013;citation_arxiv_id=1312.6034;">
    <meta name="citation_reference" content="citation_title=A neural algorithm of artistic style;citation_author=Leon A Gatys;citation_author=Alexander S Ecker;citation_author=Matthias Bethge;citation_publication_date=2015;citation_arxiv_id=1508.06576;">
    <meta name="citation_reference" content="citation_title=Understanding deep image representations by inverting them;citation_author=Aravindh Mahendran;citation_author=Andrea Vedaldi;citation_publication_date=2015;">
    <meta name="citation_reference" content="citation_title=Understanding Intra-Class Knowledge Inside {CNN};citation_author=Donglai Wei;citation_author=Bolei Zhou;citation_author=Antonio Torralba;citation_author=William T. Freeman;citation_publication_date=2015;citation_arxiv_id=1507.02379;">
    <meta name="citation_reference" content="citation_title=Multifaceted feature visualization: Uncovering the different types of features learned by each neuron in deep neural networks;citation_author=Anh Nguyen;citation_author=Jason Yosinski;citation_author=Jeff Clune;citation_publication_date=2016;citation_arxiv_id=1602.03616;">
    <meta name="citation_reference" content="citation_title=Plug &amp; play generative networks: Conditional iterative generation of images in latent space;citation_author=Anh Nguyen;citation_author=Jason Yosinski;citation_author=Yoshua Bengio;citation_author=Alexey Dosovitskiy;citation_author=Jeff Clune;citation_publication_date=2016;citation_arxiv_id=1612.00005;">
    <meta name="citation_reference" content="citation_title=Intriguing properties of neural networks;citation_author=Christian Szegedy;citation_author=Wojciech Zaremba;citation_author=Ilya Sutskever;citation_author=Joan Bruna;citation_author=Dumitru Erhan;citation_author=Ian Goodfellow;citation_author=Rob Fergus;citation_publication_date=2013;citation_arxiv_id=1312.6199;">
    <meta name="citation_reference" content="citation_title=Network Dissection: Quantifying Interpretability of Deep Visual Representations;citation_author=David Bau;citation_author=Bolei Zhou;citation_author=Aditya Khosla;citation_author=Aude Oliva;citation_author=Antonio Torralba;citation_publication_date=2017;citation_arxiv_id=1704.05796;">
    <meta name="citation_reference" content="citation_title=Deconvolution and checkerboard artifacts;citation_author=Augustus Odena;citation_author=Vincent Dumoulin;citation_author=Chris Olah;citation_publication_date=2016;citation_journal_title=Distill;citation_volume=1;citation_number=10;">
    <meta name="citation_reference" content="citation_title=Deep neural networks are easily fooled: High confidence predictions for unrecognizable images;citation_author=Anh Nguyen;citation_author=Jason Yosinski;citation_author=Jeff Clune;citation_publication_date=2015;citation_arxiv_id=1412.1897;">
    <meta name="citation_reference" content="citation_title=Visualizing GoogLeNet Classes;citation_author=Audun Øygard;citation_publication_date=2015;">
    <meta name="citation_reference" content="citation_title=Class visualization with bilateral filters;citation_author=Mike Tyka;citation_publication_date=2016;">
    <meta name="citation_reference" content="citation_title=DeepDreaming with TensorFlow;citation_author=Alexander Mordvintsev;citation_publication_date=2016;">
    <meta name="citation_reference" content="citation_title=Synthesizing the preferred inputs for neurons in neural networks via deep generator networks;citation_author=Anh Nguyen;citation_author=Alexey Dosovitskiy;citation_author=Jason Yosinski;citation_author=Thomas Brox;citation_author=Jeff Clune;citation_publication_date=2016;citation_arxiv_id=1605.09304;">
    <meta name="citation_reference" content="citation_title=Tensorflow: Large-scale machine learning on heterogeneous distributed systems;citation_author=Mart{\'i}n Abadi;citation_author=Ashish Agarwal;citation_author=Paul Barham;citation_author=Eugene Brevdo;citation_author=Zhifeng Chen;citation_author=Craig Citro;citation_author=Gregory S. Corrado;citation_author=Andy Davis;citation_author=Jeffrey Dean;citation_author=Matthieu Devin;citation_author=Sanjay Ghemawat;citation_author=Ian J. Goodfellow;citation_author=Andrew Harp;citation_author=Geoffrey Irving;citation_author=Michael Isard;citation_author=Yangqing Jia;citation_author=Rafal J{\'{o}}zefowicz;citation_author=Lukasz Kaiser;citation_author=Manjunath Kudlur;citation_author=Josh Levenberg;citation_author=Dan Man{\'{e}};citation_author=Rajat Monga;citation_author=Sherry Moore;citation_author=Derek Gordon Murray;citation_author=Chris Olah;citation_author=Mike Schuster;citation_author=Jonathon Shlens;citation_author=Benoit Steiner;citation_author=Ilya Sutskever;citation_author=Kunal Talwar;citation_author=Paul A. Tucker;citation_author=Vincent Vanhoucke;citation_author=Vijay Vasudevan;citation_author=Fernanda B. Vi{\'{e}}gas;citation_author=Oriol Vinyals;citation_author=Pete Warden;citation_author=Martin Wattenberg;citation_author=Martin Wicke;citation_author=Yuan Yu;citation_author=Xiaoqiang Zheng;citation_publication_date=2016;citation_arxiv_id=1603.04467;">
<style id="svelte-3261002896-style">[svelte-3261002896].sprite_hero,[svelte-3261002896] .sprite_hero{background-image:url("images/sprite_hero.png")}[svelte-3261002896].googlenet-examples,[svelte-3261002896] .googlenet-examples{font-size:16px;display:flex;flex-flow:column;align-items:center}[svelte-3261002896].googlenet-examples .example,[svelte-3261002896] .googlenet-examples .example{display:flex;flex-flow:column}[svelte-3261002896].googlenet-examples .example .images,[svelte-3261002896] .googlenet-examples .example .images{display:flex;flex-flow:row;flex-wrap:wrap;justify-content:flex-start}[svelte-3261002896].googlenet-examples .example .images > *,[svelte-3261002896] .googlenet-examples .example .images > *{margin-bottom:5px;margin-right:5px}[svelte-3261002896].googlenet-examples .inner,[svelte-3261002896] .googlenet-examples .inner{image-rendering:auto}[svelte-3261002896].googlenet-examples .example .images span:last-of-type,[svelte-3261002896] .googlenet-examples .example .images span:last-of-type{margin-bottom:0}[svelte-3261002896].googlenet-examples .example:last-of-type,[svelte-3261002896] .googlenet-examples .example:last-of-type{}[svelte-3261002896].googlenet-examples > div:last-child,[svelte-3261002896] .googlenet-examples > div:last-child{}[svelte-3261002896].description,[svelte-3261002896] .description{width:100%;margin-top:0.25em;margin-bottom:1.5em;color:rgba(0, 0, 0, 0.9);line-height:normal;font-size:0.8em}@media(min-width: 1105px){[svelte-3261002896].googlenet-examples,[svelte-3261002896] .googlenet-examples{grid-column:screen;flex-flow:row;justify-content:center}[svelte-3261002896].googlenet-examples .example .images,[svelte-3261002896] .googlenet-examples .example .images{flex-wrap:wrap}[svelte-3261002896].googlenet-examples .example,[svelte-3261002896] .googlenet-examples .example{margin-right:10px}[svelte-3261002896].googlenet-examples .example:last-of-type,[svelte-3261002896] .googlenet-examples .example:last-of-type{margin-right:0}[svelte-3261002896].googlenet-examples .example .images,[svelte-3261002896] .googlenet-examples .example .images{max-width:calc((100px * 2) + 10px);min-height:calc((100px * 3) + 10px)}}@media(min-width: 1400px){[svelte-3261002896].googlenet-examples .example,[svelte-3261002896] .googlenet-examples .example{margin-right:15px}[svelte-3261002896].googlenet-examples .example .images,[svelte-3261002896] .googlenet-examples .example .images{max-width:calc((125px * 2) + 10px);min-height:calc((125px * 3) + 10px)}}</style><style id="svelte-986317898-style">[svelte-986317898].outer,[svelte-986317898] .outer{position:relative;float:left;width:var(--container-size);height:var(--container-size)}[svelte-986317898].mid,[svelte-986317898] .mid,[svelte-986317898].inner,[svelte-986317898] .inner{transition:var(--transition_css);pointer-events:none}[svelte-986317898].mid,[svelte-986317898] .mid{transform:scale( var(--default-ratio) );margin:calc( calc( var(--container-size) - var(--default-size) ) / 2 )}[svelte-986317898].inner,[svelte-986317898] .inner{image-rendering:var(--pixelated);background-position:var(--default-position);width:var(--default-size);height:var(--default-size)}[svelte-986317898].outer.hoverable:hover,[svelte-986317898] .outer.hoverable:hover{z-index:100}[svelte-986317898].outer.hoverable:hover .inner,[svelte-986317898] .outer.hoverable:hover .inner{background-position:var(--hover-position);width:var(--hover-size);height:var(--hover-size)}[svelte-986317898].outer.hoverable:hover .mid,[svelte-986317898] .outer.hoverable:hover .mid{transform:scale(var(--hover-scale));margin:calc( calc( var(--container-size) - var(--hover-size) ) / 2 );border:var(--border_css);width:var(--hover-size)}</style><style id="svelte-3193739540-style">[svelte-3193739540].colab-root,[svelte-3193739540] .colab-root{display:inline-block;background:rgba(255, 255, 255, 0.75);padding:4px 8px;border-radius:4px;font-size:11px!important;text-decoration:none;color:#aaa;border:none;font-weight:300;border:solid 1px rgba(0, 0, 0, 0.08);border-bottom-color:rgba(0, 0, 0, 0.15);text-transform:uppercase;line-height:16px}span[svelte-3193739540],[svelte-3193739540] span{background-image:url(images/colab.svg);background-repeat:no-repeat;background-size:20px;background-position-y:2px;display:inline-block;padding-left:24px;border-radius:4px;text-decoration:none}a[svelte-3193739540]:hover,[svelte-3193739540] a:hover{color:#666;background:white;border-color:rgba(0, 0, 0, 0.2)}</style><style id="svelte-3927223486-style">[svelte-3927223486].sprite_opt_progress,[svelte-3927223486] .sprite_opt_progress{background-image:url("images/opt_progress_mixed4a-11.png")}[svelte-3927223486].container,[svelte-3927223486] .container{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:stretch;margin-bottom:5px}[svelte-3927223486].container > div,[svelte-3927223486] .container > div{}[svelte-3927223486].container .sprite,[svelte-3927223486] .container .sprite{align-self:stretch}[svelte-3927223486].container .arrowbox,[svelte-3927223486] .container .arrowbox{color:#888;display:flex;align-items:center;margin-left:5px;margin-right:5px;width:14px}</style><style id="svelte-3700122413-style">[svelte-3700122413].sprite_examples_opt_comparison_examples,[svelte-3700122413] .sprite_examples_opt_comparison_examples{background-image:url("images/why_optimization_examples.jpg")}[svelte-3700122413].sprite_examples_opt_comparison,[svelte-3700122413] .sprite_examples_opt_comparison{background-image:url("images/why_optimization_neuron.png")}[svelte-3700122413].captions,[svelte-3700122413] .captions,[svelte-3700122413].images,[svelte-3700122413] .images{display:flex;flex-flow:row;justify-content:flex-start}[svelte-3700122413].images > div,[svelte-3700122413] .images > div{margin-bottom:10px;margin-right:10px}[svelte-3700122413].images > div:last-of-type,[svelte-3700122413] .images > div:last-of-type{margin-right:0}[svelte-3700122413].captions > figcaption,[svelte-3700122413] .captions > figcaption{display:inline-block;width:147px;margin-right:10px}[svelte-3700122413].captions > figcaption:last-of-type,[svelte-3700122413] .captions > figcaption:last-of-type{margin-right:0}@media(min-width: 1280px){[svelte-3700122413].captions > figcaption,[svelte-3700122413] .captions > figcaption{width:170px}}</style><style id="svelte-3177516282-style">[svelte-3177516282].opt-and-examples-sprite,[svelte-3177516282] .opt-and-examples-sprite{background-image:url("images/examples.jpg")}[svelte-3177516282].opt-and-examples-optimized-sprite,[svelte-3177516282] .opt-and-examples-optimized-sprite{background-image:url("images/examples_optimized.png")}[svelte-3177516282].icons,[svelte-3177516282] .icons{display:inline-flex;flex-wrap:wrap;flex-direction:row;border-bottom:1px solid #dddddd}[svelte-3177516282].icons .icon,[svelte-3177516282] .icons .icon{cursor:pointer;padding-bottom:5px;margin-bottom:-1px;margin-right:4px;margin-top:3px}[svelte-3177516282].icons .icon:first-of-type,[svelte-3177516282] .icons .icon:first-of-type{margin-left:0px}[svelte-3177516282].icons .icon:last-of-type,[svelte-3177516282] .icons .icon:last-of-type{margin-right:0px}[svelte-3177516282].icons .icon.selected,[svelte-3177516282] .icons .icon.selected{border-bottom:3px solid #ff6600}[svelte-3177516282].icon div,[svelte-3177516282] .icon div{opacity:0.666;image-rendering:auto}[svelte-3177516282].icon.selected div,[svelte-3177516282] .icon.selected div{opacity:1}[svelte-3177516282].container,[svelte-3177516282] .container{grid-column:text;margin-top:25px;display:flex;flex-flow:column;flex-direction:column-reverse}[svelte-3177516282].positive,[svelte-3177516282] .positive,[svelte-3177516282].negative,[svelte-3177516282] .negative,[svelte-3177516282].divider,[svelte-3177516282] .divider{display:flex;flex-flow:row}[svelte-3177516282].container figcaption,[svelte-3177516282] .container figcaption{padding-top:5px}[svelte-3177516282].divider,[svelte-3177516282] .divider{display:none;margin-left:12px;margin-right:12px}[svelte-3177516282].positive > div,[svelte-3177516282] .positive > div{justify-content:flex-start}[svelte-3177516282].optimize,[svelte-3177516282] .optimize{}[svelte-3177516282].positive,[svelte-3177516282] .positive{margin-bottom:24px}[svelte-3177516282].optimize figcaption,[svelte-3177516282] .optimize figcaption{margin-left:0;margin-right:0}[svelte-3177516282].optimize,[svelte-3177516282] .optimize{display:flex;flex-flow:column;margin-bottom:12px}[svelte-3177516282].examples,[svelte-3177516282] .examples{display:flex;flex-flow:row}[svelte-3177516282].example-set,[svelte-3177516282] .example-set{display:flex;flex-flow:column;margin-right:12px}[svelte-3177516282].example-set > *,[svelte-3177516282] .example-set > *,[svelte-3177516282].optimize > *,[svelte-3177516282] .optimize > *{width:147px}[svelte-3177516282].example-set > div,[svelte-3177516282] .example-set > div,[svelte-3177516282].optimize > div,[svelte-3177516282] .optimize > div{height:147px}[svelte-3177516282].positive .examples,[svelte-3177516282] .positive .examples{flex-flow:row-reverse}[svelte-3177516282].positive .optimize,[svelte-3177516282] .positive .optimize{margin-right:24px}[svelte-3177516282].negative .optimize,[svelte-3177516282] .negative .optimize{margin-right:24px}@media(min-width: 1280px){[svelte-3177516282].divider,[svelte-3177516282] .divider{display:inherit;border-left:1px solid #ccc;position:relative}[svelte-3177516282].divider::before,[svelte-3177516282] .divider::before{content:"0";position:absolute;left:-4px;top:-25px;color:#ccc;font-weight:300;font-size:13px}[svelte-3177516282].example-set,[svelte-3177516282] .example-set{margin-right:0}[svelte-3177516282].example-set:first-child,[svelte-3177516282] .example-set:first-child{margin-right:12px}[svelte-3177516282].negative,[svelte-3177516282] .negative{margin-bottom:0}[svelte-3177516282].negative .optimize,[svelte-3177516282] .negative .optimize{flex-flow:column;justify-content:flex-start}[svelte-3177516282].container,[svelte-3177516282] .container{grid-column:page;flex-flow:row}[svelte-3177516282].positive,[svelte-3177516282] .positive{flex-flow:row-reverse}[svelte-3177516282].positive .examples,[svelte-3177516282] .positive .examples{flex-flow:row}[svelte-3177516282].negative,[svelte-3177516282] .negative,[svelte-3177516282].divider,[svelte-3177516282] .divider{display:flex;flex-flow:row}[svelte-3177516282].optimize,[svelte-3177516282] .optimize{margin-bottom:24px}[svelte-3177516282].negative > div,[svelte-3177516282] .negative > div{justify-content:flex-end}[svelte-3177516282].positive .optimize,[svelte-3177516282] .positive .optimize{margin-left:36px}[svelte-3177516282].negative .optimize,[svelte-3177516282] .negative .optimize{margin-right:36px}}</style><style id="svelte-887141927-style">figcaption[svelte-887141927],[svelte-887141927] figcaption{display:block}[svelte-887141927].frow,[svelte-887141927] .frow{display:flex;flex-flow:row;flex-wrap:wrap;justify-content:flex-start}[svelte-887141927].fcolumn,[svelte-887141927] .fcolumn{display:flex;flex-flow:column;margin-right:10px}[svelte-887141927].fcolumn:last-of-type,[svelte-887141927] .fcolumn:last-of-type{margin-right:0}[svelte-887141927].fcolumn > *,[svelte-887141927] .fcolumn > *{margin-bottom:10px}[svelte-887141927].fcolumn > *:last-child,[svelte-887141927] .fcolumn > *:last-child{margin-bottom:0}[svelte-887141927].sprite_random_opt_examples,[svelte-887141927] .sprite_random_opt_examples{background-image:url("images/random_optimization_examples.jpg")}[svelte-887141927].sprite_random_opt,[svelte-887141927] .sprite_random_opt{background-image:url("images/random_optimization.png")}[svelte-887141927].column > div,[svelte-887141927] .column > div{margin-bottom:10px}</style><style id="svelte-127339819-style">[svelte-127339819].frow,[svelte-127339819] .frow{display:flex;flex-flow:row;flex-wrap:wrap;justify-content:flex-start}[svelte-127339819].fcolumn,[svelte-127339819] .fcolumn{display:flex;flex-flow:column;margin-right:10px;margin-bottom:10px;z-index:2}[svelte-127339819].icons,[svelte-127339819] .icons{display:flex;flex-wrap:wrap;flex-direction:row;margin-bottom:7px;max-width:100px}[svelte-127339819].icons .icon,[svelte-127339819] .icons .icon{cursor:pointer;padding-bottom:6px;margin-bottom:11px;margin-right:6px;border-bottom:1px solid #dddddd}[svelte-127339819].icons .icon.selected,[svelte-127339819] .icons .icon.selected{opacity:100%;padding-bottom:3px;border-bottom:3px solid #ff6600}[svelte-127339819].icon div,[svelte-127339819] .icon div{opacity:0.666;image-rendering:auto}[svelte-127339819].icon.selected div,[svelte-127339819] .icon.selected div{opacity:1}[svelte-127339819].linear_combinations_sprite,[svelte-127339819] .linear_combinations_sprite{background-image:url('images/linear_combinations.jpg')
  }[svelte-127339819]#caption,[svelte-127339819] #caption{max-width:200px}[svelte-127339819]#icons-first,[svelte-127339819] #icons-first{order:1
  }[svelte-127339819]#sprite-first,[svelte-127339819] #sprite-first{order:2
  }[svelte-127339819]#sprite-second,[svelte-127339819] #sprite-second{order:5
  }[svelte-127339819]#icons-second,[svelte-127339819] #icons-second{order:4
  }[svelte-127339819].result,[svelte-127339819] .result{z-index:3}[svelte-127339819].operator,[svelte-127339819] .operator{display:none}@media(min-width: 1024px){[svelte-127339819].fcolumn,[svelte-127339819] .fcolumn{margin-left:10px}[svelte-127339819].fcolumn:first-of-type,[svelte-127339819] .fcolumn:first-of-type{margin-left:0}[svelte-127339819].fcolumn:last-of-type,[svelte-127339819] .fcolumn:last-of-type{margin-right:0}[svelte-127339819]#icons-first,[svelte-127339819] #icons-first{order:1
    }[svelte-127339819]#sprite-first,[svelte-127339819] #sprite-first{order:2;margin-right:0}[svelte-127339819]#sprite-second,[svelte-127339819] #sprite-second{order:4;margin-left:0}[svelte-127339819]#icons-second,[svelte-127339819] #icons-second{order:5
    }[svelte-127339819].operator,[svelte-127339819] .operator{display:block;background-image:url(images/join_arrow.svg);background-position:center 70%;background-repeat:no-repeat;background-size:280%;min-width:60px;height:180px;overflow:visible;order:3;opacity:0.33}[svelte-127339819].result.c,[svelte-127339819] .result.c{top:-64px;margin-left:240px;position:relative}[svelte-127339819].result.c > div,[svelte-127339819] .result.c > div{border:2px solid white;box-shadow:0px 5px 20px hsla(0,0%,0%,0.3)}[svelte-127339819]#sprite-second > span,[svelte-127339819] #sprite-second > span{text-align:right}[svelte-127339819].linear-combinations,[svelte-127339819] .linear-combinations{margin-bottom:-84px}}</style><style id="svelte-4203530351-style">[svelte-4203530351].icons,[svelte-4203530351] .icons{display:inline-flex;flex-wrap:wrap;flex-direction:row;margin-bottom:8px;border-bottom:1px solid #dddddd}[svelte-4203530351].icons .icon,[svelte-4203530351] .icons .icon{cursor:pointer;padding-bottom:5px;margin-bottom:-1px;margin-left:3px;margin-right:3px}[svelte-4203530351].icons .icon:first-of-type,[svelte-4203530351] .icons .icon:first-of-type{margin-left:0px}[svelte-4203530351].icons .icon:last-of-type,[svelte-4203530351] .icons .icon:last-of-type{margin-right:0px}[svelte-4203530351].icons .icon.selected,[svelte-4203530351] .icons .icon.selected{opacity:100%;border-bottom:3px solid #ff6600}[svelte-4203530351].icon div,[svelte-4203530351] .icon div{opacity:0.666;image-rendering:auto}[svelte-4203530351].icon.selected div,[svelte-4203530351] .icon.selected div{opacity:1}[svelte-4203530351].images,[svelte-4203530351] .images{display:flex;flex-wrap:wrap;flex-direction:row;top:0px}[svelte-4203530351].images > div,[svelte-4203530351] .images > div{margin-right:5px}[svelte-4203530351].images > div:last-child,[svelte-4203530351] .images > div:last-child{margin-right:0}[svelte-4203530351].images div img,[svelte-4203530351] .images div img{width:100%;height:100%;background-color:#EEE}figcaption[svelte-4203530351],[svelte-4203530351] figcaption{margin-top:6px}</style><style id="svelte-1716951829-style">[svelte-1716951829].controls,[svelte-1716951829] .controls{display:flex;flex-flow:row;flex-wrap:wrap;font-size:13px;margin-bottom:8px}[svelte-1716951829].icons,[svelte-1716951829] .icons{display:inline-flex;flex-wrap:wrap;flex-direction:row;border-bottom:1px solid #dddddd}[svelte-1716951829].icons .icon,[svelte-1716951829] .icons .icon{cursor:pointer;padding-bottom:5px;margin-bottom:-1px;margin-left:3px;margin-right:3px}[svelte-1716951829].icons .icon:first-of-type,[svelte-1716951829] .icons .icon:first-of-type{margin-left:0px}[svelte-1716951829].icons .icon:last-of-type,[svelte-1716951829] .icons .icon:last-of-type{margin-right:0px}[svelte-1716951829].icons .icon.selected,[svelte-1716951829] .icons .icon.selected{opacity:100%;border-bottom:3px solid #ff6600}[svelte-1716951829].icon div,[svelte-1716951829] .icon div{opacity:0.666;image-rendering:auto}[svelte-1716951829].icon.selected div,[svelte-1716951829] .icon.selected div{opacity:1}[svelte-1716951829].config-group,[svelte-1716951829] .config-group{display:inline-block;margin-right:20px}[svelte-1716951829].config-group:last-of-type,[svelte-1716951829] .config-group:last-of-type{margin-right:0}[svelte-1716951829].config-group .config,[svelte-1716951829] .config-group .config{display:block}[svelte-1716951829].config-binary,[svelte-1716951829] .config-binary{width:auto}[svelte-1716951829].config-range,[svelte-1716951829] .config-range{width:140px;overflow:visible;white-space:nowrap}[svelte-1716951829].config-group .config input[type="range"],[svelte-1716951829] .config-group .config input[type="range"]{width:100%;margin:0px;padding:0px;margin-top:3px}[svelte-1716951829].config-group span.value,[svelte-1716951829] .config-group span.value{display:inline-block;width:35px}[svelte-1716951829].explain,[svelte-1716951829] .explain{display:inline-block;width:200px;vertical-align:top}[svelte-1716951829].images,[svelte-1716951829] .images{}[svelte-1716951829].images .outer,[svelte-1716951829] .images .outer{display:inline-block;padding-right:5px}[svelte-1716951829].images .outer:last-of-type,[svelte-1716951829] .images .outer:last-of-type{padding-right:0}[svelte-1716951829].inner,[svelte-1716951829] .inner{image-rendering:pixelated}</style><style id="svelte-1825949572-style">[svelte-1825949572].layers,[svelte-1825949572] .layers{margin-top:25px;display:flex;flex-flow:row;flex-wrap:wrap;align-items:flex-start;justify-content:center}[svelte-1825949572].outer,[svelte-1825949572] .outer{margin-top:5px;margin-bottom:15px;margin-left:4px;margin-right:4px}[svelte-1825949572].outer:first-of-type,[svelte-1825949572] .outer:first-of-type{margin-left:0}[svelte-1825949572].outer:last-of-type,[svelte-1825949572] .outer:last-of-type{margin-right:0}[svelte-1825949572].grad,[svelte-1825949572] .grad{background:url("images/layer_gradients_spritemap_4.jpeg")}[svelte-1825949572].outer figcaption,[svelte-1825949572] .outer figcaption{margin-top:10px}[svelte-1825949572].highlight::before,[svelte-1825949572] .highlight::before{content:"←";position:relative;left:-3px;top:-25px;color:#888}</style></head>

<body distill-prerendered="" data-new-gr-c-s-check-loaded="8.899.0" data-gr-ext-installed="" class="vsc-initialized"><distill-header distill-prerendered="">
<style>
distill-header {
  position: relative;
  height: 60px;
  background-color: hsl(200, 60%, 15%);
  width: 100%;
  box-sizing: border-box;
  z-index: 2;
  color: rgba(0, 0, 0, 0.8);
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.05);
}
distill-header .content {
  height: 70px;
  grid-column: page;
}
distill-header a {
  font-size: 16px;
  height: 60px;
  line-height: 60px;
  text-decoration: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 22px 0;
}
distill-header a:hover {
  color: rgba(255, 255, 255, 1);
}
distill-header svg {
  width: 24px;
  position: relative;
  top: 4px;
  margin-right: 2px;
}
@media(min-width: 1080px) {
  distill-header {
    height: 70px;
  }
  distill-header a {
    height: 70px;
    line-height: 70px;
    padding: 28px 0;
  }
  distill-header .logo {
  }
}
distill-header svg path {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 3px;
}
distill-header .logo {
  font-size: 17px;
  font-weight: 200;
}
distill-header .nav {
  float: right;
  font-weight: 300;
}
distill-header .nav a {
  font-size: 12px;
  margin-left: 24px;
  text-transform: uppercase;
}
</style>
<div class="content">
  <a href="https://distill.pub/" class="logo">
    <svg viewBox="-607 419 64 64">
  <path d="M-573.4,478.9c-8,0-14.6-6.4-14.6-14.5s14.6-25.9,14.6-40.8c0,14.9,14.6,32.8,14.6,40.8S-565.4,478.9-573.4,478.9z"></path>
</svg>

    Distill
  </a>
  <nav class="nav">
    <a href="https://distill.pub/about/">About</a>
    <a href="https://distill.pub/prize/">Prize</a>
    <a href="https://distill.pub/journal/">Submit</a>
  </nav>
</div>
</distill-header>

<d-front-matter>
  <script type="text/json">{
  "title": "Feature Visualization",
  "description": "How neural networks build up their understanding of images",
  "authors": [
    {
      "author":"Chris Olah",
      "authorURL":"https://colah.github.io/",
      "affiliation":"Google Brain Team",
      "affiliationURL":"https://g.co/brain"
    },
    {
      "author":"Alexander Mordvintsev",
      "authorURL":"https://znah.net/",
      "affiliation":"Google Research",
      "affiliationURL":"https://research.google.com/"
    },
    {
      "author":"Ludwig Schubert",
      "authorURL":"https://schubert.io/",
      "affiliation":"Google Brain Team",
      "affiliationURL":"https://g.co/brain"
    }
  ]
  }</script>
</d-front-matter>


<d-title style="contain: style; overflow: visible;">
  <h1>Feature Visualization</h1>
  <p style="grid-column: text;">How neural networks build up their understanding of images</p>
  <figure class="base-grid">
    <div style="grid-column: screen; padding-left: 16px; padding-right: 16px;" id="googlenet-examples"><div svelte-3261002896="" class="googlenet-examples"><div class="example"><div class="images"><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -0px -0px; --hover-size: 200px; --hover-position: -0px -0px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -0px -200px; --hover-size: 200px; --hover-position: -0px -200px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -0px -400px; --hover-size: 200px; --hover-position: -0px -400px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -0px -600px; --hover-size: 200px; --hover-position: -0px -600px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -0px -800px; --hover-size: 200px; --hover-position: -0px -800px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -0px -1000px; --hover-size: 200px; --hover-position: -0px -1000px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div></div>
      <span class="description"><strong>Edges</strong> (layer conv2d0)</span></div><div class="example"><div class="images"><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -200px -0px; --hover-size: 200px; --hover-position: -200px -0px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -200px -200px; --hover-size: 200px; --hover-position: -200px -200px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -200px -400px; --hover-size: 200px; --hover-position: -200px -400px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -200px -600px; --hover-size: 200px; --hover-position: -200px -600px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -200px -800px; --hover-size: 200px; --hover-position: -200px -800px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -200px -1000px; --hover-size: 200px; --hover-position: -200px -1000px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div></div>
      <span class="description"><strong>Textures</strong> (layer mixed3a)</span></div><div class="example"><div class="images"><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -400px -0px; --hover-size: 200px; --hover-position: -400px -0px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -400px -200px; --hover-size: 200px; --hover-position: -400px -200px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -400px -400px; --hover-size: 200px; --hover-position: -400px -400px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -400px -600px; --hover-size: 200px; --hover-position: -400px -600px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -400px -800px; --hover-size: 200px; --hover-position: -400px -800px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -400px -1000px; --hover-size: 200px; --hover-position: -400px -1000px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div></div>
      <span class="description"><strong>Patterns</strong> (layer mixed4a)</span></div><div class="example"><div class="images"><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -600px -0px; --hover-size: 200px; --hover-position: -600px -0px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -600px -200px; --hover-size: 200px; --hover-position: -600px -200px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -600px -400px; --hover-size: 200px; --hover-position: -600px -400px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -600px -600px; --hover-size: 200px; --hover-position: -600px -600px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -600px -800px; --hover-size: 200px; --hover-position: -600px -800px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -600px -1000px; --hover-size: 200px; --hover-position: -600px -1000px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div></div>
      <span class="description"><strong>Parts</strong> (layers mixed4b &amp; mixed4c)</span></div><div class="example"><div class="images"><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -800px -0px; --hover-size: 200px; --hover-position: -800px -0px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -800px -200px; --hover-size: 200px; --hover-position: -800px -200px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -800px -400px; --hover-size: 200px; --hover-position: -800px -400px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -800px -600px; --hover-size: 200px; --hover-position: -800px -600px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -800px -800px; --hover-size: 200px; --hover-position: -800px -800px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div><div svelte-986317898="" class="sprite outer hoverable" style="--default-size: 200px; --default-position: -800px -1000px; --hover-size: 200px; --hover-position: -800px -1000px; --container-size: 125px; --default-ratio: 0.625; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_hero"></div></div></div></div>
      <span class="description"><strong>Objects</strong> (layers mixed4d &amp; mixed4e)</span></div></div></div>
    <figcaption style="grid-column: text;">
      Feature visualization allows us to see how GoogLeNet<d-cite key="szegedy2015going"></d-cite>, trained on the ImageNet<d-cite key="deng2009imagenet"></d-cite> dataset, builds up its understanding of images over many layers.
      Visualizations of all channels are available in the <a href="https://distill.pub/2017/feature-visualization/appendix/">appendix</a>.
    </figcaption>
  </figure>
</d-title>

<d-byline>
  <div class="byline grid">
    <div class="authors-affiliations grid">
      <h3>Authors</h3>
      <h3>Affiliations</h3>
      
        <p class="author">
          
            <a class="name" href="https://colah.github.io/">Chris Olah</a>
        </p>
        <p class="affiliation">
        <a class="affiliation" href="https://g.co/brain">Google Brain Team</a>
        </p>
      
        <p class="author">
          
            <a class="name" href="https://znah.net/">Alexander Mordvintsev</a>
        </p>
        <p class="affiliation">
        <a class="affiliation" href="https://research.google.com/">Google Research</a>
        </p>
      
        <p class="author">
          
            <a class="name" href="https://schubert.io/">Ludwig Schubert</a>
        </p>
        <p class="affiliation">
        <a class="affiliation" href="https://g.co/brain">Google Brain Team</a>
        </p>
      
    </div>
    <div>
      <h3>Published</h3>
      
        <p>Nov. 7, 2017</p> 
    </div>
    <div>
      <h3>DOI</h3>
      
        <p><a href="https://doi.org/10.23915/distill.00007">10.23915/distill.00007</a></p>
    </div>
  </div>
</d-byline><d-article>

<p>
  There is a growing sense that neural networks need to be interpretable to humans.
  The field of neural network interpretability has formed in response to these concerns.
  As it matures, two major threads of research have begun to coalesce: feature visualization and attribution.
</p>


<figure id="fv-vs-attribution" class="grid" style="">
  <div>
    <div class="images">
      <img src="Feature%20Visualization_files/neuron.png">
      <img src="Feature%20Visualization_files/channel.png">
    </div>
    <figcaption>
      <strong>Feature visualization</strong> answers questions about what a network — or parts of a network — are looking for by generating examples.
    </figcaption>
  </div>
  <div>
    <div class="images">
      <img src="Feature%20Visualization_files/attribution-1.png">
      <img src="Feature%20Visualization_files/attribution-2.jpg" style="">
    </div>
    <figcaption>
    <strong>Attribution</strong>
      <d-footnote id="d-footnote-1">
        As a young field, neural network interpretability does not yet 
have standardized terminology.
        Attribution has gone under many different names in the 
literature — including “feature visualization”! — but recent work seems 
to prefer terms like “attribution” and “saliency maps”.
      </d-footnote>
    studies what part of an example is responsible for the network activating a particular way.
    </figcaption>
  </div>
</figure>

<p>
  This article focuses on feature visualization.
  While feature visualization is a powerful tool, actually getting it to
 work involves a number of details.
  In this article, we examine the major issues and explore common 
approaches to solving them.
  We find that remarkably simple methods can produce high-quality 
visualizations. Along the way we introduce a few tricks for exploring 
variation in what neurons react to, how they interact, and how to 
improve the optimization process.
</p>

<!--
<p>
  Neural network feature visualization is a powerful technique. It can answer questions about what a network -- or parts of a network -- are looking for by generating idealized examples of what the network is trying to find.
  Along with attribution it forms one of the two main threads of research in neural network interpretability.
</p> -->
<!--
<p>
  Over the last few years, the field has made great strides in feature visualization. Actually getting it to work, however, involves a number of details. In this article, we examine the major issues and explore common approaches to solving them.
</p>
<p>
  We find that remarkably simple methods can produce high-quality visualizations. Along the way we introduce a few tricks for exploring variation in what neurons react to, how they interact, and how to improve the optimization process.
</p> -->

<hr>
<!-- =================================================== -->
<h2 id="optimization">Feature Visualization by Optimization</h2>

<p>
  Neural networks are, generally speaking, differentiable with respect 
to their inputs.
  If we want to find out what kind of input would cause a certain 
behavior — whether that’s an internal neuron firing or the final output 
behavior — we can use derivatives to iteratively tweak the input
  towards that goal <d-cite key="erhan2009visualizing"></d-cite>.
</p>

<figure class="base-grid" style="min-height: 168px;">
  <figcaption style="grid-column: kicker;">Starting from random noise, we optimize an image to activate a particular neuron (layer mixed4a, unit 11).</figcaption>
  <d-figure id="opt-progress" style="grid-column: text;"><div svelte-3927223486="" class="container"><div><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -0px -0px; --hover-size: 180px; --hover-position: -0px -0px; --container-size: 140px; --default-ratio: 0.7777777777777778; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: auto;"><div class="mid"><div class="inner sprite_opt_progress"></div></div></div>
      <figcaption>Step 0</figcaption></div>
    <div class="arrowbox">→</div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -180px -0px; --hover-size: 180px; --hover-position: -180px -0px; --container-size: 140px; --default-ratio: 0.7777777777777778; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: auto;"><div class="mid"><div class="inner sprite_opt_progress"></div></div></div>
      <figcaption>Step 4</figcaption></div>
    <div class="arrowbox">→</div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -360px -0px; --hover-size: 180px; --hover-position: -360px -0px; --container-size: 140px; --default-ratio: 0.7777777777777778; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: auto;"><div class="mid"><div class="inner sprite_opt_progress"></div></div></div>
      <figcaption>Step 48</figcaption></div>
    <div class="arrowbox">→</div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -540px -0px; --hover-size: 180px; --hover-position: -540px -0px; --container-size: 140px; --default-ratio: 0.7777777777777778; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: auto;"><div class="mid"><div class="inner sprite_opt_progress"></div></div></div>
      <figcaption>Step 2048</figcaption></div>
    <div class="arrowbox"></div></div></d-figure>
</figure>

<p>
  While conceptually simple, there are subtle challenges in getting the 
optimization to work. We will explore them, as well as common approaches
 to tackle them in the section ”<a href="#enemy-of-feature-vis">The Enemy of Feature Visualization</a>″.
</p>

<h3 id="optimization-objectives">Optimization Objectives</h3>

<p>
  What do we want examples of?
  This is the core question in working with examples, regardless of 
whether we’re searching through a dataset to find the examples, or 
optimizing images to create them from scratch.
  We have a wide variety of options in what we search for:
</p>

<figure class="base-grid" id="optimization-objectives">
  <style>
    #optimization-objectives .objectives {
      grid-column: text;
      grid-template-columns: repeat(1, 1fr);
    }

    #optimization-objectives .objective {
      display: grid;
      grid-template-columns: repeat(2, 1fr) 1.1fr;
    }

    #optimization-objectives .objectives figcaption {
      padding: 4px 8px;
      word-wrap: break-word;
      word-break: break-word;
    }

    #optimization-objectives .objective .objective-icon {
      padding: 8px;
    }

    @media (min-width: 512px) {
      #optimization-objectives .objectives {
        grid-template-columns: repeat(5, 1fr);
        grid-column-gap: 16px;
      }

      #optimization-objectives .objective {
        display: flex;
        flex-flow: column;
      }

      #optimization-objectives .objectives figcaption {
        padding: 0;
        padding-top: 4px;
        word-wrap: break-word;
        word-break: break-word;
      }
    }
  </style>

  <figcaption style="grid-column: kicker;">
    <p>Different <strong>optimization objectives</strong> show what different parts of a network are looking for.</p>
    <br>
    <p><code><strong>n</strong></code> layer index <br>
      <code><strong>x,y</strong></code> spatial position<br>
      <code><strong>z</strong></code> channel index <br>
      <code><strong>k</strong></code> class index</p>
  </figcaption>

  <div class="objectives grid">
    <div class="objective">
      <div class="objective-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><g id="Page-1-Copy" fill="none" fill-rule="evenodd" transform="translate(27)"><path id="Rectangle-Copy-3" fill="#888" d="M40 0l50 28.8V144l-50-28.8z" opacity=".2"></path><path id="Rectangle-Copy-2" fill="#888" d="M20 0l50 28.8V144l-50-28.8z" opacity=".4"></path><path id="Rectangle-Copy" fill="#AAA" d="M0 0l50 28.8V144L0 115.2z"></path><path id="Rectangle-Copy-4" fill="#F5A623" d="M25 83.52l9 4.954v19.814l-9-4.954z"></path></g></svg>
      </div>
      <img class="objective-opt" src="Feature%20Visualization_files/neuron.png">
      <figcaption><strong>Neuron</strong><br><code>layer<sub>n</sub>[x,y,z]</code></figcaption>
    </div>

    <div class="objective">
      <div class="objective-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><g id="Page-1-Copy" fill="none" fill-rule="evenodd" transform="translate(27)"><path id="Rectangle-Copy-3" fill="#888" d="M40 0l50 28.8V144l-50-28.8z" opacity=".2"></path><path id="Rectangle-Copy-2" fill="#F5A623" d="M20 0l50 28.8V144l-50-28.8z"></path><path id="Rectangle-Copy" fill="#AAA" d="M0 0l50 28.8V144L0 115.2z"></path></g></svg>
      </div>
      <img class="objective-opt" src="Feature%20Visualization_files/channel.png">
      <figcaption><strong>Channel</strong><br><code>layer<sub>n</sub>[:,:,z]</code></figcaption>
    </div>

    <div class="objective">
      <div class="objective-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><g id="Page-1-Copy" fill="#F5A623" fill-rule="evenodd" transform="translate(27)"><path id="Rectangle-Copy-3" d="M40 0l50 28.8V144l-50-28.8z" opacity=".2"></path><path id="Rectangle-Copy-2" d="M20 0l50 28.8V144l-50-28.8z" opacity=".4"></path><path id="Rectangle-Copy" d="M0 0l50 28.8V144L0 115.2z"></path></g></svg>
      </div>
      <img class="objective-opt" src="Feature%20Visualization_files/layer.png">
      <figcaption><strong>Layer</strong>/DeepDream<br><code>layer<sub>n</sub>[:,:,:]<sup>2</sup></code></figcaption>
    </div>

    <div class="objective">
      <div class="objective-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><g id="Page-1-Copy" fill="none" fill-rule="evenodd"><g id="objectives_logits_pre" transform="translate(9 9)"><circle id="Oval-Copy-17" cx="115" cy="29" r="11" fill="#FFF" stroke="#D7D7D7" transform="matrix(-1 0 0 1 230 0)"></circle><circle id="Oval-Copy-18" cx="115" cy="64" r="11" fill="#FFF" stroke="#D7D7D7" transform="matrix(-1 0 0 1 230 0)"></circle><circle id="Oval-Copy-19" cx="115" cy="99" r="11" fill="#FFF" stroke="#D7D7D7" transform="matrix(-1 0 0 1 230 0)"></circle><path id="Line-3-Copy-15" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272-86" opacity=".428"></path><path id="Line-3-Copy-16" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272-53" opacity=".428"></path><path id="Line-3-Copy-17" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272-18" opacity=".428"></path><path id="Line-3-Copy-18" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272 17" opacity=".428"></path><g id="Group-2-Copy" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" opacity=".428" transform="matrix(1 0 0 -1 11 115)"><path id="Line-3-Copy-8" d="M50.636 86.5L.364.5"></path><path id="Line-3-Copy-7" d="M50.636 86.5L.364 33.5"></path><path id="Line-3-Copy-3" d="M50.636 86.5L.364 68.5"></path><path id="Line-3-Copy-6" d="M50.636 86.5l-50.272 17"></path></g><path id="Line-3-Copy-19" stroke="#9B9B9B" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 64.5l-50.272-53"></path><path id="Line-3-Copy-20" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 64.5l-50.272-18"></path><path id="Line-3-Copy-21" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 64.5l-50.272 17"></path><path id="Line-3-Copy-22" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M60.638 64.5l-49.276 53"></path><circle id="Oval-Copy-5" cx="11" cy="11" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-20" cx="59" cy="29" r="11" fill="#D8D8D8"></circle><circle id="Oval-Copy-6" cx="11" cy="46" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-21" cx="59" cy="64" r="11" fill="#F5A623"></circle><circle id="Oval-Copy-7" cx="11" cy="81" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-22" cx="59" cy="99" r="11" fill="#D8D8D8"></circle><circle id="Oval-Copy-8" cx="11" cy="116" r="11" fill="#FFF" stroke="#D7D7D7"></circle><path id="Line-3-Copy-23" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M74.958 29.5h-5.874" opacity=".428"></path><path id="Line-3-Copy-24" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M102.958 29.5h-5.874" opacity=".428"></path><path id="Line-3-Copy-25" stroke="#9B9B9B" stroke-dasharray="1,2" stroke-linecap="square" d="M74.958 64.5h-5.874" opacity=".4"></path><path id="Line-3-Copy-26" stroke="#9B9B9B" stroke-dasharray="1,2" stroke-linecap="square" d="M102.958 64.5h-5.874" opacity=".4"></path><path id="Line-3-Copy-27" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M74.958 99.5h-5.874" opacity=".428"></path><path id="Line-3-Copy-28" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M102.958 99.5h-5.874" opacity=".428"></path><rect id="Rectangle-3-Copy" width="21" height="103" x="76.5" y="13.5" stroke="#9B9B9B" opacity=".4" rx="3"></rect><text id="softmax-copy" fill="#979797" font-family="SFProText-Light, SF Pro Text" font-size="14" font-weight="300" opacity=".673" transform="rotate(-90 86 64.5)"><tspan x="59.818" y="69.5">softmax</tspan></text></g></g></svg>
      </div>
      <img class="objective-opt" src="Feature%20Visualization_files/logits.png">
      <figcaption><strong>Class Logits</strong><br><code>pre_softmax[k]</code></figcaption>
    </div>

    <div class="objective">
      <div class="objective-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 144"><g id="Page-1-Copy" fill="none" fill-rule="evenodd"><g id="objectives_logits_post" transform="translate(9 9)"><circle id="Oval-Copy-14" cx="115" cy="29" r="11" fill="#D8D8D8" transform="matrix(-1 0 0 1 230 0)"></circle><circle id="Oval-Copy-15" cx="115" cy="64" r="11" fill="#F5A623" transform="matrix(-1 0 0 1 230 0)"></circle><circle id="Oval-Copy-16" cx="115" cy="99" r="11" fill="#D8D8D8" transform="matrix(-1 0 0 1 230 0)"></circle><path id="Line-3" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272-86" opacity=".428"></path><path id="Line-3-Copy" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272-53" opacity=".428"></path><path id="Line-3-Copy-2" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272-18" opacity=".428"></path><path id="Line-3-Copy-4" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 97.5l-50.272 17" opacity=".428"></path><g id="Group-2" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" opacity=".428" transform="matrix(1 0 0 -1 11 115)"><path id="Line-3-Copy-8" d="M50.636 86.5L.364.5"></path><path id="Line-3-Copy-7" d="M50.636 86.5L.364 33.5"></path><path id="Line-3-Copy-3" d="M50.636 86.5L.364 68.5"></path><path id="Line-3-Copy-6" d="M50.636 86.5l-50.272 17"></path></g><path id="Line-3-Copy" stroke="#9B9B9B" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 64.5l-50.272-53"></path><path id="Line-3-Copy-2" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 64.5l-50.272-18"></path><path id="Line-3-Copy-4" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M61.636 64.5l-50.272 17"></path><path id="Line-3-Copy-5" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M60.638 64.5l-49.276 53"></path><circle id="Oval-Copy" cx="11" cy="11" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-9" cx="59" cy="29" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-2" cx="11" cy="46" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-10" cx="59" cy="64" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-3" cx="11" cy="81" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-11" cx="59" cy="99" r="11" fill="#FFF" stroke="#D7D7D7"></circle><circle id="Oval-Copy-4" cx="11" cy="116" r="11" fill="#FFF" stroke="#D7D7D7"></circle><path id="Line-3-Copy-9" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M74.958 29.5h-5.874" opacity=".428"></path><path id="Line-3-Copy-12" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M102.958 29.5h-5.874" opacity=".428"></path><path id="Line-3-Copy-10" stroke="#9B9B9B" stroke-dasharray="1,2" stroke-linecap="square" d="M74.958 64.5h-5.874"></path><path id="Line-3-Copy-13" stroke="#9B9B9B" stroke-dasharray="1,2" stroke-linecap="square" d="M102.958 64.5h-5.874"></path><path id="Line-3-Copy-11" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M74.958 99.5h-5.874" opacity=".428"></path><path id="Line-3-Copy-14" stroke="#979797" stroke-dasharray="1,2" stroke-linecap="square" d="M102.958 99.5h-5.874" opacity=".428"></path><rect id="Rectangle-3" width="21" height="103" x="76.5" y="13.5" stroke="#9B9B9B" rx="3"></rect><text id="softmax" fill="#979797" font-family="SFProText-Regular, SF Pro Text" font-size="14" transform="rotate(-90 87 65.5)"><tspan x="60.494" y="70.5">softmax</tspan></text></g></g></svg>
      </div>
      <img class="objective-opt" src="Feature%20Visualization_files/logits_post.png">
      <figcaption><strong>Class Probability</strong><br><code>softmax[k]</code></figcaption>
    </div>
  </div>
</figure>

<p>
  If we want to understand individual features, we can search for examples where they have high values — either for a <em>neuron</em> at an individual position, or for an entire <em>channel</em>.
  We used the channel objective to create most of the images in this article.
</p>

<p>
  If we want to understand a <em>layer</em> as a whole, we can use the DeepDream objective <d-cite key="mordvintsev2015inceptionism"></d-cite>, searching for images the layer finds “interesting.”
</p>
<!-- <p>
  And if we want to create examples of output classes from a classifier, we have two options -- optimizing <em>class logits</em> before the softmax or optimizing <em>class probabilities</em> after the softmax.
  One can see the logits as the evidence for each class, and the probabilities as the likelihood of each class given the evidence.
  Unfortunately, the easiest way to increase the probability softmax gives to a class is often to make the alternatives unlikely rather than to make the class of interest likely <d-cite key="simonyan2013deep"></d-cite>.
  This can be fixed by very strong regularization with generative models, in which case the probabilities can be a very principled thing to optimize.
  From our experience, optimizing pre-softmax logits produces images of better visual quality.<d-footnote>
    While the standard explanation is that maximizing probability doesn't work very well because you can just push down evidence for other classes, an alternate hypothesis is that it's just harder to optimize through the softmax function. We understand this has sometimes been an issue in adversarial examples, and the solution is to optimize the LogSumExp of the logits instead. This is equivalent to optimizing softmax but generally more tractable. Our experience was that the LogSumExp trick doesn't seem better than dealing with the raw probabilities.
  </d-footnote>
</p> -->

<p>
  And if we want to create examples of output classes from a classifier, we have two options — optimizing <em>class logits</em> before the softmax or optimizing <em>class probabilities</em>
 after the softmax.
  One can see the logits as the evidence for each class, and the 
probabilities as the likelihood of each class given the evidence.
  Unfortunately, the easiest way to increase the probability softmax 
gives to a class is often to make the alternatives unlikely rather than 
to make the class of interest likely <d-cite key="simonyan2013deep"></d-cite>.
  From our experience, optimizing pre-softmax logits produces images of better visual quality.
  <d-footnote id="d-footnote-2">
    While the standard explanation is that maximizing probability 
doesn’t work very well because you can just push down evidence for other
 classes, an alternate hypothesis is that it’s just harder to optimize 
through the softmax function. We understand this has sometimes been an 
issue in adversarial examples, and the solution is to optimize the 
LogSumExp of the logits instead. This is equivalent to optimizing 
softmax but generally more tractable. Our experience was that the 
LogSumExp trick doesn’t seem better than dealing with the raw 
probabilities.
    <br>
    <br>
    Regardless of why that happens, it can be fixed by very strong 
regularization with generative models. In this case the probabilities 
can be a very principled thing to optimize.
  </d-footnote>
</p>

<p>
  The objectives we’ve mentioned only scratch the surface of possible objectives — there are a lot more that one could try.
  Of particular note are the objectives used in style transfer <d-cite key="gatys2015neural"></d-cite>, which can teach us about the kinds of style and content a network understands,
  and objectives used in optimization-based model inversion <d-cite key="mahendran2015understanding"></d-cite>,
 which help us understand what information a model keeps and what it 
throws away.
  We are only at the beginning of understanding which objectives are 
interesting, and there is a lot of room for more work in this area.
</p>

<h3 id="why-optimization">Why visualize by optimization?</h3>

<p>
  Optimization can give us an example input that causes the desired behavior — but why bother with that?
  Couldn’t we just look through the dataset for examples that cause the desired behavior?
</p>

<p>
  It turns out that optimization approach can be a powerful way to understand what a model is really looking for,
  because it separates the things causing behavior from things that merely correlate with the causes.
  For example, consider the following neurons visualized with dataset examples and optimization:
</p>

<figure style="grid-column: screen;">
  <d-figure class="base-grid" id="example-optimization-comparison"><figcaption svelte-3700122413="" style="grid-column: kicker;"><strong>Dataset Examples</strong> show us what neurons respond to in practice</figcaption>

<div svelte-3700122413="" class="images" style="grid-column: text-start / page-end;"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -0px -0px; --hover-size: 294px; --hover-position: -0px -0px; --container-size: 170px; --default-ratio: 0.5782312925170068; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison_examples"></div></div></div>
  <div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -294px -0px; --hover-size: 294px; --hover-position: -294px -0px; --container-size: 170px; --default-ratio: 0.5782312925170068; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison_examples"></div></div></div>
  <div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -588px -0px; --hover-size: 294px; --hover-position: -588px -0px; --container-size: 170px; --default-ratio: 0.5782312925170068; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison_examples"></div></div></div>
  <div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -882px -0px; --hover-size: 294px; --hover-position: -882px -0px; --container-size: 170px; --default-ratio: 0.5782312925170068; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison_examples"></div></div></div></div>

<figcaption svelte-3700122413="" style="grid-column: kicker;"><span><strong>Optimization</strong> isolates the causes of behavior from mere correlations.</span>
  <span>A neuron may not be detecting what you initially thought.</span></figcaption>

<div svelte-3700122413="" class="images" style="grid-column: text-start / page-end;"><div svelte-986317898="" class="sprite outer " style="--default-size: 170px; --default-position: -0px -0px; --hover-size: 170px; --hover-position: -0px -0px; --container-size: 170px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison"></div></div></div>
  <div svelte-986317898="" class="sprite outer " style="--default-size: 170px; --default-position: -170px -0px; --hover-size: 170px; --hover-position: -170px -0px; --container-size: 170px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison"></div></div></div>
  <div svelte-986317898="" class="sprite outer " style="--default-size: 170px; --default-position: -340px -0px; --hover-size: 170px; --hover-position: -340px -0px; --container-size: 170px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison"></div></div></div>
  <div svelte-986317898="" class="sprite outer " style="--default-size: 170px; --default-position: -510px -0px; --hover-size: 170px; --hover-position: -510px -0px; --container-size: 170px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_examples_opt_comparison"></div></div></div></div>

<div svelte-3700122413="" class="captions" style="grid-column: text-start / page-end;"><figcaption>Baseball—or stripes? <br><em>mixed4a, Unit 6</em></figcaption>
  <figcaption>Animal faces—or snouts? <br><em>mixed4a, Unit 240</em></figcaption>
  <figcaption>Clouds—or fluffiness? <br><em>mixed4a, Unit 453</em></figcaption>
  <figcaption>Buildings—or sky? <br><em>mixed4a, Unit 492</em></figcaption></div></d-figure>
</figure>

<p>
  Optimization also has the advantage of flexibility.
  For example, if we want to study how neurons jointly represent 
information,
  we can easily ask how a particular example would need to be different 
for an additional neuron to activate.
  This flexibility can also be helpful in visualizing how features 
evolve as the network trains.
  If we were limited to understanding the model on the fixed examples in
 our dataset, topics like these ones would be much harder to explore.
</p>

<p>
  On the other hand, there are also significant challenges to 
visualizing features with optimization.
  In the following sections we’ll examine techniques to get diverse 
visualizations, understand how neurons interact, and avoid high 
frequency artifacts.
</p>


<!-- =================================================== -->
<hr>
<h2 id="diversity">Diversity</h2>

<!-- TODO: improve las sentence -->
<p>
  Do our examples show us the full picture?
  When we create examples by optimization, this is something we need to be very careful of.
  It’s entirely possible for genuine examples to still mislead us by only showing us one “facet” of what a feature represents.
</p>

<p>
  Dataset examples have a big advantage here.
  By looking through our dataset, we can find diverse examples.
  It doesn’t just give us ones activating a neuron intensely:
  we can look across a whole spectrum of activations to see what activates the neuron to different extents.
</p>

<!-- <figure class="l-page-outset"><img src="images/vis_ActivationSpectrum.svg" style="min-height: 150px;"></img></figure> -->


<figure style="grid-column: screen;" class="shaded-figure">
  <d-figure class="base-grid" id="optimization-and-examples"><div svelte-3177516282="" style="grid-column: text;"><div class="icons"><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -36.75px; --hover-size: 147px; --hover-position: -0px -0px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -183.75px; --hover-size: 147px; --hover-position: -0px -147px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -330.75px; --hover-size: 147px; --hover-position: -0px -294px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -477.75px; --hover-size: 147px; --hover-position: -0px -441px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -624.75px; --hover-size: 147px; --hover-position: -0px -588px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon selected"><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -771.75px; --hover-size: 147px; --hover-position: -0px -735px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -918.75px; --hover-size: 147px; --hover-position: -0px -882px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -1065.75px; --hover-size: 147px; --hover-position: -0px -1029px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -1212.75px; --hover-size: 147px; --hover-position: -0px -1176px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -1359.75px; --hover-size: 147px; --hover-position: -0px -1323px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 73.5px; --default-position: -36.75px -1506.75px; --hover-size: 147px; --hover-position: -0px -1470px; --container-size: 44px; --default-ratio: 0.5986394557823129; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div></div></div></div>

<div svelte-3177516282="" class="container"><div class="negative"><div class="optimize"><div svelte-986317898="" class="sprite outer " style="--default-size: 147px; --default-position: -147px -735px; --hover-size: 147px; --hover-position: -147px -735px; --container-size: 147px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: auto;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div>
      <figcaption class="caption"><strong>Negative</strong> optimized</figcaption></div>
    <div class="examples"><div class="example-set"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -0px -1470px; --hover-size: 294px; --hover-position: -0px -1470px; --container-size: 147px; --default-ratio: 0.5; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-sprite"></div></div></div>
        <figcaption class="caption"><strong>Minimum</strong> activation examples</figcaption></div>
      <div class="example-set"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -294px -1470px; --hover-size: 294px; --hover-position: -294px -1470px; --container-size: 147px; --default-ratio: 0.5; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-sprite"></div></div></div>
        <figcaption class="caption">Slightly negative activation examples</figcaption></div></div></div>

  <div class="divider"></div>

  <div class="positive"><div class="optimize"><div svelte-986317898="" class="sprite outer " style="--default-size: 147px; --default-position: -0px -735px; --hover-size: 147px; --hover-position: -0px -735px; --container-size: 147px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-optimized-sprite"></div></div></div>
      <figcaption class="caption"><strong>Positive</strong> optimized</figcaption></div>
    <div class="examples"><div class="example-set"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -882px -1470px; --hover-size: 294px; --hover-position: -882px -1470px; --container-size: 147px; --default-ratio: 0.5; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-sprite"></div></div></div>
        <figcaption class="caption">Slightly positive activation examples</figcaption></div>
      <div class="example-set"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -1176px -1470px; --hover-size: 294px; --hover-position: -1176px -1470px; --container-size: 147px; --default-ratio: 0.5; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner opt-and-examples-sprite"></div></div></div>
        <figcaption class="caption"><strong>Maximum</strong> activation examples</figcaption></div></div></div></div>

<figcaption svelte-3177516282="" style="grid-column: text;"><strong>Layer mixed 4a, unit 492</strong></figcaption></d-figure>
  <div class="base-grid" style="margin-top: 4px;">
    <div style="grid-column: text / text;" id="colab-negative"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/negative_neurons.ipynb" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </div>
</figure>


<!-- <figure class="l-page-outset row" id="tmptest">
  <img class="column" src="https://cnsviewer2.corp.google.com/cns/in-d/home/ludwigschubert/visualize_channels/diagrams/mixed4a-00492/0-min.jpg">
  <img class="column" src="https://cnsviewer2.corp.google.com/cns/in-d/home/ludwigschubert/visualize_channels/diagrams/mixed4a-00492/1-some_negative.jpg">
  <img class="column" src="https://cnsviewer2.corp.google.com/cns/in-d/home/ludwigschubert/visualize_channels/diagrams/mixed4a-00492/2-zero.jpg">
  <img class="column" src="https://cnsviewer2.corp.google.com/cns/in-d/home/ludwigschubert/visualize_channels/diagrams/mixed4a-00492/3-some_positive.jpg">
  <img class="column" src="https://cnsviewer2.corp.google.com/cns/in-d/home/ludwigschubert/visualize_channels/diagrams/mixed4a-00492/4-max.jpg">
</figure> -->
<p>
  In contrast, optimization generally gives us just one extremely 
positive example — and if we’re creative, a very negative example as 
well.
  Is there some way that optimization could also give us this diversity?
</p>

<h3 id="diversity-with-optimization">Achieving Diversity with Optimization</h3>

<p>
  A given feature of a network may respond to a wide range of inputs.
  On the class level, for example, a classifier that has been trained to
 recognize dogs should recognize both closeups of their faces as well as
 wider profile images — even though those have quite different visual 
appearances.
  Early work by Wei <i>et al.</i><d-cite key="mneuron2015"></d-cite> 
attempts to demonstrate this “intra-class” diversity by recording 
activations over the entire training set, clustering them and optimizing
 for the cluster centroids, revealing the different facets of a class 
that were learned.
</p>

<p>
  A different approach by Nguyen, Yosinski, and collaborators was to 
search through the dataset for diverse examples and use those as 
starting points for the optimization process <d-cite key="nguyen2016multifaceted"></d-cite>.
  The idea is that this initiates optimization in different facets of 
the feature so that the resulting example from optimization will 
demonstrate that facet.
  In more recent work, they combine visualizing classes with a 
generative model, which they can sample for diverse examples <d-cite key="nguyen2016plug"></d-cite>.
  Their first approach had limited success, and while the generative 
model approach works very well — we’ll discuss it more in the section on
 regularization under <a href="#learned-priors">learned priors</a> — it can be a bit tricky.
</p>

<p>
  We find there’s a very simple way to achieve diversity: adding a “diversity term”
  <d-footnote id="d-footnote-3">
      For this article we use an approach based on ideas from artistic 
style transfer. Following that work, we begin by computing the Gram 
matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> of the channels, where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">G_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span></span> is a the dot product between the (flattened) response of filter <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">i</span></span></span></span></span> and filter <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span></span>:
      <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mo>∑</mo><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub><msub><mtext>layer</mtext><mi>n</mi></msub><mtext>[x,&nbsp;y,&nbsp;i]</mtext><mo>⋅</mo><msub><mtext>layer</mtext><mi>n</mi></msub><mtext>[x,&nbsp;y,&nbsp;j]</mtext></mrow><annotation encoding="application/x-tex">
        G_{i,j} = \sum_{x,y} \text{layer}_n\text{[x, y, i]} \cdot \text{layer}_n\text{[x, y, j]}
      </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0500050000000003em;"></span><span class="strut bottom" style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="base"><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.386113em;"></span></span></span></span><span class="mord"><span class="mord text"><span class="mord mathrm">layer</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"></span></span></span></span></span><span class="mord text"><span class="mord mathrm">[x,&nbsp;y,&nbsp;i]</span></span><span class="mbin">⋅</span><span class="mord"><span class="mord text"><span class="mord mathrm">layer</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"></span></span></span></span></span><span class="mord text"><span class="mord mathrm">[x,&nbsp;y,&nbsp;j]</span></span></span></span></span></span></span>
      From this, we compute the diversity term: the negative pairwise cosine similarity of pairs of visualizations.
      <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mtext>diversity</mtext></msub><mo>=</mo><mo>−</mo><msub><mo>∑</mo><mi>a</mi></msub><msub><mo>∑</mo><mrow><mi>b</mi><mo>≠</mo><mi>a</mi></mrow></msub><mtext>&nbsp;</mtext><mfrac><mrow><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>a</mi></msub><mo>)</mo><mo>⋅</mo><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>b</mi></msub><mo>)</mo></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>a</mi></msub><mo>)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>b</mi></msub><mo>)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
        C_{\text{diversity}} = - \sum_{a} \sum_{b\neq a} ~ 
\frac{\text{vec}(G_a) \cdot 
\text{vec}(G_b)}{||\text{vec}(G_a)||~||\text{vec}(G_b)||}
      </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.894705em;vertical-align:-1.467705em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">diversity</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.832795em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mrel mtight">≠</span><span class="mord mathit mtight">a</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.467705em;"></span></span></span></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord mathrm"><span class="mspace">&nbsp;</span><span class="mord mathrm">∣</span></span><span class="mord mathrm">∣</span><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
      We then maximize the diversity term jointly with the regular optimization objective.
    </d-footnote> to one’s objective that pushes multiple examples to be different from each other.
  The diversity term can take a variety of forms, and we don’t have much understanding of their benefits yet.
  One possibility is to penalize the cosine similarity of different examples.
  Another is to use ideas from style transfer <d-cite key="gatys2015neural"></d-cite> to force the feature to be displayed in different styles.
</p>

<p>
  In lower level neurons, a diversity term can reveal the different facets a feature represents:
</p>

<figure class="grid l-page" style="grid-template-columns: repeat(6, 1fr)">
  <div style="">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed4a_97_optimized.png">
    <figcaption>Simple Optimization</figcaption>
  </div>
  <div style="grid-column-end: span 4">
    <img src="Feature%20Visualization_files/mixed4a_97_diversity.png">
    <figcaption>
      Optimization with diversity reveals four different, curvy facets. <i>Layer mixed4a, Unit 97</i>
      <br>
      <div id="colab-diversity"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/neuron_diversity.ipynb" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
    </figcaption>
  </div>
  <div style="">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed4a_97_examples.jpg">
    <figcaption>Dataset examples</figcaption>
  </div>
</figure>


<p>
  Diverse feature visualizations allow us to more closely pinpoint what 
activates a neuron, to the degree that we can make, and — by looking at 
dataset examples — <em>check</em> predictions about what inputs will activate the neuron.
</p>
<p>
  For example, let’s examine this simple optimization result.
</p>

<p>
  <span style="display: block; float: left; width: 147px; margin-right: 1em; margin-bottom: 0.5em; margin-top: 3px">
    <img src="Feature%20Visualization_files/mixed4a_143_optimized.png">
    <span class="figcaption">Simple optimization</span>
  </span>
  Looking at it in isolation one might infer that this neuron activates 
on the top of dog heads, as the optimization shows both eyes and only 
downward curved edges.
  Looking at the optimization with diversity however, we see 
optimization results which don’t include eyes, and also one which 
includes upward curved edges. We thus have to broaden our expectation of
 what this neuron activates on to be mostly about the fur texture. 
Checking this hypothesis against dataset examples shows that is broadly 
correct. Note the spoon with a texture and color similar enough to dog 
fur for the neuron to activate.
</p>

<figure class="base-grid">
  <div style="grid-column: text;">
    <img src="Feature%20Visualization_files/mixed4a_143_diversity.png">
    <figcaption>
      Optimization with diversity. <i>Layer mixed4a, Unit 143</i>
    </figcaption>
  </div>
  <div style="grid-column: gutter;">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed4a_143_examples.jpg">
    <figcaption>Dataset examples</figcaption>
  </div>
</figure>

<p>
  The effect of diversity can be even more striking in higher level 
neurons, where it can show us different types of objects that stimulate a
 neuron.
  For example, one neuron responds to different kinds of balls, even 
though they have a variety of appearances.
</p>

<figure class="grid l-page" style="grid-template-columns: repeat(6, 1fr)">
  <div style="">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed5a_9_optimized.png">
    <figcaption>Simple Optimization</figcaption>
  </div>
  <div style="grid-column-end: span 4">
    <img src="Feature%20Visualization_files/mixed5a_9_diversity.png">
    <figcaption>Optimization with diversity reveals multiple types of balls. <i>Layer mixed5a, Unit 9</i></figcaption>
  </div>
  <div style="">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed5a_9_examples.jpg">
    <figcaption>Dataset examples</figcaption>
  </div>
</figure>

<p>
  This simpler approach has a number of shortcomings:
  For one, the pressure to make examples different can cause unrelated 
artifacts (such as eyes) to appear.
  Additionally, the optimization may make examples be different in an 
unnatural way.
  For example, in the above example one might want to see examples of 
soccer balls clearly separated from other types of balls like golf or 
tennis balls.
  Dataset based approaches such as Wei <i>et al.</i><d-cite key="mneuron2015"></d-cite>
 can split features apart more naturally — however they may not be as 
helpful in understanding how the model will behave on different data.
</p>

<p>
  Diversity also starts to brush on a more fundamental issue: while the 
examples above represent a mostly coherent idea, there are also neurons 
that represent strange mixtures of ideas.
  Below, a neuron responds to two types of animal faces, and also to car
 bodies.
</p>

<figure class="grid l-page" style="grid-template-columns: repeat(6, 1fr)">
  <div style="">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed4e_55_optimized.png">
    <figcaption>Simple Optimization</figcaption>
  </div>
  <div style="grid-column-end: span 4">
    <img src="Feature%20Visualization_files/mixed4e_55_diversity.png">
    <figcaption>Optimization with diversity show cats, foxes, but also cars. <i>Layer mixed4e, Unit 55</i></figcaption>
  </div>
  <div style="">
    <img style="max-width: 147px;" src="Feature%20Visualization_files/mixed4e_55_examples.jpg">
    <figcaption>Dataset examples</figcaption>
  </div>
</figure>

<p>
  Examples like these suggest that neurons are not necessarily the right semantic units for understanding neural nets.
</p>

<!-- =================================================== -->
<hr>
<h2 id="interaction">Interaction between Neurons</h2>

<p>
  If neurons are not the right way to understand neural nets, what is?
  In real life, combinations of neurons work together to represent images in neural networks.
  A helpful way to think about these combinations is geometrically: let’s define <em>activation space</em> to be all possible combinations of neuron activations.
  We can then think of individual neuron activations as the <em>basis vectors</em> of this activation space. Conversely, a combination of neuron activations is then just a vector in this space.
</p>
<p>
  This framing unifies the concepts “neurons” and “combinations of 
neurons” as “vectors in activation space”. It allows us to ask: Should 
we expect the directions of the basis vectors to be any more 
interpretable than the directions of other vectors in this space?
</p>

<p>
  Szegedy <i>et al.</i><d-cite key="szegedy2013intriguing"></d-cite> found that random directions seem just as meaningful as the directions of the basis vectors.
  More recently Bau, Zhou <i>et al.</i><d-cite key="netdissect2017"></d-cite>
 found the directions of the basis vectors to be interpretable more 
often than random directions.
  Our experience is broadly consistent with both results; we find that 
random directions often seem interpretable, but at a lower rate than 
basis directions.
</p>

<figure class="base-grid">
  <figcaption style="grid-column: kicker;">
    <p>Dataset examples and optimized examples of <strong>random directions</strong> in activation space. The directions shown here were hand-picked for interpretability.</p>
    <div id="colab-random"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/neuron_interaction.ipynb#scrollTo=nxPbPfXzGWCD" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text-start / page-end;" id="random-optimization-and-examples"><div svelte-887141927="" class="frow"><div class="fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -0px -0px; --hover-size: 294px; --hover-position: -0px -0px; --container-size: 180px; --default-ratio: 0.6122448979591837; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt_examples"></div></div></div>
    <div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -0px -0px; --hover-size: 180px; --hover-position: -0px -0px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt"></div></div></div>
    <figcaption><em>mixed3a, random direction</em></figcaption></div>
  
  <div class="fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -294px -0px; --hover-size: 294px; --hover-position: -294px -0px; --container-size: 180px; --default-ratio: 0.6122448979591837; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt_examples"></div></div></div>
    <div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -180px -0px; --hover-size: 180px; --hover-position: -180px -0px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt"></div></div></div>
    <figcaption><em>mixed4c, random direction</em></figcaption></div>
    
  <div class="fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -588px -0px; --hover-size: 294px; --hover-position: -588px -0px; --container-size: 180px; --default-ratio: 0.6122448979591837; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt_examples"></div></div></div>
    <div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -360px -0px; --hover-size: 180px; --hover-position: -360px -0px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt"></div></div></div>
    <figcaption><em>mixed4d, random direction</em></figcaption></div>

  <div class="fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 294px; --default-position: -882px -0px; --hover-size: 294px; --hover-position: -882px -0px; --container-size: 180px; --default-ratio: 0.6122448979591837; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt_examples"></div></div></div>
    <div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -540px -0px; --hover-size: 180px; --hover-position: -540px -0px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner sprite_random_opt"></div></div></div>
    <figcaption><em>mixed5a, random direction</em></figcaption></div></div></d-figure>
</figure>

<p>
  We can also define interesting directions in activation space by doing arithmetic on neurons.
  For example, if we add a “black and white” neuron to a “mosaic” neuron, we obtain a black and white version of the mosaic.
  This is reminiscent of semantic arithmetic of word embeddings as seen in Word2Vec or generative models’ latent spaces.
</p>

<figure class="base-grid shaded-figure">
  <figcaption style="grid-column: kicker;">
    <p>By jointly optimizing two neurons we can get a sense of how they interact.</p>
    <div id="colab-combine"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/neuron_interaction.ipynb#scrollTo=0x-Zi49jGULb" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text-start / screen-end; overflow: visible; contain: unset;" id="linear-combinations"><div svelte-127339819="" class="linear-combinations"><div class="frow"><div id="icons-first" class="fcolumn"><div class="icons"><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -225px -45px; --hover-size: 180px; --hover-position: -180px -0px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -405px -45px; --hover-size: 180px; --hover-position: -360px -0px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -585px -45px; --hover-size: 180px; --hover-position: -540px -0px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon selected"><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -765px -45px; --hover-size: 180px; --hover-position: -720px -0px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -945px -45px; --hover-size: 180px; --hover-position: -900px -0px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -1125px -45px; --hover-size: 180px; --hover-position: -1080px -0px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div></div></div>

    <div id="sprite-first" class="fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -720px -0px; --hover-size: 180px; --hover-position: -720px -0px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div>
      <span class="figcaption">Neuron 1</span></div>

    <div class="operator"></div>

    <div id="sprite-second" class="fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -0px -180px; --hover-size: 180px; --hover-position: -0px -180px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div>
      <span class="figcaption">Neuron 2</span></div>

    <div id="icons-second" class="fcolumn"><div class="icons"><div class="icon selected"><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -45px -225px; --hover-size: 180px; --hover-position: -0px -180px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -45px -405px; --hover-size: 180px; --hover-position: -0px -360px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -45px -585px; --hover-size: 180px; --hover-position: -0px -540px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -45px -765px; --hover-size: 180px; --hover-position: -0px -720px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -45px -945px; --hover-size: 180px; --hover-position: -0px -900px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 90px; --default-position: -45px -1125px; --hover-size: 180px; --hover-position: -0px -1080px; --container-size: 44px; --default-ratio: 0.4888888888888889; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div></div></div></div></div>

  <div class="frow"><div class="result c fcolumn"><div svelte-986317898="" class="sprite outer " style="--default-size: 180px; --default-position: -720px -180px; --hover-size: 180px; --hover-position: -720px -180px; --container-size: 180px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner linear_combinations_sprite"></div></div></div>
      <span class="figcaption">Jointly optimized</span></div></div></div></d-figure>
</figure>

<p>
  These examples show us how neurons jointly represent images.
  To better understand how neurons interact, we can also interpolate between them.
  <d-footnote id="d-footnote-4">The optimization objective is a linear 
interpolation between the individual channel objectives. To get the 
interpolations to look better, we also add a small alignment objective 
that encourages lower layer activations to be similar. We additionally 
use a combination of separate and shared image parameterizations to make
 it easier for the optimization algorithm to cause objects to line up, 
while still giving it the freedom to create any image it needs to.</d-footnote>
  This is similar to interpolating in the latent space of generative models.
</p>

<figure class="base-grid shaded-figure">
  <figcaption style="grid-column: kicker;">
    <div id="colab-interpolation"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/neuron_interaction.ipynb#scrollTo=MxRmLCTlGWSs" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text-start / page-end;" id="interpolation"><div svelte-4203530351="" class="icons"><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -0px; --hover-size: 128px; --hover-position: -0px -0px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon selected"><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -128px; --hover-size: 128px; --hover-position: -0px -128px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -256px; --hover-size: 128px; --hover-position: -0px -256px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -384px; --hover-size: 128px; --hover-position: -0px -384px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -512px; --hover-size: 128px; --hover-position: -0px -512px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -640px; --hover-size: 128px; --hover-position: -0px -640px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -768px; --hover-size: 128px; --hover-position: -0px -768px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -896px; --hover-size: 128px; --hover-position: -0px -896px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -1024px; --hover-size: 128px; --hover-position: -0px -1024px; --container-size: 44px; --default-ratio: 0.34375; --hover-scale: 0.34375; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div></div></div>
<div svelte-4203530351="" class="images"><div><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -0px -128px; --hover-size: 128px; --hover-position: -0px -128px; --container-size: 128px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 128px;">Layer 4a, Unit 476</figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -128px -128px; --hover-size: 128px; --hover-position: -128px -128px; --container-size: 128px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 128px;"></figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -256px -128px; --hover-size: 128px; --hover-position: -256px -128px; --container-size: 128px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 128px;"></figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -384px -128px; --hover-size: 128px; --hover-position: -384px -128px; --container-size: 128px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 128px;"></figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -512px -128px; --hover-size: 128px; --hover-position: -512px -128px; --container-size: 128px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 128px;"></figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 128px; --default-position: -640px -128px; --hover-size: 128px; --hover-position: -640px -128px; --container-size: 128px; --default-ratio: 1; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner interpolation-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 128px;">Layer 4a, Unit 460</figcaption></div></div></d-figure>
</figure>

<p>
  This is only starting to scratch the surface of how neurons interact.
  The truth is that we have almost no clue how to select meaningful 
directions, or whether there even exist particularly meaningful 
directions.
  Independent of finding directions, there are also questions on how 
directions interact — for example, interpolation can show us how a small
 number of directions interact, but in reality there are hundreds of 
directions interacting.
</p>


<!-- =================================================== -->
<hr>
<h2 id="enemy-of-feature-vis">The Enemy of Feature Visualization</h2>

<p>
  If you want to visualize features, you might just optimize an image to
 make neurons fire.
  Unfortunately, this doesn’t really work.
  Instead, you end up with a kind of neural network optical 
illusion — an image full of noise and nonsensical high-frequency 
patterns that the network responds strongly to.
</p>

<figure class="shaded-figure base-grid">
  <figcaption style="grid-column: kicker;">
    <p>Even if you carefully tune learning rate, you’ll get noise.</p>
    <p>Optimization results are enlarged to show detail and artifacts.</p>
    <br>
    <div id="colab-regularization-naive"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/regularization.ipynb#scrollTo=d3ZKjNizGWtD" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text;" id="optimize-naive"><div svelte-1716951829="" class="controls"><div class="config-group"><div class="config config-icon" data-config-name="neurons"><div class="icons"><div class="icon selected" style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -272px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -612px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -952px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -1292px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -1632px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -1972px -1026.8px; width: 68px; height: 68px;"></div></div></div></div>
      
          
          
          </div></div><div class="config-group"><div class="config config-number" data-config-name="learning_rate">
      
          
          
          <label><span>Learning Rate<noscript></noscript>
                <span class="value">(0.05)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="5" aria-valuemax="5" step="1" ticks="true" value="3" aria-valuenow="3" role="slider" tabindex="0"></d-slider></div></div></div>
  </div>

<div svelte-1716951829="" class="images"><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-position: 0px -136px; width: 68px; height: 68px; margin: 34px; transform: scale(2); background-image: url(&quot;images/Preconditioner.jpg&quot;);"></div>
      <figcaption>Step 1</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -68px -136px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 32</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -136px -136px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 128</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -204px -136px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 256</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -272px -136px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 2048</figcaption></div></div></d-figure>
</figure>

<p>
  These patterns seem to be the images kind of cheating, finding ways to activate neurons that don’t occur in real life.
  If you optimize long enough, you’ll tend to see some of what the neuron genuinely detects as well,
  but the image is dominated by these high frequency patterns.
  These patterns seem to be closely related to the phenomenon of adversarial examples <d-cite key="szegedy2013intriguing"></d-cite>.
</p>

<p>
  We don’t fully understand why these high frequency patterns form,
  but an important part seems to be strided convolutions and pooling 
operations, which create high-frequency patterns in the gradient <d-cite key="odena2016deconvolution"></d-cite>.
</p>

<figcaption>Each <b>strided convolution or pooling</b> creates checkerboard patterns in the gradient magnitudes when we backprop through it. <dt-cite key="odena2016deconvolution"></dt-cite></figcaption>
<figure style="grid-column: page;">
  <d-figure id="frequency-artifacts"><div svelte-1825949572="" class="layers"><div class="outer"><div class="grad" style="background-position: -224px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>input</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="0"></div><div class="outer"><div class="grad" style="background-position: -448px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>conv2d0</figcaption></div>
    <div class="op highlight" style="top: 45px; width: 8px; height: 80px; background: rgb(255, 102, 0) none repeat scroll 0% 0%; border-radius: 4px;" data-n="1"></div><div class="outer"><div class="grad" style="background-position: -672px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>conv2d1</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="2"></div><div class="outer"><div class="grad" style="background-position: -896px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>conv2d2</figcaption></div>
    <div class="op highlight" style="top: 45px; width: 8px; height: 80px; background: rgb(255, 102, 0) none repeat scroll 0% 0%; border-radius: 4px;" data-n="3"></div><div class="outer"><div class="grad" style="background-position: -1120px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed3a</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="4"></div><div class="outer"><div class="grad" style="background-position: -1344px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed3b</figcaption></div>
    <div class="op highlight" style="top: 45px; width: 8px; height: 80px; background: rgb(255, 102, 0) none repeat scroll 0% 0%; border-radius: 4px;" data-n="5"></div><div class="outer"><div class="grad" style="background-position: -1568px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed4a</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="6"></div><div class="outer"><div class="grad" style="background-position: -1792px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed4b</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="7"></div><div class="outer"><div class="grad" style="background-position: -2016px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed4c</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="8"></div><div class="outer"><div class="grad" style="background-position: -2240px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed4d</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: rgb(217, 217, 242) none repeat scroll 0% 0%; border-radius: 4px;" data-n="9"></div><div class="outer"><div class="grad" style="background-position: -2464px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed4e</figcaption></div>
    <div class="op highlight" style="top: 45px; width: 8px; height: 80px; background: rgb(255, 102, 0) none repeat scroll 0% 0%; border-radius: 4px;" data-n="10"></div><div class="outer"><div class="grad" style="background-position: -2688px 0px; transform: scale(0.3125); filter: contrast(200%); margin: -77px; width: 224px; height: 224px;"></div>
      <figcaption>mixed5a</figcaption></div>
    <div class="op" style="top: 45px; width: 8px; height: 80px; background: white none repeat scroll 0% 0%; border-radius: 4px;" data-n="11"></div></div></d-figure>
</figure>


<p>
  These high-frequency patterns show us that, while optimization based 
visualization’s freedom from constraints is appealing, it’s a 
double-edged sword.
  Without any constraints on images, we end up with adversarial 
examples.
  These are certainly interesting, but if we want to understand how 
these models work in real life, we need to somehow move past them…
</p>

<h3 id="regularization">The Spectrum of Regularization</h3>

<p>
  Dealing with this high frequency noise has been one of the primary 
challenges and overarching threads of feature visualization research.
  If you want to get useful visualizations, you need to impose a more 
natural structure using some kind of prior, regularizer, or constraint.
</p>

<p>
  In fact, if you look at most notable papers on feature visualization, 
one of their main points will usually be an approach to regularization.
  Researchers have tried a lot of different things!
</p>

<p>
  We can think of all of these approaches as living on a spectrum, based on how strongly they regularize the model.
  On one extreme, if we don’t regularize at all, we end up with adversarial examples.
  On the opposite end, we search over examples in our dataset and run into all the limitations we discussed earlier.
  In the middle we have three main families of regularization options.
</p>


<style>
  #feature-vis-history .row {
  }
  #feature-vis-history .line {
    width: 900px;
  }
  #feature-vis-history .row .info {
    display: inline-block;
    width: 320px;
    height: 56px;
    vertical-align: top;
  }
  #feature-vis-history .row .info img {
    width: 56px;
    height: 56px;
    border-radius: 5px;
    background: #EEE;
  }
  #feature-vis-history figcaption {
    line-height: 16px;
    vertical-align: top;
  }
  #feature-vis-history .row .info figcaption {
    width: 250px;
    margin-left: 8px;
    display: inline-block;
  }
  #feature-vis-history .row.header-row .info figcaption {
    margin-left: 0;
  }
  #feature-vis-history .header-row .sub-headers {
    display: inline-block;
    margin-top: 16px;
    margin-bottom: 10px;
    vertical-align: top;
  }
  #feature-vis-history .header-row .sub-headers figcaption {
    width: 100px; /*104px;*/
    display: inline-block;
    word-wrap: break-word;
    word-break: keep-all;
  }

  #feature-vis-history .row .spacer {
    display: inline-block;
    height: 48px;
    width: 45px;
  }

  #feature-vis-history .info p {
    margin-bottom: 4px;
  }

  #feature-vis-history .info .paper-title {
    font-weight: bold;
  }

  #feature-vis-history .info .paper-text {

  }

  @media (max-width: 1100px) {
    #feature-vis-history .row .spacer {
      display: inline-block;
      height: 48px;
      width: 24px;
    }
    #feature-vis-history .line {
      width: 750px;
    }
  }

  #feature-vis-history .row .category-check-container {
    /*vertical-align: middle;*/
    display: inline-block;
    margin: 8px;
    margin-left: 0px;
    margin-right: 70px;
    width: 32px;
    height: 32px;
    border-radius: 5px;
    border: 1px solid #CCC;
  }
  #feature-vis-history .row .category-check-container .category-check {
    margin: 6px;
    width: 20px;
    height: 20px;
    border-radius: 6px;
  }
  #feature-vis-history .row .category-check-container .set {
    background: #909092;
  }
  #feature-vis-history .line {
    margin-top: 4px;
    margin-bottom: 4px;
    margin-left: 67px;
    height: 1px;
    background: #EAEAEA;
  }

</style>

<figure style="grid-column: screen; min-height: 750px; overflow-x: scroll;" id="feature-vis-history">
<div class="wrapper" style="min-width: 950px; width: 950px; padding: 0 1rem; margin: 0 auto;">
<div svelte-1206690277="" class="row header-row"><div class="info"></div>
<div class="spacer"></div>
<div style="display: inline-block;"><div class="info" style="display: block; width: 300px;"><figcaption style="width: 200px; height: 60px;"><b>Weak Regularization</b>
      avoids misleading correlations, but is less connected to real use.</figcaption></div>
  <div class="sub-headers" style="display: block;"><figcaption><b>Unregularized</b></figcaption>
    <figcaption><b><div>Frequency</div><div style="margin-top: 0px;">Penalization</div></b></figcaption>
    <figcaption><b><div>Transformation</div><div style="margin-top: 0px;">Robustness</div></b></figcaption></div></div>
<div class="spacer"></div>
<div style="display: inline-block;"><div class="" style="display: block;"><figcaption style="width: 190px; height: 60px;"><b>Strong Regularization</b>
      gives more realistic examples at risk of misleading correlations.</figcaption></div>
  <div class="sub-headers" style="display: block;"><figcaption><b><div>Learned</div><div style="margin-top: 0px;">Prior</div></b></figcaption>
  <figcaption><b><div>Dataset</div><div style="margin-top: 0px;">Examples</div></b></figcaption></div></div></div>

<div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Erhan2009.png">
    <figcaption><p class="paper-title">Erhan, <i>et al.</i>, 2009<noscript></noscript> <d-cite key="erhan2009visualizing"></d-cite></p>
      <p class="paper-text">Introduced core idea. Minimal regularization.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Szegedy2013.png">
    <figcaption><p class="paper-title">Szegedy, <i>et al.</i>, 2013<noscript></noscript> <d-cite key="szegedy2013intriguing"></d-cite></p>
      <p class="paper-text">Adversarial examples. Visualizes with dataset examples.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Mahendran2015.png">
    <figcaption><p class="paper-title">Mahendran &amp; Vedaldi, 2015<noscript></noscript> <d-cite key="mahendran2015understanding"></d-cite></p>
      <p class="paper-text">Introduces total variation regularizer. Reconstructs input from representation.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Nguyen2015.png">
    <figcaption><p class="paper-title">Nguyen, <i>et al.</i>, 2015<noscript></noscript> <d-cite key="nguyen2015deep"></d-cite></p>
      <p class="paper-text">Explores counterexamples. Introduces image blurring.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Mordvintsev2015.png">
    <figcaption><p class="paper-title">Mordvintsev, <i>et al.</i>, 2015<noscript></noscript> <d-cite key="mordvintsev2015inceptionism"></d-cite></p>
      <p class="paper-text">Introduced jitter &amp; multi-scale. Explored GMM priors for classes.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Oygard2015.png">
    <figcaption><p class="paper-title">Øygard, <i>et al.</i>, 2015<noscript></noscript> <d-cite key="oygard2015vis"></d-cite></p>
      <p class="paper-text">Introduces gradient blurring. <br>(Also uses jitter.)</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check set"></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Tyka2016.png">
    <figcaption><p class="paper-title">Tyka, <i>et al.</i>, 2016<noscript></noscript> <d-cite key="tyka2016bilateral"></d-cite></p>
      <p class="paper-text">Regularizes with bilateral filters. <br>(Also uses jitter.)</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check set"></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Mordvintsev2016.png">
    <figcaption><p class="paper-title">Mordvintsev, <i>et al.</i>, 2016<noscript></noscript> <d-cite key="mordvintsev2016deepdreaming"></d-cite></p>
      <p class="paper-text">Normalizes gradient frequencies. <br>(Also uses jitter.)</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check set"></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Nguyen2016a.png">
    <figcaption><p class="paper-title">Nguyen, <i>et al.</i>, 2016<noscript></noscript> <d-cite key="nguyen2016synthesizing"></d-cite></p>
      <p class="paper-text">Paramaterizes images with GAN generator.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><div svelte-1206690277="" class="row"><div class="info"><img src="Feature%20Visualization_files/Nguyen2016b.png">
    <figcaption><p class="paper-title">Nguyen, <i>et al.</i>, 2016<noscript></noscript> <d-cite key="nguyen2016plug"></d-cite></p>
      <p class="paper-text">Uses denoising autoencoder prior to make a generative model.</p></figcaption></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div><div class="category-check-container"><div class="category-check "></div></div>

  <div class="spacer"></div>

  <div class="category-check-container"><div class="category-check set"></div></div><div class="category-check-container"><div class="category-check "></div></div></div>
<div svelte-1206690277="" class="line"></div><!---->
</div>
</figure>

<!-- <d-figure id="feature-vis-history"></d-figure> -->

<h3 id="regularization-families">Three Families of Regularization</h3>

<p>
  Let’s consider these three intermediate categories of regularization in more depth.
</p>

<p>
  <b>Frequency penalization</b> directly targets the high frequency noise these methods suffer from.
  It may explicitly penalize variance between neighboring pixels (total variation) <d-cite key="mahendran2015understanding"></d-cite>, or implicitly penalize high-frequency noise by blurring the image each optimization step <d-cite key="nguyen2015deep"></d-cite>.<d-footnote id="d-footnote-5">
    If we think about blurring in Fourier space, it is equivalent to 
adding a scaled L2 penalty to the objective, penalizing each 
Fourier-component based on its frequency.</d-footnote>
  Unfortunately, these approaches also discourage legitimate high-frequency features like edges along with noise.
  This can be slightly improved by using a bilateral filter, which preserves edges, instead of blurring <d-cite key="tyka2016bilateral"></d-cite>.
</p>

<p>
  (Some work uses similar techniques to reduce high frequencies in the gradient before they accumulate in the visualization <d-cite key="oygard2015vis,mordvintsev2016deepdreaming"></d-cite>.
  These techniques are in some ways very similar to the above and in 
some ways radically different — we’ll examine them in the next section, <a href="#preconditioning">Preconditioning and Parameterization</a>.)
</p>

<figure class="shaded-figure base-grid">
  <figcaption style="grid-column: kicker;">
    <p>Frequency penalization directly targets high frequency noise</p>
    <div id="colab-regularization-freq"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/regularization.ipynb#scrollTo=zlIWBnagGd4q" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text;" id="regularizer-playground-freq"><div svelte-1716951829="" class="controls"><div class="config-group"><div class="config config-icon" data-config-name="neurons"><div class="icons"><div class="icon selected" style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/PenalizeFreq2.jpg&quot;) repeat scroll -272px -2924px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/PenalizeFreq2.jpg&quot;) repeat scroll -612px -2924px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/PenalizeFreq2.jpg&quot;) repeat scroll -952px -2924px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/PenalizeFreq2.jpg&quot;) repeat scroll -1292px -2924px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/PenalizeFreq2.jpg&quot;) repeat scroll -1632px -2924px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/PenalizeFreq2.jpg&quot;) repeat scroll -1972px -2924px; width: 68px; height: 68px;"></div></div></div></div>
      
          
          
          </div></div><div class="config-group"><div class="config config-number" data-config-name="l1">
      
          
          
          <label><span>L<sub>1</sub><noscript></noscript>
                <span class="value">(-0.05)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="4" aria-valuemax="4" step="1" ticks="true" value="2" aria-valuenow="2" role="slider" tabindex="0"></d-slider></div></div></div><div class="config-group"><div class="config config-number" data-config-name="tv">
      
          
          
          <label><span>Total Variation<noscript></noscript>
                <span class="value">(-0.25)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="5" aria-valuemax="5" step="1" ticks="true" value="3" aria-valuenow="3" role="slider" tabindex="0"></d-slider></div></div></div><div class="config-group"><div class="config config-number" data-config-name="blur">
      
          
          
          <label><span>Blur<noscript></noscript>
                <span class="value">(-1)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="5" aria-valuemax="5" step="1" ticks="true" value="3" aria-valuenow="3" role="slider" tabindex="0"></d-slider></div></div></div>
  </div>

<div svelte-1716951829="" class="images"><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-position: 0px -2516px; width: 68px; height: 68px; margin: 34px; transform: scale(2); background-image: url(&quot;images/PenalizeFreq2.jpg&quot;);"></div>
      <figcaption>Step 1</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/PenalizeFreq2.jpg&quot;); background-position: -68px -2516px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 32</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/PenalizeFreq2.jpg&quot;); background-position: -136px -2516px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 128</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/PenalizeFreq2.jpg&quot;); background-position: -204px -2516px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 256</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/PenalizeFreq2.jpg&quot;); background-position: -272px -2516px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 2048</figcaption></div></div></d-figure>
</figure>
<!--
  - none
  - Total variance
  - Blur
-->


<p>
  <b>Transformation robustness</b> tries to find examples that still activate the optimization target highly even if we slightly transform them.
  Even a small amount seems to be very effective in the case of images <d-cite key="mordvintsev2015inceptionism"></d-cite>,
  especially when combined with a more general regularizer for high-frequencies <d-cite key="oygard2015vis,mordvintsev2016deepdreaming"></d-cite>.
  Concretely, this means that we stochastically jitter, rotate or scale the image before applying the optimization step.
</p>


<!--<figure id="optimize-jitter" class="l-page-outset"></figure>-->

<figure class="shaded-figure base-grid">
  <figcaption style="grid-column: kicker;">
    <p>Stochastically transforming the image before applying the optimization step suppresses noise</p>
    <div id="colab-regularization-transform"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/regularization.ipynb#scrollTo=mSDJKMf5GeZy" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text;" id="regularizer-playground-robust"><div svelte-1716951829="" class="controls"><div class="config-group"><div class="config config-icon" data-config-name="neurons"><div class="icons"><div class="icon selected" style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/TransformExplore.jpg&quot;) repeat scroll -272px -4760px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/TransformExplore.jpg&quot;) repeat scroll -612px -4760px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/TransformExplore.jpg&quot;) repeat scroll -952px -4760px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/TransformExplore.jpg&quot;) repeat scroll -1292px -4760px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/TransformExplore.jpg&quot;) repeat scroll -1632px -4760px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/TransformExplore.jpg&quot;) repeat scroll -1972px -4760px; width: 68px; height: 68px;"></div></div></div></div>
      
          
          
          </div></div><div class="config-group"><div class="config config-number" data-config-name="jitter">
      
          
          
          <label><span>Jitter<noscript></noscript>
                <span class="value">(1px)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="4" aria-valuemax="4" step="1" ticks="true" value="2" aria-valuenow="2" role="slider" tabindex="0"></d-slider></div></div></div><div class="config-group"><div class="config config-number" data-config-name="random_rotate">
      
          
          
          <label><span>Rotate<noscript></noscript>
                <span class="value">(5°)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="5" aria-valuemax="5" step="1" ticks="true" value="2" aria-valuenow="2" role="slider" tabindex="0"></d-slider></div></div></div><div class="config-group"><div class="config config-number" data-config-name="random_scale">
      
          
          
          <label><span>Scale<noscript></noscript>
                <span class="value">(1.1×)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="4" aria-valuemax="4" step="1" ticks="true" value="2" aria-valuenow="2" role="slider" tabindex="0"></d-slider></div></div></div>
  </div>

<div svelte-1716951829="" class="images"><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-position: 0px -1700px; width: 68px; height: 68px; margin: 34px; transform: scale(2); background-image: url(&quot;images/TransformExplore.jpg&quot;);"></div>
      <figcaption>Step 1</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/TransformExplore.jpg&quot;); background-position: -68px -1700px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 32</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/TransformExplore.jpg&quot;); background-position: -136px -1700px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 128</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/TransformExplore.jpg&quot;); background-position: -204px -1700px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 256</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/TransformExplore.jpg&quot;); background-position: -272px -1700px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 2048</figcaption></div></div></d-figure>
</figure>

<!--TODO(colah): Make a diagram of unconstraint opt vs paramaterized opt vs prior? Discuss using an inverse model?-->

<!-- technically most challenging -->

<p>
  <b id="learned-priors">Learned priors.</b>
  Our previous regularizers use very simple heuristics to keep examples 
reasonable.
  A natural next step is to actually learn a model of the real data and 
try to enforce that.
  With a strong model, this becomes similar to searching over the 
dataset.
  This approach produces the most photorealistic visualizations, but it 
may be unclear what came from the model being visualized and what came 
from the prior.
</p>

<p>
  One approach is to learn a generator that maps points in a latent space to examples of your data,
  such as a GAN or VAE,
  and optimize within that latent space <d-cite key="nguyen2016synthesizing"></d-cite>.
  An alternative approach is to learn a prior that gives you access to the gradient of probability;
  this allows you to jointly optimize for the prior along with your objective <d-cite key="nguyen2016plug,mordvintsev2015inceptionism"></d-cite>.
  When one optimizes for the prior and the probability of a class, one 
recovers a generative model of the data conditioned on that particular 
class.
  Finally, Wei <i>et al.</i><d-cite key="mneuron2015"></d-cite> 
approximate a generative model prior, at least for the color 
distribution, by penalizing distance between patches of the output and 
the nearest patches retrieved from a database of image patches collected
 from the training data.
</p>




<!-- =================================================== -->
<hr>
<h2 id="preconditioning">Preconditioning and Parameterization</h2>

<br>

<p>
  In the previous section, we saw a few methods <d-cite key="oygard2015vis,mordvintsev2016deepdreaming"></d-cite> that reduced high frequencies <i>in the gradient</i> rather than the visualization itself.
  It’s not clear this is really a regularizer:
  it resists high frequencies, but still allows them to form when the gradient consistently pushes for it.
  If it isn’t a regularizer, what does transforming the gradient like this do?
</p>

<p>
  Transforming the gradient like this is actually quite a powerful tool — it’s called “preconditioning” in optimization.
  You can think of it as doing steepest descent to optimize the same objective,
  but in another parameterization of the space or under a different notion of distance.
  <d-footnote id="d-footnote-6">
    Gradient blurring<d-cite key="oygard2015vis"></d-cite> is equivalent
 to gradient descent in a different parameterization of image space, 
where high frequency dimensions are stretched to make moving in those 
directions slower. Gradient Laplacian Pyramid normalization <d-cite key="mordvintsev2016deepdreaming"></d-cite> is a kind of adaptive learning rate approach in the same space.
  </d-footnote>
  This changes which direction of descent will be steepest, and how fast
 the optimization moves in each direction, but it does not change what 
the minimums are.
  If there are many local minima, it can stretch and shrink their basins
 of attraction, changing which ones the optimization process falls into.
  As a result, using the right preconditioner can make an optimization 
problem radically easier.
</p>
<p>
  How can we choose a preconditioner that will give us these benefits?
  A good first guess is one that makes your data decorrelated and whitened.
  In the case of images this means doing gradient descent in the Fourier basis,
  <d-footnote id="d-footnote-7">
    This points to a profound fact about the Fourier transform.
    As long as a correlation is consistent across spatial 
positions — such as the correlation between a pixel and its left 
neighbor being the same across all positions of an image — the Fourier 
coefficients will be independent variables.
    To see this, note that such a spatially consistent correlation can 
be expressed as a convolution, and by the convolution theorem becomes 
pointwise multiplication after the Fourier transform.
  </d-footnote>
  with frequencies scaled so that they all have equal energy.
  <d-footnote id="d-footnote-8">
      Note that we have to be careful to get the colors to be 
decorrelated, too. The Fourier transforms decorrelates spatially, but a 
correlation will still exist between colors.
      To address this, we explicitly measure the correlation between 
colors in the training set and use a Cholesky decomposition to 
decorrelate them. Compare the directions of steepest decent before and 
after decorrelating colors:
      <br>
      <span style="display: block; padding-top: 1em;">
        <span style="display: inline-block;">
          <img style="height: 112px; width: 112px; display: block;" src="Feature%20Visualization_files/correlated_colors.jpeg">
          <span class="figcaption">
            Correlated Colors
          </span>
        </span>
        <span style="display: inline-block;">
          <img style="height: 112px; width: 112px; display: block;" src="Feature%20Visualization_files/decorrelated_colors.jpeg">
          <span class="figcaption">
            Decorrelated Colors
          </span>
        </span>
      </span>
  </d-footnote>
</p>
<p>
  Let’s see how using different measures of distance changes the direction of steepest descent.
  The regular L<sup>2</sup> gradient can be quite different from the directions of steepest descent in the L<sup>∞</sup> metric or in the decorrelated space:
</p>

<figure class="shaded-figure base-grid">
  <figcaption style="grid-column: kicker">
    Three directions of steepest descent under different notions of distance
  </figcaption>
  <d-figure style="grid-column: text-start / screen-end;" id="steepest-descent"><div svelte-4203530351="" class="icons"><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -0px; --hover-size: 224px; --hover-position: -0px -0px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -224px; --hover-size: 224px; --hover-position: -0px -224px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -448px; --hover-size: 224px; --hover-position: -0px -448px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -672px; --hover-size: 224px; --hover-position: -0px -672px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -896px; --hover-size: 224px; --hover-position: -0px -896px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -1120px; --hover-size: 224px; --hover-position: -0px -1120px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -1344px; --hover-size: 224px; --hover-position: -0px -1344px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -1568px; --hover-size: 224px; --hover-position: -0px -1568px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -1792px; --hover-size: 224px; --hover-position: -0px -1792px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon selected"><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -2016px; --hover-size: 224px; --hover-position: -0px -2016px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -2240px; --hover-size: 224px; --hover-position: -0px -2240px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -2464px; --hover-size: 224px; --hover-position: -0px -2464px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -2688px; --hover-size: 224px; --hover-position: -0px -2688px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div><div class="icon "><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -2912px; --hover-size: 224px; --hover-position: -0px -2912px; --container-size: 44px; --default-ratio: 0.19642857142857142; --hover-scale: 0.19642857142857142; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div></div></div>
<div svelte-4203530351="" class="images"><div><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -0px -2016px; --hover-size: 224px; --hover-position: -0px -2016px; --container-size: 170px; --default-ratio: 0.7589285714285714; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 170px;">Image</figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -224px -2016px; --hover-size: 224px; --hover-position: -224px -2016px; --container-size: 170px; --default-ratio: 0.7589285714285714; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 170px;"><strong>L<sup>∞</sup> metric</strong> <br>used in adverserial work</figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -448px -2016px; --hover-size: 224px; --hover-position: -448px -2016px; --container-size: 170px; --default-ratio: 0.7589285714285714; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 170px;"><strong>L<sup>2</sup> metric</strong> <br>regular gradient</figcaption></div><div><div svelte-986317898="" class="sprite outer " style="--default-size: 224px; --default-position: -672px -2016px; --hover-size: 224px; --hover-position: -672px -2016px; --container-size: 170px; --default-ratio: 0.7589285714285714; --hover-scale: 1; --transition_css: width 0.1s ease-out, height 0.1s ease-out, margin 0.1s ease-out, transform 0.1s ease-out; --border_css: none; --pixelated: pixelated;"><div class="mid"><div class="inner steepst-dir-sprite"></div></div></div>
      <br style="clear: left;">
      <figcaption style="max-width: 170px;"><strong>decorrelated space</strong></figcaption></div></div></d-figure>
</figure>

<p>
  All of these directions are valid descent directions for the same objective,
  but we can see they’re radically different.
  Notice that optimizing in the decorrelated space reduces high frequencies,
  while using L<sup>∞</sup> increases them.
</p>

<p>
  Using the decorrelated descent direction results in quite different visualizations.
  It’s hard to do really fair comparisons because of hyperparameters, but the
  resulting visualizations seem a lot better — and develop faster, too.
</p>

<figure class="shaded-figure base-grid">
  <figcaption style="grid-column: kicker;">
    <p>Combining the preconditioning and transformation robustness improves quality even further</p>
    <div id="colab-regularization-preconditioner"><a svelte-3193739540="" href="https://colab.research.google.com/github/tensorflow/lucid/blob/master/notebooks/feature-visualization/regularization.ipynb#scrollTo=gvF6j5h4GkDe" class="colab-root">Reproduce in a
    <span>Notebook</span></a></div>
  </figcaption>
  <d-figure style="grid-column: text;" id="opt-explore2"><div svelte-1716951829="" class="controls"><div class="config-group"><div class="config config-icon" data-config-name="neurons"><div class="icons"><div class="icon selected" style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -272px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -612px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -952px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -1292px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -1632px -1026.8px; width: 68px; height: 68px;"></div></div></div><div class="icon " style="width: 44px; height: 44px;"><div class="inner" style="margin: -12px; transform: scale(0.647059);"><div class="inner" style="background: rgba(0, 0, 0, 0) url(&quot;images/Preconditioner.jpg&quot;) repeat scroll -1972px -1026.8px; width: 68px; height: 68px;"></div></div></div></div>
      
          
          
          </div></div><div class="config-group"><div class="config config-number" data-config-name="learning_rate">
      
          
          
          <label><span>Learning Rate<noscript></noscript>
                <span class="value">(0.05)</span></span></label>
            <div style="width: 100px;"><d-slider type="range" min="1" aria-valuemin="1" max="5" aria-valuemax="5" step="1" ticks="true" value="3" aria-valuenow="3" role="slider" tabindex="0"></d-slider></div></div></div><div class="config-group"><div class="config config-binary" data-config-name="decorrelate">
      
          <label><input type="checkbox" checked="checked">
              <noscript></noscript>Decorrelated Space</label>
          
          </div><div class="config config-binary" data-config-name="transforms">
      
          <label><input type="checkbox" checked="checked">
              <noscript></noscript>Transformation Robustness</label>
          
          </div></div>
  </div>

<div svelte-1716951829="" class="images"><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-position: 0px -1156px; width: 68px; height: 68px; margin: 34px; transform: scale(2); background-image: url(&quot;images/Preconditioner.jpg&quot;);"></div>
      <figcaption>Step 1</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -68px -1156px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 32</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -136px -1156px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 128</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -204px -1156px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 256</figcaption></div><div class="outer" style="width: 136px; height: 136px;"><div class="inner" style="background-image: url(&quot;images/Preconditioner.jpg&quot;); background-position: -272px -1156px; width: 68px; height: 68px; margin: 34px; transform: scale(2);"></div>
      <figcaption>Step 2048</figcaption></div></div></d-figure>
</figure>

<p>
  (Unless otherwise noted, the images in this article were optimizing in
 the decorrelated space and a suite of transformation robustness 
techniques.
  <d-footnote id="d-footnote-9">
    Images were optimized for 2560 steps in a color-decorrelated 
fourier-transformed space, using Adam at a learning rate of 0.05.
    We used each of following transformations in the given order at each
 step of the optimization:<br><br>
    • Padding the input by 16 pixels to avoid edge artifacts<br>
    • Jittering by up to 16 pixels<br>
    • Scaling by a factor randomly selected from this list: 1, 0.975, 1.025, 0.95, 1.05<br>
    • Rotating by an angle randomly selected from this list; in degrees: -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5<br>
    • Jittering a second time by up to 8 pixels<br>
    • Cropping the padding<br>
  </d-footnote>)
</p>

<p>
  Is the preconditioner merely accelerating descent, bringing us to the 
same place
  normal gradient descent would have brought us if we were patient 
enough?
  Or is it also regularizing, changing which local minima we get 
attracted to?
  It’s hard to tell for sure.
  On the one hand, gradient descent seems to continue improving as you 
exponentially increase the number of optimization steps — it hasn’t 
converged, it’s just moving very slowly.
  On the other hand, if you turn off all other regularizers, the 
preconditioner seems to reduce high-frequency patterns.
</p>

<!-- =================================================== -->
<hr>
<h2 id="conclusion">Conclusion</h2>

<p class="">
  Neural feature visualization has made great progress over the last few years.
  As a community, we’ve developed principled ways to create compelling visualizations.
  We’ve mapped out a number of important challenges and found ways of addressing them.
</p>

<p class="">
  In the quest to make neural networks interpretable, feature visualization
  stands out as one of the most promising and developed research directions.
  By itself, feature visualization will never give a completely satisfactory
  understanding. We see it as one of the fundamental building blocks that,
  combined with additional tools, will empower humans to understand these systems.
</p>

<p>
  There remains still a lot of important work to be done in improving 
feature visualization.
  Some issues that stand out include understanding neuron interaction, 
finding which units are most meaningful for understanding neural net 
activations, and giving a holistic view of the facets of a feature.
</p>

<!--
<p>
  In the meantime, curious readers are invited to explore
  <a href="appendix/">visualizations of all GoogLeNet channels</a>,
  and our <a href="https://github.com/tensorflow/lucid">open-source implementation, lucid</a>.
  Readers may also wish to look at our follow-up paper, <a href="https://distill.pub/2018/building-blocks/">The Building Blocks of Interpretability</a>, which explores how feature visualization can be combined with other techniques to interrogate the behavior of neural networks.
</p>
-->

</d-article>

<d-appendix>
<style>

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

</style>




  <h3 id="additional-resources">Additional Resources</h3>
  <p>
    <a href="https://distill.pub/2017/feature-visualization/appendix/"><b>Appendix:</b> GoogLeNet Visualizations</a><br>
    Visualizations of every channel in GoogLeNet
  </p>
  <p>
    <a href="https://github.com/tensorflow/lucid"><b>Code:</b> tensorflow/lucid</a><br>
    Open-source implementation of our techniques
  </p>
  <p>
    <a href="https://distill.pub/2018/building-blocks/"><b>Follow-up:</b> The Building Blocks of Interpretability</a><br>
    Exploration of how feature visualization and other techniques can be combined.
  </p>

  <h3 id="acknowledgements">Acknowledgments</h3>
  <p>
    We are extremely grateful to Shan Carter and Ian Goodfellow.
    Shan gave thoughtful feedback, especially on the design of the 
article.
    Ian generously stepped in to handle the review process of this 
article — we would not have been able to publish it without him.
  </p>

  <p>
    We’re also grateful for the comments, thoughts and support of
    Arvind Satyanarayan, Ian Johnson,
    Greg Corrado, Blaise Aguera y Arcas,
    Katherine Ye, Michael Nielsen, Emma Pierson, Dario Amodei,
    Mike Tyka,
    Andrea Vedaldi, Ruth Fong, Jason Freidenfelds,
    Geoffrey Hinton,
    Timon Ruban,
    Been Kim, Martin Wattenberg, and Fernanda Viegas.
  </p>

  <p>
    This work was made possible by many open source tools, for which we are grateful.
    In particular, all of our experiments were based on Tensorflow<d-cite key="abadi2016tensorflow"></d-cite>.
  </p>

  <h3 id="author-contributions">Author Contributions</h3>
  <p>
    <strong>Writing, Exposition, and Diagram Contributions.</strong> 
Chris drafted most of the text of the article and made the original 
version of most interactive diagrams. Ludwig made the neuron addition, 
dataset examples, and interpolation diagrams, as well as refined the 
others. Ludwig also created the appendix that visualizes all of 
GoogLeNet.
  </p>
  <p>
    <strong>Research Contributions.</strong> The biggest technical 
contribution of this work is likely the section on preconditioning. Alex
 discovered in prior work that normalizing gradient frequencies had a 
radical effect on visualizing neurons. Chris reframed this as adaptive 
gradient descent in a different basis. Together, they iterated on a 
number of ways of parameterizing images. Similarly, Alex originally 
introduced the use of diversity term, and Chris reﬁned using it. Chris 
did the exploration of interpolating between neurons.
  </p>
  <p>
    <strong>Infrastructure Contributions.</strong> All experiments are based on code written by Alex, some of which was <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/deepdream/deepdream.ipynb">published previously</a>. Alex, Chris and Ludwig all contributed significantly to refining this into the present library, <a href="https://github.com/tensorflow/lucid">Lucid</a>. Alex and Chris introduced particularly important abstractions.
  </p>

  <h3 id="discussion-review">Discussion and Review</h3>
  <p>
    <a href="https://github.com/distillpub/post--feature-visualization/issues/1">Review 1 - Anonymous</a><br>
    <a href="https://github.com/distillpub/post--feature-visualization/issues/4">Review 2 - Anonymous</a><br>
    <a href="https://github.com/distillpub/post--feature-visualization/issues/6">Review 3 - Anonymous</a><br>
  </p>

  <d-footnote-list style="">
<style>

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}

</style>

<h3>Footnotes</h3>
<ol><li id="d-footnote-1-listing">
        As a young field, neural network interpretability does not yet 
have standardized terminology.
        Attribution has gone under many different names in the 
literature — including “feature visualization”! — but recent work seems 
to prefer terms like “attribution” and “saliency maps”.
      <a class="footnote-backlink" href="#d-footnote-1">[↩]</a></li><li id="d-footnote-2-listing">
    While the standard explanation is that maximizing probability 
doesn’t work very well because you can just push down evidence for other
 classes, an alternate hypothesis is that it’s just harder to optimize 
through the softmax function. We understand this has sometimes been an 
issue in adversarial examples, and the solution is to optimize the 
LogSumExp of the logits instead. This is equivalent to optimizing 
softmax but generally more tractable. Our experience was that the 
LogSumExp trick doesn’t seem better than dealing with the raw 
probabilities.
    <br>
    <br>
    Regardless of why that happens, it can be fixed by very strong 
regularization with generative models. In this case the probabilities 
can be a very principled thing to optimize.
  <a class="footnote-backlink" href="#d-footnote-2">[↩]</a></li><li id="d-footnote-3-listing">
      For this article we use an approach based on ideas from artistic 
style transfer. Following that work, we begin by computing the Gram 
matrix <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">G</span></span></span></span></span> of the channels, where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">G_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base"><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span></span></span></span></span> is a the dot product between the (flattened) response of filter <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base"><span class="mord mathit">i</span></span></span></span></span> and filter <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span></span>:
      <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mo>∑</mo><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub><msub><mtext>layer</mtext><mi>n</mi></msub><mtext>[x,&nbsp;y,&nbsp;i]</mtext><mo>⋅</mo><msub><mtext>layer</mtext><mi>n</mi></msub><mtext>[x,&nbsp;y,&nbsp;j]</mtext></mrow><annotation encoding="application/x-tex">
        G_{i,j} = \sum_{x,y} \text{layer}_n\text{[x, y, i]} \cdot \text{layer}_n\text{[x, y, j]}
      </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0500050000000003em;"></span><span class="strut bottom" style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="base"><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.386113em;"></span></span></span></span><span class="mord"><span class="mord text"><span class="mord mathrm">layer</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"></span></span></span></span></span><span class="mord text"><span class="mord mathrm">[x,&nbsp;y,&nbsp;i]</span></span><span class="mbin">⋅</span><span class="mord"><span class="mord text"><span class="mord mathrm">layer</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"></span></span></span></span></span><span class="mord text"><span class="mord mathrm">[x,&nbsp;y,&nbsp;j]</span></span></span></span></span></span></span>
      From this, we compute the diversity term: the negative pairwise cosine similarity of pairs of visualizations.
      <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mtext>diversity</mtext></msub><mo>=</mo><mo>−</mo><msub><mo>∑</mo><mi>a</mi></msub><msub><mo>∑</mo><mrow><mi>b</mi><mo>≠</mo><mi>a</mi></mrow></msub><mtext>&nbsp;</mtext><mfrac><mrow><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>a</mi></msub><mo>)</mo><mo>⋅</mo><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>b</mi></msub><mo>)</mo></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>a</mi></msub><mo>)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mtext>vec</mtext><mo>(</mo><msub><mi>G</mi><mi>b</mi></msub><mo>)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
        C_{\text{diversity}} = - \sum_{a} \sum_{b\neq a} ~ 
\frac{\text{vec}(G_a) \cdot 
\text{vec}(G_b)}{||\text{vec}(G_a)||~||\text{vec}(G_b)||}
      </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.894705em;vertical-align:-1.467705em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">diversity</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord">−</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.832795em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mrel mtight">≠</span><span class="mord mathit mtight">a</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.467705em;"></span></span></span></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord mathrm"><span class="mspace">&nbsp;</span><span class="mord mathrm">∣</span></span><span class="mord mathrm">∣</span><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mbin">⋅</span><span class="mord text"><span class="mord mathrm">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
      We then maximize the diversity term jointly with the regular optimization objective.
    <a class="footnote-backlink" href="#d-footnote-3">[↩]</a></li><li id="d-footnote-4-listing">The
 optimization objective is a linear interpolation between the individual
 channel objectives. To get the interpolations to look better, we also 
add a small alignment objective that encourages lower layer activations 
to be similar. We additionally use a combination of separate and shared 
image parameterizations to make it easier for the optimization algorithm
 to cause objects to line up, while still giving it the freedom to 
create any image it needs to.<a class="footnote-backlink" href="#d-footnote-4">[↩]</a></li><li id="d-footnote-5-listing">
    If we think about blurring in Fourier space, it is equivalent to 
adding a scaled L2 penalty to the objective, penalizing each 
Fourier-component based on its frequency.<a class="footnote-backlink" href="#d-footnote-5">[↩]</a></li><li id="d-footnote-6-listing">
    Gradient blurring<d-cite key="oygard2015vis"></d-cite> is equivalent
 to gradient descent in a different parameterization of image space, 
where high frequency dimensions are stretched to make moving in those 
directions slower. Gradient Laplacian Pyramid normalization <d-cite key="mordvintsev2016deepdreaming"></d-cite> is a kind of adaptive learning rate approach in the same space.
  <a class="footnote-backlink" href="#d-footnote-6">[↩]</a></li><li id="d-footnote-7-listing">
    This points to a profound fact about the Fourier transform.
    As long as a correlation is consistent across spatial 
positions — such as the correlation between a pixel and its left 
neighbor being the same across all positions of an image — the Fourier 
coefficients will be independent variables.
    To see this, note that such a spatially consistent correlation can 
be expressed as a convolution, and by the convolution theorem becomes 
pointwise multiplication after the Fourier transform.
  <a class="footnote-backlink" href="#d-footnote-7">[↩]</a></li><li id="d-footnote-8-listing">
      Note that we have to be careful to get the colors to be 
decorrelated, too. The Fourier transforms decorrelates spatially, but a 
correlation will still exist between colors.
      To address this, we explicitly measure the correlation between 
colors in the training set and use a Cholesky decomposition to 
decorrelate them. Compare the directions of steepest decent before and 
after decorrelating colors:
      <br>
      <span style="display: block; padding-top: 1em;">
        <span style="display: inline-block;">
          <img style="height: 112px; width: 112px; display: block;" src="Feature%20Visualization_files/correlated_colors.jpeg">
          <span class="figcaption">
            Correlated Colors
          </span>
        </span>
        <span style="display: inline-block;">
          <img style="height: 112px; width: 112px; display: block;" src="Feature%20Visualization_files/decorrelated_colors.jpeg">
          <span class="figcaption">
            Decorrelated Colors
          </span>
        </span>
      </span>
  <a class="footnote-backlink" href="#d-footnote-8">[↩]</a></li><li id="d-footnote-9-listing">
    Images were optimized for 2560 steps in a color-decorrelated 
fourier-transformed space, using Adam at a learning rate of 0.05.
    We used each of following transformations in the given order at each
 step of the optimization:<br><br>
    • Padding the input by 16 pixels to avoid edge artifacts<br>
    • Jittering by up to 16 pixels<br>
    • Scaling by a factor randomly selected from this list: 1, 0.975, 1.025, 0.95, 1.05<br>
    • Rotating by an angle randomly selected from this list; in degrees: -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5<br>
    • Jittering a second time by up to 8 pixels<br>
    • Cropping the padding<br>
  <a class="footnote-backlink" href="#d-footnote-9">[↩]</a></li></ol>
</d-footnote-list>
  <d-citation-list distill-prerendered="true"><style>
d-citation-list {
  contain: style;
}

d-citation-list .references {
  grid-column: text;
}

d-citation-list .references .title {
  font-weight: 500;
}
</style><h3 id="references">References</h3><ol id="references-list" class="references"><li id="szegedy2015going"><span class="title">Going deeper with convolutions</span>   <a href="https://arxiv.org/pdf/1409.4842.pdf">[PDF]</a><br>Szegedy,
 C., Liu, W., Jia, Y., Sermanet, P., Reed, S., Anguelov, D., Erhan, D., 
Vanhoucke, V. and Rabinovich, A., 2015. Proceedings of the IEEE 
conference on computer vision and pattern recognition, pp. 1--9. </li><li id="deng2009imagenet"><span class="title">Imagenet: A large-scale hierarchical image database</span>   <a href="http://www.image-net.org/papers/imagenet_cvpr09.pdf">[PDF]</a><br>Deng,
 J., Dong, W., Socher, R., Li, L., Li, K. and Fei-Fei, L., 2009. 
Computer Vision and Pattern Recognition, 2009. CVPR 2009. IEEE 
Conference on, pp. 248--255.  <a href="https://doi.org/10.1109/cvprw.2009.5206848" style="text-decoration:inherit;">DOI: 10.1109/cvprw.2009.5206848</a></li><li id="erhan2009visualizing"><span class="title">Visualizing higher-layer features of a deep network</span>   <a href="https://www.researchgate.net/profile/Aaron_Courville/publication/265022827_Visualizing_Higher-Layer_Features_of_a_Deep_Network/links/53ff82b00cf24c81027da530.pdf">[PDF]</a><br>Erhan, D., Bengio, Y., Courville, A. and Vincent, P., 2009. University of Montreal, Vol 1341, pp. 3. </li><li id="mordvintsev2015inceptionism"><span class="title">Inceptionism: Going deeper into neural networks</span>   <a href="https://research.googleblog.com/2015/06/inceptionism-going-deeper-into-neural.html">[HTML]</a><br>Mordvintsev, A., Olah, C. and Tyka, M., 2015. Google Research Blog. </li><li id="simonyan2013deep"><span class="title">Deep inside convolutional networks: Visualising image classification models and saliency maps</span>   <a href="https://arxiv.org/pdf/1312.6034.pdf">[PDF]</a><br>Simonyan, K., Vedaldi, A. and Zisserman, A., 2013. arXiv preprint arXiv:1312.6034. </li><li id="gatys2015neural"><span class="title">A neural algorithm of artistic style</span>   <a href="https://arxiv.org/pdf/1508.06576.pdf">[PDF]</a><br>Gatys, L.A., Ecker, A.S. and Bethge, M., 2015. arXiv preprint arXiv:1508.06576. </li><li id="mahendran2015understanding"><span class="title">Understanding deep image representations by inverting them</span>   <a href="https://arxiv.org/pdf/1412.0035v1.pdf">[PDF]</a><br>Mahendran,
 A. and Vedaldi, A., 2015. Proceedings of the IEEE Conference on 
Computer Vision and Pattern Recognition, pp. 5188--5196.  <a href="https://doi.org/10.1109/cvpr.2015.7299155" style="text-decoration:inherit;">DOI: 10.1109/cvpr.2015.7299155</a></li><li id="mneuron2015"><span class="title">Understanding Intra-Class Knowledge Inside {CNN}</span>   <a href="http://arxiv.org/pdf/1507.02379.pdf">[PDF]</a><br>Wei, D., Zhou, B., Torralba, A. and Freeman, W.T., 2015. CoRR, Vol abs/1507.02379. </li><li id="nguyen2016multifaceted"><span class="title">Multifaceted feature visualization: Uncovering the different types of features learned by each neuron in deep neural networks</span>   <a href="https://arxiv.org/pdf/1602.03616.pdf">[PDF]</a><br>Nguyen, A., Yosinski, J. and Clune, J., 2016. arXiv preprint arXiv:1602.03616. </li><li id="nguyen2016plug"><span class="title">Plug &amp; play generative networks: Conditional iterative generation of images in latent space</span>   <a href="https://arxiv.org/pdf/1612.00005.pdf">[PDF]</a><br>Nguyen, A., Yosinski, J., Bengio, Y., Dosovitskiy, A. and Clune, J., 2016. arXiv preprint arXiv:1612.00005. </li><li id="szegedy2013intriguing"><span class="title">Intriguing properties of neural networks</span>   <a href="https://arxiv.org/pdf/1312.6199.pdf">[PDF]</a><br>Szegedy,
 C., Zaremba, W., Sutskever, I., Bruna, J., Erhan, D., Goodfellow, I. 
and Fergus, R., 2013. arXiv preprint arXiv:1312.6199. </li><li id="netdissect2017"><span class="title">Network Dissection: Quantifying Interpretability of Deep Visual Representations</span>   <a href="https://arxiv.org/pdf/1704.05796.pdf">[PDF]</a><br>Bau, D., Zhou, B., Khosla, A., Oliva, A. and Torralba, A., 2017. Computer Vision and Pattern Recognition. </li><li id="odena2016deconvolution"><span class="title">Deconvolution and checkerboard artifacts</span>   <a href="http://distill.pub/2016/deconv-checkerboard/">[link]</a><br>Odena, A., Dumoulin, V. and Olah, C., 2016. Distill, Vol 1(10), pp. e3.  <a href="https://doi.org/distill.00003" style="text-decoration:inherit;">DOI: distill.00003</a></li><li id="nguyen2015deep"><span class="title">Deep neural networks are easily fooled: High confidence predictions for unrecognizable images</span>   <a href="https://arxiv.org/pdf/1412.1897.pdf">[PDF]</a><br>Nguyen,
 A., Yosinski, J. and Clune, J., 2015. Proceedings of the IEEE 
Conference on Computer Vision and Pattern Recognition, pp. 427--436.  <a href="https://doi.org/10.1109/cvpr.2015.7298640" style="text-decoration:inherit;">DOI: 10.1109/cvpr.2015.7298640</a></li><li id="oygard2015vis"><span class="title">Visualizing GoogLeNet Classes</span>   <a href="https://www.auduno.com/2015/07/29/visualizing-googlenet-classes/">[link]</a><br>Øygard, A., 2015. </li><li id="tyka2016bilateral"><span class="title">Class visualization with bilateral filters</span>   <a href="https://mtyka.github.io/deepdream/2016/02/05/bilateral-class-vis.html">[HTML]</a><br>Tyka, M., 2016. </li><li id="mordvintsev2016deepdreaming"><span class="title">DeepDreaming with TensorFlow</span>   <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/deepdream/deepdream.ipynb">[link]</a><br>Mordvintsev, A., 2016. </li><li id="nguyen2016synthesizing"><span class="title">Synthesizing the preferred inputs for neurons in neural networks via deep generator networks</span>   <a href="https://arxiv.org/pdf/1605.09304.pdf">[PDF]</a><br>Nguyen,
 A., Dosovitskiy, A., Yosinski, J., Brox, T. and Clune, J., 2016. 
Advances in Neural Information Processing Systems, pp. 3387--3395. </li><li id="abadi2016tensorflow"><span class="title">Tensorflow: Large-scale machine learning on heterogeneous distributed systems</span>   <a href="https://arxiv.org/pdf/1603.04467.pdf">[PDF]</a><br>Abadi,
 M., Agarwal, A., Barham, P., Brevdo, E., Chen, Z., Citro, C., Corrado, 
G.S., Davis, A., Dean, J., Devin, M., Ghemawat, S., Goodfellow, I.J., 
Harp, A., Irving, G., Isard, M., Jia, Y., J{\'{o}}zefowicz, R., Kaiser, 
L., Kudlur, M., Levenberg, J., Man{\'{e}}, D., Monga, R., Moore, S., 
Murray, D.G., Olah, C., Schuster, M., Shlens, J., Steiner, B., 
Sutskever, I., Talwar, K., Tucker, P.A., Vanhoucke, V., Vasudevan, V., 
Vi{\'{e}}gas, F.B., Vinyals, O., Warden, P., Wattenberg, M., Wicke, M., 
Yu, Y. and Zheng, X., 2016. arXiv preprint arXiv:1603.04467. </li></ol></d-citation-list>
<distill-appendix>
<style>
  distill-appendix {
    contain: layout style;
  }

  distill-appendix .citation {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  distill-appendix > * {
    grid-column: text;
  }
</style>

    <h3 id="updates-and-corrections">Updates and Corrections</h3>
    <p>
    If you see mistakes or want to suggest changes, please <a href="https://github.com/distillpub/post--feature-visualization/issues/new">create an issue on GitHub</a>. </p>
    
    <h3 id="reuse">Reuse</h3>
    <p>Diagrams and text are licensed under Creative Commons Attribution <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> with the <a class="github" href="https://github.com/distillpub/post--feature-visualization">source available on GitHub</a>,
 unless noted otherwise. The figures that have been reused from other 
sources don’t fall under this license and can be recognized by a note in
 their caption: “Figure from …”.</p>
    
    <h3 id="citation">Citation</h3>
    <p>For attribution in academic contexts, please cite this work as</p>
    <pre class="citation short">Olah, et al., "Feature Visualization", Distill, 2017.</pre>
    <p>BibTeX citation</p>
    <pre class="citation long">@article{olah2017feature,
  author = {Olah, Chris and Mordvintsev, Alexander and Schubert, Ludwig},
  title = {Feature Visualization},
  journal = {Distill},
  year = {2017},
  note = {https://distill.pub/2017/feature-visualization},
  doi = {10.23915/distill.00007}
}</pre>
    </distill-appendix></d-appendix>

<d-bibliography><script type="text/json">[["erhan2009visualizing",{"title":"Visualizing higher-layer features of a deep network","author":"Erhan, Dumitru and Bengio, Yoshua and Courville, Aaron and Vincent, Pascal","journal":"University of Montreal","volume":"1341","pages":"3","year":"2009","url":"https://www.researchgate.net/profile/Aaron_Courville/publication/265022827_Visualizing_Higher-Layer_Features_of_a_Deep_Network/links/53ff82b00cf24c81027da530.pdf","type":"article"}],["mordvintsev2015inceptionism",{"title":"Inceptionism: Going deeper into neural networks","author":"Mordvintsev, Alexander and Olah, Christopher and Tyka, Mike","journal":"Google Research Blog","year":"2015","url":"https://research.googleblog.com/2015/06/inceptionism-going-deeper-into-neural.html","type":"article"}],["simonyan2013deep",{"title":"Deep inside convolutional networks: Visualising image classification models and saliency maps","author":"Simonyan, Karen and Vedaldi, Andrea and Zisserman, Andrew","journal":"arXiv preprint arXiv:1312.6034","year":"2013","url":"https://arxiv.org/pdf/1312.6034.pdf","type":"article"}],["mahendran2015understanding",{"title":"Understanding deep image representations by inverting them","author":"Mahendran, Aravindh and Vedaldi, Andrea","booktitle":"Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition","pages":"5188--5196","year":"2015","doi":"10.1109/cvpr.2015.7299155","url":"https://arxiv.org/pdf/1412.0035v1.pdf","type":"inproceedings"}],["dosovitskiy2016inverting",{"title":"Inverting visual representations with convolutional networks","author":"Dosovitskiy, Alexey and Brox, Thomas","booktitle":"Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition","pages":"4829--4837","year":"2016","doi":"10.1109/cvpr.2016.522","url":"http://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Dosovitskiy_Inverting_Visual_Representations_CVPR_2016_paper.pdf","type":"inproceedings"}],["dosovitskiy2016generating",{"title":"Generating images with perceptual similarity metrics based on deep networks","author":"Dosovitskiy, Alexey and Brox, Thomas","booktitle":"Advances in Neural Information Processing Systems","pages":"658--666","year":"2016","url":"https://arxiv.org/pdf/1602.02644.pdf","type":"inproceedings"}],["nguyen2015deep",{"title":"Deep neural networks are easily fooled: High confidence predictions for unrecognizable images","author":"Nguyen, Anh and Yosinski, Jason and Clune, Jeff","booktitle":"Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition","pages":"427--436","year":"2015","doi":"10.1109/cvpr.2015.7298640","url":"https://arxiv.org/pdf/1412.1897.pdf","type":"inproceedings"}],["nguyen2016synthesizing",{"title":"Synthesizing the preferred inputs for neurons in neural networks via deep generator networks","author":"Nguyen, Anh and Dosovitskiy, Alexey and Yosinski, Jason and Brox, Thomas and Clune, Jeff","booktitle":"Advances in Neural Information Processing Systems","pages":"3387--3395","year":"2016","url":"https://arxiv.org/pdf/1605.09304.pdf","type":"inproceedings"}],["nguyen2016plug",{"title":"Plug & play generative networks: Conditional iterative generation of images in latent space","author":"Nguyen, Anh and Yosinski, Jason and Bengio, Yoshua and Dosovitskiy, Alexey and Clune, Jeff","journal":"arXiv preprint arXiv:1612.00005","year":"2016","url":"https://arxiv.org/pdf/1612.00005.pdf","type":"article"}],["tyka2016bilateral",{"title":"Class visualization with bilateral filters","author":"Tyka, Mike","year":"2016","url":"https://mtyka.github.io/deepdream/2016/02/05/bilateral-class-vis.html","type":"misc"}],["oygard2015vis",{"title":"Visualizing GoogLeNet Classes","author":"Øygard, Audun","year":"2015","url":"https://www.auduno.com/2015/07/29/visualizing-googlenet-classes/","type":"misc"}],["mordvintsev2016deepdreaming",{"title":"DeepDreaming with TensorFlow","author":"Mordvintsev, Alexander","year":"2016","url":"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/deepdream/deepdream.ipynb","type":"misc"}],["szegedy2013intriguing",{"title":"Intriguing properties of neural networks","author":"Szegedy, Christian and Zaremba, Wojciech and Sutskever, Ilya and Bruna, Joan and Erhan, Dumitru and Goodfellow, Ian and Fergus, Rob","journal":"arXiv preprint arXiv:1312.6199","year":"2013","url":"https://arxiv.org/pdf/1312.6199.pdf","type":"article"}],["gatys2015neural",{"title":"A neural algorithm of artistic style","author":"Gatys, Leon A and Ecker, Alexander S and Bethge, Matthias","journal":"arXiv preprint arXiv:1508.06576","year":"2015","url":"https://arxiv.org/pdf/1508.06576.pdf","type":"article"}],["nguyen2016multifaceted",{"title":"Multifaceted feature visualization: Uncovering the different types of features learned by each neuron in deep neural networks","author":"Nguyen, Anh and Yosinski, Jason and Clune, Jeff","journal":"arXiv preprint arXiv:1602.03616","year":"2016","url":"https://arxiv.org/pdf/1602.03616.pdf","type":"article"}],["odena2016deconvolution",{"title":"Deconvolution and checkerboard artifacts","author":"Odena, Augustus and Dumoulin, Vincent and Olah, Chris","journal":"Distill","volume":"1","number":"10","pages":"e3","year":"2016","doi":"distill.00003","url":"http://distill.pub/2016/deconv-checkerboard/","type":"article"}],["joshi2017bringing",{"title":"Bringing impressionism to life with neural style transfer in come swim","author":"Joshi, Bhautik and Stewart, Kristen and Shapiro, David","journal":"arXiv preprint arXiv:1701.04928","year":"2017","url":"https://arxiv.org/pdf/1701.04928.pdf","type":"article"}],["netdissect2017",{"title":"Network Dissection: Quantifying Interpretability of Deep Visual Representations","author":"Bau, David and Zhou, Bolei and Khosla, Aditya and Oliva, Aude and Torralba, Antonio","booktitle":"Computer Vision and Pattern Recognition","year":"2017","url":"https://arxiv.org/pdf/1704.05796.pdf","type":"inproceedings"}],["mneuron2015",{"author":"Donglai Wei and Bolei Zhou and Antonio Torralba and William T. Freeman","title":"Understanding Intra-Class Knowledge Inside {CNN}","journal":"CoRR","volume":"abs/1507.02379","year":"2015","url":"http://arxiv.org/abs/1507.02379","archivePrefix":"arXiv","eprint":"1507.02379","archiveprefix":"arXiv","type":"article"}],["szegedy2015going",{"title":"Going deeper with convolutions","author":"Szegedy, Christian and Liu, Wei and Jia, Yangqing and Sermanet, Pierre and Reed, Scott and Anguelov, Dragomir and Erhan, Dumitru and Vanhoucke, Vincent and Rabinovich, Andrew","booktitle":"Proceedings of the IEEE conference on computer vision and pattern recognition","pages":"1--9","year":"2015","url":"https://arxiv.org/pdf/1409.4842.pdf","type":"inproceedings"}],["abadi2016tensorflow",{"title":"Tensorflow: Large-scale machine learning on heterogeneous distributed systems","author":"Mart{\\'i}n Abadi and Ashish Agarwal and Paul Barham and Eugene Brevdo and Zhifeng Chen and Craig Citro and Gregory S. Corrado and Andy Davis and Jeffrey Dean and Matthieu Devin and Sanjay Ghemawat and Ian J. Goodfellow and Andrew Harp and Geoffrey Irving and Michael Isard and Yangqing Jia and Rafal J{\\'{o}}zefowicz and Lukasz Kaiser and Manjunath Kudlur and Josh Levenberg and Dan Man{\\'{e}} and Rajat Monga and Sherry Moore and Derek Gordon Murray and Chris Olah and Mike Schuster and Jonathon Shlens and Benoit Steiner and Ilya Sutskever and Kunal Talwar and Paul A. Tucker and Vincent Vanhoucke and Vijay Vasudevan and Fernanda B. Vi{\\'{e}}gas and Oriol Vinyals and Pete Warden and Martin Wattenberg and Martin Wicke and Yuan Yu and Xiaoqiang Zheng","journal":"arXiv preprint arXiv:1603.04467","year":"2016","url":"https://arxiv.org/pdf/1603.04467.pdf","type":"article"}],["deng2009imagenet",{"title":"Imagenet: A large-scale hierarchical image database","author":"Deng, Jia and Dong, Wei and Socher, Richard and Li, Li-Jia and Li, Kai and Fei-Fei, Li","booktitle":"Computer Vision and Pattern Recognition, 2009. CVPR 2009. IEEE Conference on","pages":"248--255","year":"2009","organization":"IEEE","doi":"10.1109/cvprw.2009.5206848","url":"http://www.image-net.org/papers/imagenet_cvpr09.pdf","type":"inproceedings"}]]</script></d-bibliography>

<script type="text/javascript" src="Feature%20Visualization_files/index.js"></script>
<distill-footer>
<style>

:host {
  color: rgba(255, 255, 255, 0.5);
  font-weight: 300;
  padding: 2rem 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  background-color: hsl(180, 5%, 15%); /*hsl(200, 60%, 15%);*/
  text-align: left;
  contain: content;
}

.footer-container .logo svg {
  width: 24px;
  position: relative;
  top: 4px;
  margin-right: 2px;
}

.footer-container .logo svg path {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 3px;
}

.footer-container .logo {
  font-size: 17px;
  font-weight: 200;
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  margin-right: 6px;
}

.footer-container {
  grid-column: text;
}

.footer-container .nav {
  font-size: 0.9em;
  margin-top: 1.5em;
}

.footer-container .nav a {
  color: rgba(255, 255, 255, 0.8);
  margin-right: 6px;
  text-decoration: none;
}

</style>

<div class="footer-container">

  <a href="https://distill.pub/" class="logo">
    <svg viewBox="-607 419 64 64">
  <path d="M-573.4,478.9c-8,0-14.6-6.4-14.6-14.5s14.6-25.9,14.6-40.8c0,14.9,14.6,32.8,14.6,40.8S-565.4,478.9-573.4,478.9z"></path>
</svg>

    Distill
  </a> is dedicated to clear explanations of machine learning

  <div class="nav">
    <a href="https://distill.pub/about/">About</a>
    <a href="https://distill.pub/journal/">Submit</a>
    <a href="https://distill.pub/prize/">Prize</a>
    <a href="https://distill.pub/archive/">Archive</a>
    <a href="https://distill.pub/rss.xml">RSS</a>
    <a href="https://github.com/distillpub">GitHub</a>
    <a href="https://twitter.com/distillpub">Twitter</a>
    &nbsp;&nbsp;&nbsp;&nbsp; ISSN 2476-0757
  </div>

</div>

</distill-footer><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-83741880-1', 'auto');
  ga('send', 'pageview');
</script></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>